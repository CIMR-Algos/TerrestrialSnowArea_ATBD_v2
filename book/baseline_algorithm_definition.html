
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Baseline Algorithm Definition &#8212; CIMR L2 Terrestrial Snow Area ATBD v2</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css?v=564be945" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'book/baseline_algorithm_definition';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Algorithm Input and Output Data Definition" href="algorithm_input_output_data_definition.html" />
    <link rel="prev" title="Level-2 Product Definition" href="L2_product_definition.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">This ATBD was developed in the CIMR DEVALGO project. The development continues in the <a href="https://github.com/CIMR-L2PAD"style='color: #87CEEB;'>CIMR L2PAD</a> project.</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.jpg" class="logo__image only-light" alt="CIMR L2 Terrestrial Snow Area ATBD v2 - Home"/>
    <script>document.write(`<img src="../_static/logo.jpg" class="logo__image only-dark" alt="CIMR L2 Terrestrial Snow Area ATBD v2 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    CIMR L2 Terrestrial Snow Area ATBD
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="abstract.html">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="applicable_ref_docs.html">Applicable and Reference Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="acronyms.html">Acronyms</a></li>
<li class="toctree-l1"><a class="reference internal" href="definitions.html">Definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction_purpose_scope.html">Introduction, Purpose and Scope</a></li>
<li class="toctree-l1"><a class="reference internal" href="background_justification_algorithm.html">Background and Justification of Selected Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="L2_product_definition.html">Level-2 Product Definition</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Baseline Algorithm Definition</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithm_input_output_data_definition.html">Algorithm Input and Output Data Definition</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithm_performance_assessment.html">Algorithm Performance Assessment</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap for Future ATBD Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="annex.html">Annex</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../algorithm/run_CIMR_L2_TSA.html">CIMR L2 TSA Top-Level Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algorithm/CIMR_L2_TSA_PICASSO.html">CIMR L2 TSA Processing Chain for the Demonstration Reference Scenario (PICASSO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algorithm/CIMR_L2_TSA_SCEPS.html">CIMR L2 TSA Algorithm for the SCEPS Polar Scene</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/CIMR-Algos/TerrestrialSnowArea_ATBD_v2" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/book/baseline_algorithm_definition.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Baseline Algorithm Definition</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieval-method">Retrieval Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forward-model">Forward Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cimr-level-1b-resampling-approach">CIMR Level-1b Resampling Approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithm-assumptions-and-simplifications">Algorithm Assumptions and Simplifications</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#level-2-end-to-end-algorithm-functional-flow-diagram">Level-2 End-to-End Algorithm Functional Flow Diagram</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functional-description-of-each-algorithm-step">Functional Description of Each Algorithm Step</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dry-snow-detection">Dry Snow Detection</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematical-description">Mathematical description</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#input-data">Input data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#output-data">Output data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combined-reprojection">Combined Reprojection</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#description">Description</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Input data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Output data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#masking-and-flagging">Masking and Flagging</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Description</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Input data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Output data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#auxiliary-data">Auxiliary data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ancillary-data">Ancillary data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#validation-process">Validation process</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="baseline-algorithm-definition">
<h1>Baseline Algorithm Definition<a class="headerlink" href="#baseline-algorithm-definition" title="Link to this heading">#</a></h1>
<p>The <a class="reference internal" href="acronyms.html#term-TSA"><span class="xref std std-term">TSA</span></a> algorithm is based on dry snow detection as described by <span id="id1">Hall <em>et al.</em> [<a class="reference internal" href="references.html#id2" title="D. Hall, R. Kelly, G. Riggs, A. Chang, and J. Foster. Assessment of the relative accuracy of hemispheric-scale snow-cover maps. Annals of Glaciology, 34:24-30, 2002. doi:10.3189/172756402781817770.">2002</a>]</span> and <span id="id2">Pulliainen <em>et al.</em> [<a class="reference internal" href="references.html#id3" title="J. Pulliainen, P. Lahtinen, J. Kärnä, and S. Koponen. Algorithm Theoretical Definition Document (ATDD) for Product SN-OBS-2 - Snow Status (Dry/Wet) by Microwave Radiometry. Technical Report H11, EUMETSAT H-SAF, 2010.">2010</a>]</span>. This empirical algorithm is based on the underlying physical principle that microwave radiation of higher frequencies is attenuated by snow cover due to volume scattering, while lower frequencies remain mostly unaffected.
The TSA product is only concerned with snow cover in the Northern Hemisphere, where seasonal terrestrial snow predominantly occurs.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Refer to the <a class="reference internal" href="annex.html#content-annex"><span class="std std-ref">Annex</span></a> for a <a class="reference internal" href="../algorithm/run_CIMR_L2_TSA.html"><span class="std std-doc">top-level script</span></a> of the Level-2 TSA algorithm including output file generation, and for a <a class="reference internal" href="../algorithm/CIMR_L2_TSA_PICASSO.html"><span class="std std-doc">step-by-step visualization</span></a>.</p>
</div>
<section id="retrieval-method">
<h2>Retrieval Method<a class="headerlink" href="#retrieval-method" title="Link to this heading">#</a></h2>
<p>The retrieval of TSA encompasses the following main steps:</p>
<ul class="simple">
<li><p>Step 1: <strong>Dry snow detection</strong> algorithm</p></li>
<li><p>Step 2: <strong>Combined reprojection</strong> of forward and backward TSA maps</p></li>
<li><p>Step 3: <strong>Masking and Flagging</strong> for final TSA maps including qualitative uncertainty estimates</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The specifics of the retrieval methodology may be subject to change, but will follow the general structure as outlined.</p>
</div>
</section>
<section id="forward-model">
<h2>Forward Model<a class="headerlink" href="#forward-model" title="Link to this heading">#</a></h2>
<p>The origins of the implemented algorithm stem from <span id="id3">Chang <em>et al.</em> [<a class="reference internal" href="references.html#id7" title="A. Chang, J. Foster, and D. Hall. Nimbus-7 SMMR derived global snow cover parameters. Annals of Glaciology, 9:39-44, 1987. doi:10.3189/S0260305500200736.">1987</a>]</span>, who present a linear relationship between snow depth and spectral difference, as given in <a class="reference internal" href="#equation-tb-diff">(1)</a>.
This relationship is derived from an empirical fit of simulated microwave brightness temperatures for varying <a class="reference internal" href="acronyms.html#term-SWE"><span class="xref std std-term">SWE</span></a>, using a microscopic scattering model <span id="id4">[<a class="reference internal" href="references.html#id23" title="A. Chang, J. Foster, D. Hall, A. Rango, and B. Hartline. Snow water equivalent estimation by microwave radiometry. Cold Regions Science and Technology, 5(3):259–267, 1982. doi:10.1016/0165-232X(82)90019-2.">Chang <em>et al.</em>, 1982</a>]</span>.
The model takes into consideration the underlying (un-)frozen surface conditions as well as the physical temperature, density, and grain size of the snowpack.
Snow grains are assumed to be spherical and randomly-spaced, resulting in incoherent scattering.
The radiative transfer equation is solved numerically.</p>
</section>
<section id="cimr-level-1b-resampling-approach">
<h2>CIMR Level-1b Resampling Approach<a class="headerlink" href="#cimr-level-1b-resampling-approach" title="Link to this heading">#</a></h2>
<p>Prior to the main TSA algorithm, the current <a class="reference internal" href="acronyms.html#term-CIMR"><span class="xref std std-term">CIMR</span></a> Level-2 TSA framework includes the resampling of L1b TB data to collocate channels to a target channel.
The implemented resampling approach stems from the <a class="reference external" href="https://github.com/CIMR-Algos/Tools">CIMR Devalgo Tools</a>, with the target resolution of Ku-band TB data being set to match Ka-band resolution.
For future research purposes, it is encouraged to also remap X-band TB data with Ka-band as target.</p>
</section>
<section id="algorithm-assumptions-and-simplifications">
<h2>Algorithm Assumptions and Simplifications<a class="headerlink" href="#algorithm-assumptions-and-simplifications" title="Link to this heading">#</a></h2>
<p>The implemented algorithm follows a static approach, assuming that snow density and snow grain properties are spatially and temporally constant.
Different land cover properties are not considered.</p>
</section>
<section id="level-2-end-to-end-algorithm-functional-flow-diagram">
<h2>Level-2 End-to-End Algorithm Functional Flow Diagram<a class="headerlink" href="#level-2-end-to-end-algorithm-functional-flow-diagram" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="#flow-diagram"><span class="std std-numref">Fig. 4</span></a> shows the functional structure for the computation of the TSA product.</p>
<figure class="align-default" id="flow-diagram">
<a class="reference internal image-reference" href="../_images/L2-algorithm.png"><img alt="../_images/L2-algorithm.png" src="../_images/L2-algorithm.png" style="width: 450px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Functional flow diagram of the Level-2 end to end algorithm of the TSA product.</span><a class="headerlink" href="#flow-diagram" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="functional-description-of-each-algorithm-step">
<h2>Functional Description of Each Algorithm Step<a class="headerlink" href="#functional-description-of-each-algorithm-step" title="Link to this heading">#</a></h2>
<p>The three main steps, as outlined in the flow diagram in <a class="reference internal" href="#flow-diagram"><span class="std std-numref">Fig. 4</span></a>, are described hereafter.</p>
<section id="dry-snow-detection">
<h3>Dry Snow Detection<a class="headerlink" href="#dry-snow-detection" title="Link to this heading">#</a></h3>
<section id="mathematical-description">
<h4>Mathematical description<a class="headerlink" href="#mathematical-description" title="Link to this heading">#</a></h4>
<p>The dry snow detection algorithm of the TSA product is based on the approach of <span id="id5">Hall <em>et al.</em> [<a class="reference internal" href="references.html#id2" title="D. Hall, R. Kelly, G. Riggs, A. Chang, and J. Foster. Assessment of the relative accuracy of hemispheric-scale snow-cover maps. Annals of Glaciology, 34:24-30, 2002. doi:10.3189/172756402781817770.">2002</a>]</span> but applies updated empirically derived thresholds as implemented for the EUMETSAT H SAF snow status product H11 <span id="id6">[<a class="reference internal" href="references.html#id3" title="J. Pulliainen, P. Lahtinen, J. Kärnä, and S. Koponen. Algorithm Theoretical Definition Document (ATDD) for Product SN-OBS-2 - Snow Status (Dry/Wet) by Microwave Radiometry. Technical Report H11, EUMETSAT H-SAF, 2010.">Pulliainen <em>et al.</em>, 2010</a>]</span>. The brightness temperature difference between the Ku and Ka-band is used to estimate snow depth (SD) as</p>
<div class="math notranslate nohighlight" id="equation-tb-diff">
<span class="eqno">(1)<a class="headerlink" href="#equation-tb-diff" title="Link to this equation">#</a></span>\[\text{SD} = R_c \cdot (T_B^{18H}-T_B^{37H}),\]</div>
<p>with regression coefficient <span class="math notranslate nohighlight">\(R_c\)</span> of 1.59 cm/K and brightness temperatures <span class="math notranslate nohighlight">\(T_B\)</span>, where the superscripts indicate the frequency and polarisation.
For the algorithm in <a class="reference internal" href="#equation-tb-diff">(1)</a> to detect dry snow, the following thresholds must be met:</p>
<div class="math notranslate nohighlight" id="equation-tb-thresholds">
<span class="eqno">(2)<a class="headerlink" href="#equation-tb-thresholds" title="Link to this equation">#</a></span>\[\begin{split}\begin{aligned}
\text{SD} &amp;≥ 3.0~\text{cm}\\
T_B^{37V} &amp;&lt; 255~\text{K}\\
T_B^{37H} &amp;&lt; 250~\text{K}.
\end{aligned}\end{split}\]</div>
<p>The conditions in <a class="reference internal" href="#equation-tb-diff">(1)</a> and <a class="reference internal" href="#equation-tb-thresholds">(2)</a> are applied separately to TBs from forward and backward scans.</p>
</section>
<section id="input-data">
<h4>Input data<a class="headerlink" href="#input-data" title="Link to this heading">#</a></h4>
<p>After resampling to Ka-band as target, both the forward and backward-looking data of the following brightness temperatures are used as input:</p>
<ul class="simple">
<li><p>Ku-band TBs (horizontal polarisation)</p></li>
<li><p>Ku-band TBs (horizontal and vertical polarisation)</p></li>
</ul>
</section>
<section id="output-data">
<h4>Output data<a class="headerlink" href="#output-data" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Binary TSA maps, one for each scan direction (forward and backward).</p></li>
</ul>
</section>
</section>
<section id="combined-reprojection">
<h3>Combined Reprojection<a class="headerlink" href="#combined-reprojection" title="Link to this heading">#</a></h3>
<section id="description">
<h4>Description<a class="headerlink" href="#description" title="Link to this heading">#</a></h4>
<p>The preceeding dry snow detection step is applied to resampled swath brightness temperatures of both scan directions.
The forward and backward TSA maps in swath format are each individually reprojected to the <a class="reference internal" href="acronyms.html#term-EASE-Grid"><span class="xref std std-term">EASE-Grid</span></a> 2.0 <a class="reference internal" href="acronyms.html#term-NH"><span class="xref std std-term">NH</span></a>, and subsequently combined into a single map.
When combining the binary TSA maps, all snow pixels are retained in order to counteract the tendency of passive microwave approaches to underestimate TSA.
In other words, snow is flagged when at least one scan direction detects snow.</p>
</section>
<section id="id7">
<h4>Input data<a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Binary TSA maps, one for each scan direction (forward and backward).</p></li>
</ul>
</section>
<section id="id8">
<h4>Output data<a class="headerlink" href="#id8" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Gridded binary TSA maps, one for each scan direction (forward and backward).</p></li>
<li><p>Gridded combined binary TSA map</p></li>
</ul>
</section>
</section>
<section id="masking-and-flagging">
<h3>Masking and Flagging<a class="headerlink" href="#masking-and-flagging" title="Link to this heading">#</a></h3>
<section id="id9">
<h4>Description<a class="headerlink" href="#id9" title="Link to this heading">#</a></h4>
<p>Although masking and flagging are not strictly necessary to retrieve TSA, this step provides relevant complementary information.
Generally, flagging is preferred over masking with the reasoning that users can later individually tailor the daily TSA map to their needs.</p>
<p>The TSA Uncertainty Flag in its current form is based on the gridded forward (<a class="reference internal" href="acronyms.html#term-FWD"><span class="xref std std-term">FWD</span></a>) and backward (<a class="reference internal" href="acronyms.html#term-BCK"><span class="xref std std-term">BCK</span></a>) TSA maps.
Grid cells which see detected snow for both scans (FWD &amp; BCK) are flagged as ‘very likely snow covered’, whereas detected snow for one scan only (FWD | BCK) are set to ‘likely snow covered’.
If no snow is detected for both scans (FWD &amp; BCK), the flag reads ‘very likely snow free’.
The Status Flag contains information for each grid cell whether its spatial location corresponds to open water, land, or snow-covered land (valid dry snow), and indicates cells with missing data or out of grid.</p>
</section>
<section id="id10">
<h4>Input data<a class="headerlink" href="#id10" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Gridded binary TSA maps, one for each scan direction (forward and backward).</p></li>
<li><p>Gridded combined binary TSA map</p></li>
<li><p>Land and water mask</p></li>
</ul>
</section>
<section id="id11">
<h4>Output data<a class="headerlink" href="#id11" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>TSA Uncertainty Flag</p></li>
<li><p>Status Flag</p></li>
</ul>
</section>
<section id="auxiliary-data">
<h4>Auxiliary data<a class="headerlink" href="#auxiliary-data" title="Link to this heading">#</a></h4>
<p>For future releases, auxiliary data may be included for more comprehensive masking and flagging.
Information on freshwater lakes could be considered in order to mask or flag grid cells that likely experience water spill-over effects, for instance along coastal areas or in proximity to large water bodies.
Grid cells with surface water fractions larger than about 50% could accordingly be flagged.
Besides, the qualitative TSA uncertainty estimates could further draw upon threshold error margins of <a class="reference internal" href="#equation-tb-diff">(1)</a> and <a class="reference internal" href="#equation-tb-thresholds">(2)</a>, brightness temperature uncertainties and Noise Equivalent Delta Temperatures (NE<span class="math notranslate nohighlight">\(\Delta\)</span>T) for Ku and Ka-band brightness temperatures, as well as regional and seasonal snow likelihoods.</p>
</section>
<section id="ancillary-data">
<h4>Ancillary data<a class="headerlink" href="#ancillary-data" title="Link to this heading">#</a></h4>
<p>The masking of regions which historically do not experience snow cover according to a snow climatology may be part of future R&amp;D activities.
Such ancillary data could further compliment TSA uncertainty estimates.</p>
</section>
<section id="validation-process">
<h4>Validation process<a class="headerlink" href="#validation-process" title="Link to this heading">#</a></h4>
<p>N/a</p>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./book"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="L2_product_definition.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Level-2 Product Definition</p>
      </div>
    </a>
    <a class="right-next"
       href="algorithm_input_output_data_definition.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Algorithm Input and Output Data Definition</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieval-method">Retrieval Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forward-model">Forward Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cimr-level-1b-resampling-approach">CIMR Level-1b Resampling Approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithm-assumptions-and-simplifications">Algorithm Assumptions and Simplifications</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#level-2-end-to-end-algorithm-functional-flow-diagram">Level-2 End-to-End Algorithm Functional Flow Diagram</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functional-description-of-each-algorithm-step">Functional Description of Each Algorithm Step</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dry-snow-detection">Dry Snow Detection</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematical-description">Mathematical description</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#input-data">Input data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#output-data">Output data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combined-reprojection">Combined Reprojection</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#description">Description</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Input data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Output data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#masking-and-flagging">Masking and Flagging</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Description</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Input data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Output data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#auxiliary-data">Auxiliary data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ancillary-data">Ancillary data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#validation-process">Validation process</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Finnish Meteorological Institute
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
This ATBD was developed in the context of the ESA-funded CIMR DEVALGO study (2022-2024) (contract 4000137493).
<br>
ESA is not responsible in any way for the content of this document.
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>