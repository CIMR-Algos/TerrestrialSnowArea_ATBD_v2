

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>CIMR L2 Terrestrial Snow Area ATBD v2</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/watermark.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'book/intro';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="#">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    CIMR L2 Terrestrial Snow Area ATBD
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">













</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/CIMR-Algos/TerrestrialSnowArea_ATBD" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>CIMR L2 Terrestrial Snow Area ATBD</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/abstract">Abstract</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/applicable_ref_docs">Applicable and Reference Documents</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/acronyms">Acronyms</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/definitions">Definitions</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/introduction_purpose_scope">Introduction, Purpose and Scope</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/background_justification_algorithm">Background and Justification of Selected Algorithm</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/L2_product_definition">Level-2 Product Definition</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/baseline_algorithm_definition">Baseline Algorithm Definition</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/algorithm_input_output_data_definition">Algorithm Input and Output Data Definition (IODD)</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/algorithm_performance_assessment">Algorithm Performance Assessment</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/roadmap">Roadmap for Future ATBD Development</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/references">References</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/annex">Annex</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="cimr-l2-terrestrial-snow-area-atbd">
<h1>CIMR L2 Terrestrial Snow Area ATBD<a class="headerlink" href="#cimr-l2-terrestrial-snow-area-atbd" title="Permalink to this heading">#</a></h1>
<p>This document describes the algorithm theoretical basis for the Terrestrial Snow Area (TSA) Level-2 product.</p>
<div class="toctree-wrapper compound">
<span id="document-book/abstract"></span><section class="tex2jax_ignore mathjax_ignore" id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this heading">#</a></h2>
<p>Snow cover is a central component of the Earth’s cryosphere, encountered at mid to high latitudes.
It plays an important role in climate and hydrologic systems, directly influencing the global surface energy budget and regional freshwater resources particularly in the Northern Hemisphere.
Rising temperatures have resulted in a profound global reduction of snow cover area and seasonal duration, which drastically affect the global climate and restrict communities in accessing subsistence and freshwater resources.
Understanding those climate impacts and risks to water supply is paramount for successful climate mitigation and adaptation, as well as informed water resource management.
This requires global monitoring tools, including spaceborne snow mapping using passive microwave data.</p>
<p>Snow mapping by means of spaceborne passive microwave dry snow detection is commonly based on the spectral difference between 18 GHz (Ku-band) and 36 GHz (Ka-band) brightness temperatures of horizontal polarisation.
This principle is also fundamental for the dry snow detection algorithm of the <a class="reference internal" href="book/intro.html#term-Terrestrial-snow-area"><span class="xref std std-term">Terrestrial Snow Area</span></a> (<a class="reference internal" href="book/intro.html#term-TSA"><span class="xref std std-term">TSA</span></a>) Level-2 product for the <a class="reference internal" href="book/intro.html#term-Copernicus-Imaging-Microwave-Radiometer"><span class="xref std std-term">Copernicus Imaging Microwave Radiometer</span></a> (<a class="reference internal" href="book/intro.html#term-CIMR"><span class="xref std std-term">CIMR</span></a>) mission.
The TSA algorithm implements the approaches of <span id="id1">Hall <em>et al.</em> [<a class="reference internal" href="book/intro.html#id2" title="D. Hall, R. Kelly, G. Riggs, A. Chang, and J. Foster. Assessment of the relative accuracy of hemispheric-scale snow-cover maps. Ann. Glaciol., 34:24-30, 2002. doi:10.3189/172756402781817770.">2002</a>]</span> and <span id="id2">Pulliainen <em>et al.</em> [<a class="reference internal" href="book/intro.html#id3" title="J. Pulliainen, P. Lahtinen, J. Kärnä, and S. Koponen. Algorithm Theoretical Definition Document (ATDD) for Product SN-OBS-2 - Snow Status (Dry/Wet) by Microwave Radiometry. Technical Report H11, EUMETSAT H-SAF, 2010.">2010</a>]</span>, as described in this Algorithm Theoretical Basis Document (<a class="reference internal" href="book/intro.html#term-ATBD"><span class="xref std std-term">ATBD</span></a>).</p>
</section>
<span id="document-book/applicable_ref_docs"></span><section class="tex2jax_ignore mathjax_ignore" id="applicable-and-reference-documents">
<h2>Applicable and Reference Documents<a class="headerlink" href="#applicable-and-reference-documents" title="Permalink to this heading">#</a></h2>
<p>List of applicable documents (<a class="reference internal" href="book/intro.html#term-AD"><span class="xref std std-term">AD</span></a>) and reference documents (<a class="reference internal" href="book/intro.html#term-RD"><span class="xref std std-term">RD</span></a>).</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>ID</p></th>
<th class="head"><p>Document</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AD-1  </p></td>
<td><p>C. J. Donlon, 2019. The Copernicus Imaging Microwave Radiometer (CIMR) Mission Requirements Document v4.0, available <a class="reference external" href="https://esamultimedia.esa.int/docs/EarthObservation/CIMR-MRD-v4.0-20201006_Issued.pdf">here</a></p></td>
</tr>
</tbody>
</table>
</section>
<span id="document-book/acronyms"></span><section class="tex2jax_ignore mathjax_ignore" id="acronyms">
<h2>Acronyms<a class="headerlink" href="#acronyms" title="Permalink to this heading">#</a></h2>
<dl class="glossary simple">
<dt id="term-ACDAT">ACDAT<a class="headerlink" href="#term-ACDAT" title="Permalink to this term">#</a></dt><dd><p>Algorithm Calibration Data Set</p>
</dd>
<dt id="term-AD">AD<a class="headerlink" href="#term-AD" title="Permalink to this term">#</a></dt><dd><p>Applicable Document</p>
</dd>
<dt id="term-AVDAT">AVDAT<a class="headerlink" href="#term-AVDAT" title="Permalink to this term">#</a></dt><dd><p>Algorithm Validation Data Set</p>
</dd>
<dt id="term-ATBD">ATBD<a class="headerlink" href="#term-ATBD" title="Permalink to this term">#</a></dt><dd><p>Algorithm Theoretical Basis Document</p>
</dd>
<dt id="term-BCK">BCK<a class="headerlink" href="#term-BCK" title="Permalink to this term">#</a></dt><dd><p>Backward scan</p>
</dd>
<dt id="term-CF">CF<a class="headerlink" href="#term-CF" title="Permalink to this term">#</a></dt><dd><p>NetCDF Climate and Forecast Metadata Conventions</p>
</dd>
<dt id="term-CIMR">CIMR<a class="headerlink" href="#term-CIMR" title="Permalink to this term">#</a></dt><dd><p><a class="reference internal" href="book/intro.html#term-Copernicus-Imaging-Microwave-Radiometer"><span class="xref std std-term">Copernicus Imaging Microwave Radiometer</span></a></p>
</dd>
<dt id="term-CRS">CRS<a class="headerlink" href="#term-CRS" title="Permalink to this term">#</a></dt><dd><p>Coordinate Reference System</p>
</dd>
<dt id="term-EASE-Grid">EASE-Grid<a class="headerlink" href="#term-EASE-Grid" title="Permalink to this term">#</a></dt><dd><p><a class="reference internal" href="book/intro.html#term-Equal-Area-Scalable-Earth-Grid"><span class="xref std std-term">Equal-Area Scalable Earth Grid</span></a></p>
</dd>
<dt id="term-ECMWF">ECMWF<a class="headerlink" href="#term-ECMWF" title="Permalink to this term">#</a></dt><dd><p>European Centre for Medium-Range Weather Forecasts</p>
</dd>
<dt id="term-ESA">ESA<a class="headerlink" href="#term-ESA" title="Permalink to this term">#</a></dt><dd><p>European Space Agency</p>
</dd>
<dt id="term-EUMETSAT">EUMETSAT<a class="headerlink" href="#term-EUMETSAT" title="Permalink to this term">#</a></dt><dd><p>European Organization for the Exploitation of Meteorological Satellites</p>
</dd>
<dt id="term-FMI">FMI<a class="headerlink" href="#term-FMI" title="Permalink to this term">#</a></dt><dd><p>Finnish Meteorological Institute</p>
</dd>
<dt id="term-FN">FN<a class="headerlink" href="#term-FN" title="Permalink to this term">#</a></dt><dd><p>False Negative</p>
</dd>
<dt id="term-FP">FP<a class="headerlink" href="#term-FP" title="Permalink to this term">#</a></dt><dd><p>False Positive</p>
</dd>
<dt id="term-FWD">FWD<a class="headerlink" href="#term-FWD" title="Permalink to this term">#</a></dt><dd><p>Forward scan</p>
</dd>
<dt id="term-H-SAF">H SAF<a class="headerlink" href="#term-H-SAF" title="Permalink to this term">#</a></dt><dd><p>EUMETSAT Support to Operational Hydrology and Water Management</p>
</dd>
<dt id="term-IMS">IMS<a class="headerlink" href="#term-IMS" title="Permalink to this term">#</a></dt><dd><p>Interactive Multisensor Snow and Ice Mapping System</p>
</dd>
<dt id="term-IODD">IODD<a class="headerlink" href="#term-IODD" title="Permalink to this term">#</a></dt><dd><p>Input and Output Data Definition</p>
</dd>
<dt id="term-MPEF">MPEF<a class="headerlink" href="#term-MPEF" title="Permalink to this term">#</a></dt><dd><p>Algorithm Performance Metrics</p>
</dd>
<dt id="term-NH">NH<a class="headerlink" href="#term-NH" title="Permalink to this term">#</a></dt><dd><p>Northern Hemisphere</p>
</dd>
<dt id="term-NRT">NRT<a class="headerlink" href="#term-NRT" title="Permalink to this term">#</a></dt><dd><p>Near Real-Time</p>
</dd>
<dt id="term-NWP">NWP<a class="headerlink" href="#term-NWP" title="Permalink to this term">#</a></dt><dd><p>Numerical Weather Prediction</p>
</dd>
<dt id="term-PMW">PMW<a class="headerlink" href="#term-PMW" title="Permalink to this term">#</a></dt><dd><p>Passive microwave</p>
</dd>
<dt id="term-RD">RD<a class="headerlink" href="#term-RD" title="Permalink to this term">#</a></dt><dd><p>Reference Document</p>
</dd>
<dt id="term-SD">SD<a class="headerlink" href="#term-SD" title="Permalink to this term">#</a></dt><dd><p>Snow depth</p>
</dd>
<dt id="term-SSM-I">SSM/I<a class="headerlink" href="#term-SSM-I" title="Permalink to this term">#</a></dt><dd><p>Special Sensor Microwave/Imager</p>
</dd>
<dt id="term-SSMIS">SSMIS<a class="headerlink" href="#term-SSMIS" title="Permalink to this term">#</a></dt><dd><p>Special Sensor Microwave Imager/Sounder</p>
</dd>
<dt id="term-SWE">SWE<a class="headerlink" href="#term-SWE" title="Permalink to this term">#</a></dt><dd><p><a class="reference internal" href="book/intro.html#term-Snow-water-equivalent"><span class="xref std std-term">Snow water equivalent</span></a></p>
</dd>
<dt id="term-TB">TB<a class="headerlink" href="#term-TB" title="Permalink to this term">#</a></dt><dd><p>Brightness temperature</p>
</dd>
<dt id="term-TN">TN<a class="headerlink" href="#term-TN" title="Permalink to this term">#</a></dt><dd><p>True Negative</p>
</dd>
<dt id="term-TP">TP<a class="headerlink" href="#term-TP" title="Permalink to this term">#</a></dt><dd><p>True Positive</p>
</dd>
<dt id="term-TSA">TSA<a class="headerlink" href="#term-TSA" title="Permalink to this term">#</a></dt><dd><p><a class="reference internal" href="book/intro.html#term-Terrestrial-snow-area"><span class="xref std std-term">Terrestrial snow area</span></a></p>
</dd>
</dl>
</section>
<span id="document-book/definitions"></span><section class="tex2jax_ignore mathjax_ignore" id="definitions">
<h2>Definitions<a class="headerlink" href="#definitions" title="Permalink to this heading">#</a></h2>
<dl class="glossary simple">
<dt id="term-Copernicus-Imaging-Microwave-Radiometer">Copernicus Imaging Microwave Radiometer<a class="headerlink" href="#term-Copernicus-Imaging-Microwave-Radiometer" title="Permalink to this term">#</a></dt><dd><p>The Copernicus Imaging Microwave Radiometer or CIMR mission by ESA includes a wide-swath conically-scanning multi-frequency microwave radiometer with launch planned for 2028.</p>
</dd>
<dt id="term-Dry-snow">Dry snow<a class="headerlink" href="#term-Dry-snow" title="Permalink to this term">#</a></dt><dd><p>Snowpack with liquid water content equal to zero.</p>
</dd>
<dt id="term-Equal-Area-Scalable-Earth-Grid">Equal-Area Scalable Earth Grid<a class="headerlink" href="#term-Equal-Area-Scalable-Earth-Grid" title="Permalink to this term">#</a></dt><dd><p>Northern and Southern Hemisphere projections of EASE-Grid 2.0 are based on polar aspect Lambert azimuthal equal-area projections, as defined by <span id="id1">Brodzik <em>et al.</em> [<a class="reference internal" href="book/intro.html#id17" title="M. Brodzik, B. Billingsley, T. Haran, B. Raup, and M. Savoie. EASE-Grid 2.0: Incremental but Significant Improvements for Earth-Gridded Data Sets. ISPRS International Journal of Geo-Information, 1(1):32–45, 2012. doi:10.3390/ijgi1010032.">2012</a>]</span>.</p>
</dd>
<dt id="term-Scattering-signature">Scattering signature<a class="headerlink" href="#term-Scattering-signature" title="Permalink to this term">#</a></dt><dd><p>Difference in brightness temperature between two different frequency channels for snow-covered ground due to volume scattering.</p>
</dd>
<dt id="term-Signal-saturation">Signal saturation<a class="headerlink" href="#term-Signal-saturation" title="Permalink to this term">#</a></dt><dd><p>Scattering signature cannot be used to estimate snow depths for snow depths above about 1.25m because maximum volume scattering has been reached.</p>
</dd>
<dt id="term-Snow-water-equivalent">Snow water equivalent<a class="headerlink" href="#term-Snow-water-equivalent" title="Permalink to this term">#</a></dt><dd><p>Snow water equivalent or SWE describes the equivalent amount of liquid water contained within a snowpack, and is defined as the product between snow depth and snow density. It is measured as a water column that would result if the whole snowpack was melted instantaneously.</p>
</dd>
<dt id="term-Terrestrial-snow-area">Terrestrial snow area<a class="headerlink" href="#term-Terrestrial-snow-area" title="Permalink to this term">#</a></dt><dd><p>The terrestrial snow area or TSA describes the extent of snow-covered land.</p>
</dd>
</dl>
</section>
<span id="document-book/introduction_purpose_scope"></span><section class="tex2jax_ignore mathjax_ignore" id="introduction-purpose-and-scope">
<h2>Introduction, Purpose and Scope<a class="headerlink" href="#introduction-purpose-and-scope" title="Permalink to this heading">#</a></h2>
<p>Snow monitoring on a global scale is an important task considering the essential role of snow in the global climate and hydrologic systems, and given the scarcity of ground-based snow observations globally.
Snow has distinctive, frequency-dependent characteristics in terms of microwave emission.
This enables the use of brightness temperatures as measured by spaceborne passive microwave sensors, for the estimation of <a class="reference internal" href="book/intro.html#term-Terrestrial-snow-area"><span class="xref std std-term">terrestrial snow area</span></a> (<a class="reference internal" href="book/intro.html#term-TSA"><span class="xref std std-term">TSA</span></a>) through snow detection methods.
Such snow detection is moreover a preprocessing step for the global retrieval of <a class="reference internal" href="book/intro.html#term-Snow-water-equivalent"><span class="xref std std-term">snow water equivalent</span></a> (<a class="reference internal" href="book/intro.html#term-SWE"><span class="xref std std-term">SWE</span></a>) in order to minimise uncertainties in the latter <span id="id1">[<a class="reference internal" href="book/intro.html#id22" title="K. Luojus, J. Pulliainen, M. Takala, J. Lemmetyinen, C. Mortimer, C. Derksen, L. Mudryk, M. Moisander, M. Hiltunen, T. Smolander, J. Ikonen, J. Cohen, M. Salminen, J. Norberg, K. Veijola, and P. Venäläinen. GlobSnow v3.0 Northern Hemisphere snow water equivalent dataset. Scientific Data, 8(163):163, 2021. doi:10.1038/s41597-021-00939-2.">Luojus <em>et al.</em>, 2021</a>]</span>.
Reliable snow detection is thus crucial not only for the estimation of <a class="reference internal" href="book/intro.html#term-TSA"><span class="xref std std-term">TSA</span></a>, but also for the quantification and trend analysis of <a class="reference internal" href="book/intro.html#term-SWE"><span class="xref std std-term">SWE</span></a> <span id="id2">[<a class="reference internal" href="book/intro.html#id6" title="J. Pulliainen, K. Luojus, C. Derksen, L. Mudryk, J. Lemmetyinen, M. Salminen, J. Ikonen, M. Takala, J. Cohen, T. Smolander, and J. Norberg. Patterns and trends of Northern Hemisphere snow mass from 1980 to 2018. Nature, 581:294-298, 2020. doi:10.1038/s41586-020-2258-0.">Pulliainen <em>et al.</em>, 2020</a>]</span>.</p>
<p>Snow is a mixture of ice crystals, liquid water and air.
Over time, the density of a snow pack increases due to compaction by wind and gravity, and due to thermal metamorphism.
Its internal structure is characterised primarily by the grain or crystal size, and by the form and orientation of those crystals.
A further property is snow wetness which refers to the liquid water content.
For temperatures at or above the freezing point, a considerable amount of liquid water might be present within a ‘wet’ snowpack.
For temperatures below the freezing point, on the other hand, a snowpack is unlikely to contain any liquid water and is thus considered to be ‘dry’.
Below we discuss <a class="reference internal" href="book/intro.html#term-PMW"><span class="xref std std-term">PMW</span></a> remote sensing of snow with a focus on the detection of (mostly) <a class="reference internal" href="book/intro.html#term-Dry-snow"><span class="xref std std-term">dry snow</span></a> and associated challenges.</p>
<p>In contrast to visible and near-infrared bands, dry snow is mostly transparent to microwave radiation.
The microwave energy that is emitted from a snowpack hence originates not only from its surface, but also from deeper snow layers and from the ground beneath.
For dry snow detection, the contribution in emission from the snow layer itself is most of the times negligible because of its low emissivity in comparison to the ground underneath.
The emission of the ground is in turn attenuated by the snow cover, predominantly due to volume scattering.
Since the magnitude of this attenuation is dependent on the microwave wavelength amongst other factors, lower brightness temperatures are measured for higher frequencies in the presence of snow.
Dry snow is thus commonly detected by comparing the brightness temperatures of different frequency bands in order to identify such attenuation.</p>
<p>Volume scattering, the dominating type of attenuation as observed for dry snow, is highly dependent on frequency.
Air acts as a surrounding medium for the ice particles with diameters on the order of millimetres.
For propagating waves with wavelengths noticeably larger than this, snow appears as a homogeneous medium with only absorptive effects.
For wavelengths of similar magnitude, the ice particles act as scatterers due to the inhomogeneous dielectric properties between the ice itself and the air background <span id="id3">[<a class="reference internal" href="book/intro.html#id15" title="F. Ulaby and D. Long. Microwave Radar and Radiometric Remote Sensing. The University of Michigan Press, 2014. doi:10.3998/0472119356.">Ulaby and Long, 2014</a>]</span>.
This scattering mechanism is illustrated in <a class="reference internal" href="#emission-scattering"><span class="std std-numref">Fig. 1</span></a>.
The phenomenon that the emissivity of snow-covered ground decreases with increasing frequency, is unique among land cover types and is directly influenced by the snow’s properties <span id="id4">[<a class="reference internal" href="book/intro.html#id13" title="C. Mätzler. Passive microwave signatures of landscapes in winter. Meteorology and Atmospheric Physics, 54:241-260, 1994. doi:10.1007/BF01030063.">Mätzler, 1994</a>]</span>.
The impact of wavelength on scattering behaviour can be applied to snow grain size: the higher the frequency and/or the larger the grains, the more scattering is observed as the particle size approaches the wavelength.
Snow density has a similar effect to grain size and since both generally increase for aging snow, older snowpacks result in more attenuation.
A further aspect to consider is snow depth, given deeper snowpacks naturally allow for more scattering to take place.</p>
<figure class="align-default" id="emission-scattering">
<a class="reference internal image-reference" href="../_images/emission-scattering.png"><img alt="../_images/emission-scattering.png" src="../_images/emission-scattering.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">Schematic of the microwave emission from snow characterised by volume scattering.</span><a class="headerlink" href="#emission-scattering" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>This attenuation found for snow-covered surfaces is detected through the difference in brightness temperature between two (or more) PMW bands.
A channel of lower frequency provides a scatter-free reference brightness temperature, whereas higher frequency channels may show an attenuation in brightness temperatures due to their sensitivity to scattering.
For this, the Ku and Ka-band are common respective choices <span id="id5">[<a class="reference internal" href="book/intro.html#id7" title="A. Chang, J. Foster, and D. Hall. Nimbus-7 SMMR derived global snow cover parameters. Ann. Glaciol., 9:39-44, 1987. doi:10.3189/S0260305500200736.">Chang <em>et al.</em>, 1987</a>, <a class="reference internal" href="book/intro.html#id8" title="J. Foster, A. Chang, and D. Hall. Comparison of snow mass estimates from a prototype passive microwave snow algorithm, a revised algorithm and a snow depth climatology. Remote Sensing of Environment, 62(2):132-142, 1997. doi:10.1016/S0034-4257(97)00085-0.">Foster <em>et al.</em>, 1997</a>, <a class="reference internal" href="book/intro.html#id9" title="N. Grody and A. Basist. Global identification of snowcover using SSM/I measurements. IEEE Transactions on Geoscience and Remote Sensing, 34(1):237-249, 1996. doi:10.1109/36.481908.">Grody and Basist, 1996</a>, <a class="reference internal" href="book/intro.html#id2" title="D. Hall, R. Kelly, G. Riggs, A. Chang, and J. Foster. Assessment of the relative accuracy of hemispheric-scale snow-cover maps. Ann. Glaciol., 34:24-30, 2002. doi:10.3189/172756402781817770.">Hall <em>et al.</em>, 2002</a>]</span>.
Such a spectral difference, often referred to as scattering signature, is obviously sensitive to snow presence in first place as well as to snow properties and even to subnivean soil conditions <span id="id6">[<a class="reference internal" href="book/intro.html#id13" title="C. Mätzler. Passive microwave signatures of landscapes in winter. Meteorology and Atmospheric Physics, 54:241-260, 1994. doi:10.1007/BF01030063.">Mätzler, 1994</a>]</span>.</p>
<p>This sensitivity to snow properties can be exploited to derive snow depth estimates from scattering signatures.
However, snow depths of less than about 3 cm are seldomly detected because the scattering effect is only marginal <span id="id7">[<a class="reference internal" href="book/intro.html#id7" title="A. Chang, J. Foster, and D. Hall. Nimbus-7 SMMR derived global snow cover parameters. Ann. Glaciol., 9:39-44, 1987. doi:10.3189/S0260305500200736.">Chang <em>et al.</em>, 1987</a>, <a class="reference internal" href="book/intro.html#id2" title="D. Hall, R. Kelly, G. Riggs, A. Chang, and J. Foster. Assessment of the relative accuracy of hemispheric-scale snow-cover maps. Ann. Glaciol., 34:24-30, 2002. doi:10.3189/172756402781817770.">Hall <em>et al.</em>, 2002</a>]</span>.
To improve the sensitivity to thin snowpacks, brightness temperatures from high frequencies of 85 GHz and above can be included as those are subject to increased volume scattering <span id="id8">[<a class="reference internal" href="book/intro.html#id9" title="N. Grody and A. Basist. Global identification of snowcover using SSM/I measurements. IEEE Transactions on Geoscience and Remote Sensing, 34(1):237-249, 1996. doi:10.1109/36.481908.">Grody and Basist, 1996</a>]</span>.
In addition, the influence of the underlying ground on the observed emission is more apparent for shallow snowpacks; an increase in soil temperature and/or wetness may significantly increase the measured brightness temperature.
On the other hand, snow depths corresponding to bulk <a class="reference internal" href="book/intro.html#term-SWE"><span class="xref std std-term">SWE</span></a> of about 150 mm become problematic as the maximum observable scattering is reached.
This results in signal saturation i.e. snow depths cannot be reliably estimated anymore using the brightness temperature difference since no variations in scattering are present beyond this snow depth <span id="id9">[<a class="reference internal" href="book/intro.html#id19" title="M. Takala, K. Luojus, J. Pulliainen, C. Derksen, J. Lemmetyinen, J. Kärnä, J. Koskinen, and B. Bojkov. Estimating northern hemisphere snow water equivalent for climate research through assimilation of space-borne radiometer data and ground-based measurements. Remote Sensing of Environment, 115:3517–3529, 2011. doi:10.1016/j.rse.2011.08.014.">Takala <em>et al.</em>, 2011</a>]</span>.
Snow is now the primary emitter, and its emissivity starts to increase rather than decrease for increasing snow depth <span id="id10">[<a class="reference internal" href="book/intro.html#id8" title="J. Foster, A. Chang, and D. Hall. Comparison of snow mass estimates from a prototype passive microwave snow algorithm, a revised algorithm and a snow depth climatology. Remote Sensing of Environment, 62(2):132-142, 1997. doi:10.1016/S0034-4257(97)00085-0.">Foster <em>et al.</em>, 1997</a>, <a class="reference internal" href="book/intro.html#id13" title="C. Mätzler. Passive microwave signatures of landscapes in winter. Meteorology and Atmospheric Physics, 54:241-260, 1994. doi:10.1007/BF01030063.">Mätzler, 1994</a>]</span>.</p>
<p>In contrast to dry snow and regardless of polarisation, consistently wet or melting snow can be hardly discriminated from bare wet or frozen soil.
The liquid water content significantly reduces if not eliminates the snowpack’s transparency to microwave radiation, as shown in <a class="reference internal" href="#emission-ambient"><span class="std std-numref">Fig. 2</span></a>.
The scattering signature as such is thus not present, and the emissivity spectrum of wet snow is hence drastically different to the one of dry snow <span id="id11">[<a class="reference internal" href="book/intro.html#id13" title="C. Mätzler. Passive microwave signatures of landscapes in winter. Meteorology and Atmospheric Physics, 54:241-260, 1994. doi:10.1007/BF01030063.">Mätzler, 1994</a>]</span>.
The internal wetness of snow also affects the capability of scattering signatures for snow accumulation monitoring.
Even though PMW remote sensing can be used to retrieve accumulation rates in the dry-snow zone of ice sheets, it is greatly limited by spatial and temporal variability in liquid water and refrozen subsurface ice structures, and relies highly on in situ measurements.
An additional classification for glacial ice might need to be introduced since common scattering signatures for snow detection can result in a lack of scattering for large regions of Greenland and Antarctica <span id="id12">[<a class="reference internal" href="book/intro.html#id9" title="N. Grody and A. Basist. Global identification of snowcover using SSM/I measurements. IEEE Transactions on Geoscience and Remote Sensing, 34(1):237-249, 1996. doi:10.1109/36.481908.">Grody and Basist, 1996</a>]</span>.</p>
<figure class="align-default" id="emission-ambient">
<a class="reference internal image-reference" href="../_images/emission-ambient.png"><img alt="../_images/emission-ambient.png" src="../_images/emission-ambient.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Schematic of the effect of ambient conditions (vegetation and liquid water content) on the microwave emission from snow.</span><a class="headerlink" href="#emission-ambient" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Liquid water similarly poses a key challenge in form of water bodies.
For that reason, large waters such as oceans and large lakes are commonly masked out, as are pixels that cover large percentages of water e.g. in coastal areas or lakeland.
Another problem is that most of the Earth’s seasonal snow cover occurs in complex landscapes.
Firstly, mountainous terrain hinders snow detection since large spatial differences in snow depth are to be expected: whilst deep snow eventually reaches saturation depth, the signal of areas with shallow snow prevails which may be mistaken for bare ground.
And secondly, the changes in slope gradient within the sensor footprint cause variations in (local) observation angle and thus in view-dependent emissivity which again may be falsely identified as snow-free conditions.
Besides, overlying vegetation reflects upwelling microwave radiation and emits some on its own <span id="id13">[<a class="reference internal" href="book/intro.html#id9" title="N. Grody and A. Basist. Global identification of snowcover using SSM/I measurements. IEEE Transactions on Geoscience and Remote Sensing, 34(1):237-249, 1996. doi:10.1109/36.481908.">Grody and Basist, 1996</a>]</span>, as illustrated in <a class="reference internal" href="#emission-ambient"><span class="std std-numref">Fig. 2</span></a>.
Snow cover in forested areas consequently presents higher emissivities and brightness temperatures than in unforested regions.</p>
<p>Limitations of dry snow detection based on the scattering signature also arise due to anomalous scattering signals, caused for instance by precipitation or cold deserts <span id="id14">[<a class="reference internal" href="book/intro.html#id9" title="N. Grody and A. Basist. Global identification of snowcover using SSM/I measurements. IEEE Transactions on Geoscience and Remote Sensing, 34(1):237-249, 1996. doi:10.1109/36.481908.">Grody and Basist, 1996</a>]</span>, or due to internal variations in snow properties.
The latter includes variations in density and grain size resulting from the snowpack stratigraphy.
Those distinctive snow layers affect more the horizontal than the vertical polarisations of the Ku and Ka-band channels <span id="id15">[<a class="reference internal" href="book/intro.html#id16" title="R. Kelly, A. Chang, L. Tsang, and J. Foster. A prototype AMSR-E global snow area and snow depth algorithm. IEEE Transactions on Geoscience and Remote Sensing, 41(2):230-242, 2003. doi:10.1109/TGRS.2003.809118.">Kelly <em>et al.</em>, 2003</a>]</span>.
It could be derived that vertical polarisations are more appropriate for snow depth estimations given they are less responsive to internal characteristics, whilst horizontal polarisations are more sensitive to those same properties and therefore suitable for detecting dry snow in first place <span id="id16">[<a class="reference internal" href="book/intro.html#id16" title="R. Kelly, A. Chang, L. Tsang, and J. Foster. A prototype AMSR-E global snow area and snow depth algorithm. IEEE Transactions on Geoscience and Remote Sensing, 41(2):230-242, 2003. doi:10.1109/TGRS.2003.809118.">Kelly <em>et al.</em>, 2003</a>]</span>.
Nonetheless, either polarisation have been applied for dry snow detection.</p>
<p>The purpose of this <a class="reference internal" href="book/intro.html#term-ATBD"><span class="xref std std-term">ATBD</span></a> is to detail the implementation of the CIMR Level-2 Terrestrial Snow Area (TSA) product, in form of a binary classification.
The scope is the implementation of a stable version using horizontally polarised Ka and Ku-band brightness temperatures as core frequency bands according to <span id="id17">Hall <em>et al.</em> [<a class="reference internal" href="book/intro.html#id2" title="D. Hall, R. Kelly, G. Riggs, A. Chang, and J. Foster. Assessment of the relative accuracy of hemispheric-scale snow-cover maps. Ann. Glaciol., 34:24-30, 2002. doi:10.3189/172756402781817770.">2002</a>]</span> and <span id="id18">Pulliainen <em>et al.</em> [<a class="reference internal" href="book/intro.html#id3" title="J. Pulliainen, P. Lahtinen, J. Kärnä, and S. Koponen. Algorithm Theoretical Definition Document (ATDD) for Product SN-OBS-2 - Snow Status (Dry/Wet) by Microwave Radiometry. Technical Report H11, EUMETSAT H-SAF, 2010.">2010</a>]</span>.</p>
</section>
<span id="document-book/background_justification_algorithm"></span><section class="tex2jax_ignore mathjax_ignore" id="background-and-justification-of-selected-algorithm">
<h2>Background and Justification of Selected Algorithm<a class="headerlink" href="#background-and-justification-of-selected-algorithm" title="Permalink to this heading">#</a></h2>
<p>Dry snow is often detected by the use of multi-spectral and/or multi-polarization methods.
Such passive microwave dry snow detection algorithms are commonly based on the Ka and Ku-band <span id="id1">[<a class="reference internal" href="book/intro.html#id7" title="A. Chang, J. Foster, and D. Hall. Nimbus-7 SMMR derived global snow cover parameters. Ann. Glaciol., 9:39-44, 1987. doi:10.3189/S0260305500200736.">Chang <em>et al.</em>, 1987</a>, <a class="reference internal" href="book/intro.html#id2" title="D. Hall, R. Kelly, G. Riggs, A. Chang, and J. Foster. Assessment of the relative accuracy of hemispheric-scale snow-cover maps. Ann. Glaciol., 34:24-30, 2002. doi:10.3189/172756402781817770.">Hall <em>et al.</em>, 2002</a>]</span>.
For the <a class="reference internal" href="book/intro.html#term-TSA"><span class="xref std std-term">TSA</span></a> product, the dry snow detection algorithm by <span id="id2">Pulliainen <em>et al.</em> [<a class="reference internal" href="book/intro.html#id3" title="J. Pulliainen, P. Lahtinen, J. Kärnä, and S. Koponen. Algorithm Theoretical Definition Document (ATDD) for Product SN-OBS-2 - Snow Status (Dry/Wet) by Microwave Radiometry. Technical Report H11, EUMETSAT H-SAF, 2010.">2010</a>]</span> is selected, which implements the approach by <span id="id3">Hall <em>et al.</em> [<a class="reference internal" href="book/intro.html#id2" title="D. Hall, R. Kelly, G. Riggs, A. Chang, and J. Foster. Assessment of the relative accuracy of hemispheric-scale snow-cover maps. Ann. Glaciol., 34:24-30, 2002. doi:10.3189/172756402781817770.">2002</a>]</span> with updated empirical thresholds.
The origins of the algorithm reach back to a physical model inversion by <span id="id4">Chang <em>et al.</em> [<a class="reference internal" href="book/intro.html#id7" title="A. Chang, J. Foster, and D. Hall. Nimbus-7 SMMR derived global snow cover parameters. Ann. Glaciol., 9:39-44, 1987. doi:10.3189/S0260305500200736.">1987</a>]</span>.</p>
<p>The algorithm in this form is found to perform best for the channels available from <a class="reference internal" href="book/intro.html#term-CIMR"><span class="xref std std-term">CIMR</span></a>, according to <span id="id5">Zschenderlein <em>et al.</em> [<a class="reference internal" href="book/intro.html#id18" title="L. Zschenderlein, K. Luojus, M. Takala, P. Venäläinen, and J. Pulliainen. Evaluation of passive microwave dry snow detection algorithms and application to SWE retrieval during seasonal snow accumulation. Remote Sensing of Environment, 288:113476, 2023. doi:10.1016/j.rse.2023.113476.">2023</a>]</span>.
This study includes an extensive long-term comparison of <a class="reference internal" href="book/intro.html#term-PMW"><span class="xref std std-term">PMW</span></a> dry snow detection approaches centering on the Ka and Ku-bands, namely <span id="id6">Armstrong and Brodzik [<a class="reference internal" href="book/intro.html#id11" title="R. Armstrong and M. Brodzik. Recent Northern Hemisphere snow extent: a comparison of data derived from visible and microwave satellite sensors. Geophysical Research Letters, 28(19):3673-3676, 2001. doi:10.1029/2000GL012556.">2001</a>], Chang <em>et al.</em> [<a class="reference internal" href="book/intro.html#id7" title="A. Chang, J. Foster, and D. Hall. Nimbus-7 SMMR derived global snow cover parameters. Ann. Glaciol., 9:39-44, 1987. doi:10.3189/S0260305500200736.">1987</a>], Foster <em>et al.</em> [<a class="reference internal" href="book/intro.html#id8" title="J. Foster, A. Chang, and D. Hall. Comparison of snow mass estimates from a prototype passive microwave snow algorithm, a revised algorithm and a snow depth climatology. Remote Sensing of Environment, 62(2):132-142, 1997. doi:10.1016/S0034-4257(97)00085-0.">1997</a>], Grody and Basist [<a class="reference internal" href="book/intro.html#id9" title="N. Grody and A. Basist. Global identification of snowcover using SSM/I measurements. IEEE Transactions on Geoscience and Remote Sensing, 34(1):237-249, 1996. doi:10.1109/36.481908.">1996</a>]</span>, <span id="id7">Hall <em>et al.</em> [<a class="reference internal" href="book/intro.html#id2" title="D. Hall, R. Kelly, G. Riggs, A. Chang, and J. Foster. Assessment of the relative accuracy of hemispheric-scale snow-cover maps. Ann. Glaciol., 34:24-30, 2002. doi:10.3189/172756402781817770.">2002</a>]</span> and <span id="id8">Pulliainen <em>et al.</em> [<a class="reference internal" href="book/intro.html#id3" title="J. Pulliainen, P. Lahtinen, J. Kärnä, and S. Koponen. Algorithm Theoretical Definition Document (ATDD) for Product SN-OBS-2 - Snow Status (Dry/Wet) by Microwave Radiometry. Technical Report H11, EUMETSAT H-SAF, 2010.">2010</a>]</span>.
The latter two algorithms are implemented in the GlobSnow v3.0 <a class="reference internal" href="book/intro.html#term-SWE"><span class="xref std std-term">SWE</span></a> product of the Global Snow Monitoring for Climate Research initiative of the European Space Agency (<a class="reference internal" href="book/intro.html#term-ESA"><span class="xref std std-term">ESA</span></a>) <span id="id9">[<a class="reference internal" href="book/intro.html#id22" title="K. Luojus, J. Pulliainen, M. Takala, J. Lemmetyinen, C. Mortimer, C. Derksen, L. Mudryk, M. Moisander, M. Hiltunen, T. Smolander, J. Ikonen, J. Cohen, M. Salminen, J. Norberg, K. Veijola, and P. Venäläinen. GlobSnow v3.0 Northern Hemisphere snow water equivalent dataset. Scientific Data, 8(163):163, 2021. doi:10.1038/s41597-021-00939-2.">Luojus <em>et al.</em>, 2021</a>]</span>, and in the snow status (dry/wet) H11 product by the Support to Operational Hydrology and Water Management (<a class="reference internal" href="book/intro.html#term-H-SAF"><span class="xref std std-term">H SAF</span></a>) of the European Organization for the Exploitation of Meteorological Satellites (<a class="reference internal" href="book/intro.html#term-EUMETSAT"><span class="xref std std-term">EUMETSAT</span></a>).
The approaches by <span id="id10">Hall <em>et al.</em> [<a class="reference internal" href="book/intro.html#id2" title="D. Hall, R. Kelly, G. Riggs, A. Chang, and J. Foster. Assessment of the relative accuracy of hemispheric-scale snow-cover maps. Ann. Glaciol., 34:24-30, 2002. doi:10.3189/172756402781817770.">2002</a>]</span> and <span id="id11">Pulliainen <em>et al.</em> [<a class="reference internal" href="book/intro.html#id3" title="J. Pulliainen, P. Lahtinen, J. Kärnä, and S. Koponen. Algorithm Theoretical Definition Document (ATDD) for Product SN-OBS-2 - Snow Status (Dry/Wet) by Microwave Radiometry. Technical Report H11, EUMETSAT H-SAF, 2010.">2010</a>]</span> are thus referred to as <em>GlobSnow</em> and <em>H SAF</em>, respectively.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Due to significant differences in microwave emission between wet and dry snow <span id="id12">[<a class="reference internal" href="book/intro.html#id13" title="C. Mätzler. Passive microwave signatures of landscapes in winter. Meteorology and Atmospheric Physics, 54:241-260, 1994. doi:10.1007/BF01030063.">Mätzler, 1994</a>]</span>, the PMW methods mentioned here apply only to dry snow conditions with minimal liquid water content, and are furthermore static i.e. disregarding temporal variations for instance in snow grain size or snow density.</p>
</div>
<p>PMW dry snow detection algorithms are known to generally underestimate the presence of snow due to their sensitivity to vegetation and liquid water content of the snowpack, among other reasons.
This can be seen in <a class="reference internal" href="#difference"><span class="std std-numref">Fig. 3</span></a> which illustrates the difference between snow extent as estimated by GlobSnow and H SAF for brightness temperatures of SSM/I and SSMIS, with respect to snow maps of the Interactive Multisensor Snow and Ice Mapping System (<a class="reference internal" href="book/intro.html#term-IMS"><span class="xref std std-term">IMS</span></a>).
Daily <a class="reference internal" href="book/intro.html#term-IMS"><span class="xref std std-term">IMS</span></a> maps are based on multiple input sources and human analysis, and serve therefore as spatially complete reference for global snow extent complementing pointwise weather station measurements.
A negative number indicates the days per pixel for which the PMW algorithm flags ‘snow-free’ and IMS data flags ‘snow’, and vice versa for a positive number.
The difference shown in <a class="reference internal" href="#difference"><span class="std std-numref">Fig. 3</span></a> then gives the final sum of both cases for every day of the investigated time period, and thus shows the tendency of an algorithm to under- or overestimate.
The better performance of H SAF over GlobSnow is apparent, and the dry snow detection part of the ESA Snow Climate Change Initiative (CCI) project has been updated accordingly to the approach by <span id="id13">Pulliainen <em>et al.</em> [<a class="reference internal" href="book/intro.html#id3" title="J. Pulliainen, P. Lahtinen, J. Kärnä, and S. Koponen. Algorithm Theoretical Definition Document (ATDD) for Product SN-OBS-2 - Snow Status (Dry/Wet) by Microwave Radiometry. Technical Report H11, EUMETSAT H-SAF, 2010.">2010</a>]</span>.
This approach is the most accurate to-date on a global scale for the channels available on CIMR, and is therefore chosen for the Level-2 TSA product.</p>
<figure class="align-default" id="difference">
<a class="reference internal image-reference" href="../_images/difference.png"><img alt="../_images/difference.png" src="../_images/difference.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Difference maps of PMW algorithms with respect to IMS data over all snow seasons (September-February) from 2007/2008 until 2016/2017 above 40° N, based on <span id="id14">Zschenderlein <em>et al.</em> [<a class="reference internal" href="book/intro.html#id18" title="L. Zschenderlein, K. Luojus, M. Takala, P. Venäläinen, and J. Pulliainen. Evaluation of passive microwave dry snow detection algorithms and application to SWE retrieval during seasonal snow accumulation. Remote Sensing of Environment, 288:113476, 2023. doi:10.1016/j.rse.2023.113476.">2023</a>]</span>.</span><a class="headerlink" href="#difference" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<span id="document-book/L2_product_definition"></span><section class="tex2jax_ignore mathjax_ignore" id="level-2-product-definition">
<h2>Level-2 Product Definition<a class="headerlink" href="#level-2-product-definition" title="Permalink to this heading">#</a></h2>
<p>The Level-2 TSA product files are provided in netCDF format, with contents as defined in Tables <a class="reference internal" href="#product-netcdf"><span class="std std-numref">1</span></a>, <a class="reference internal" href="#variable-attributes"><span class="std std-numref">2</span></a>, and <a class="reference internal" href="#global-attributes"><span class="std std-numref">3</span></a>.
Each data variable of the processed data in <a class="reference internal" href="#product-netcdf"><span class="std std-numref">Table 1</span></a> holds conventional attributes following NetCDF Climate and Forecast Metadata Conventions Version 1.7 (CF-1.7) or above as given in <a class="reference internal" href="#variable-attributes"><span class="std std-numref">Table 2</span></a>.
Some global attributes of the Level-2 product files are given in <a class="reference internal" href="#global-attributes"><span class="std std-numref">Table 3</span></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Refer <a class="reference internal" href="book/intro.html#document-algorithm/CIMR_L2_TSA_PICASSO"><span class="doc std std-doc">here</span></a> for a sample run demonstrating the processing sequence to create the L2 TSA product files.</p>
</div>
<table class="colwidths-auto table" id="product-netcdf">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">NetCDF Group: Processed Data (tbc).</span><a class="headerlink" href="#product-netcdf" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Variable name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Dimension</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tsa</span></code></p></td>
<td><p>Terrestrial snow area <code class="docutils literal notranslate"><span class="pre">({term}</span></code>TSA`)</p></td>
<td><p>1</p></td>
<td><p>(nx,ny)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">tsa_uncertainty</span></code></p></td>
<td><p>Confidence of detected  TSA</p></td>
<td><p>1</p></td>
<td><p>(nx,ny)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">status_flag</span></code></p></td>
<td><p>Flag indicating pixel status</p></td>
<td><p>n/a</p></td>
<td><p>(nx,ny)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">crs</span></code></p></td>
<td><p>Coordinate reference system (<a class="reference internal" href="book/intro.html#term-CRS"><span class="xref std std-term">CRS</span></a>) of the TSA product</p></td>
<td><p>n/a</p></td>
<td><p>n/a</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">lat</span></code></p></td>
<td><p>Latitudes of pixel centres according to CRS</p></td>
<td><p>degrees North</p></td>
<td><p>(nx,ny)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">lon</span></code></p></td>
<td><p>Longitudes of pixel centres according to CRS</p></td>
<td><p>degrees East</p></td>
<td><p>(nx,ny)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">x</span></code></p></td>
<td><p>x-Coordinate of the CRS</p></td>
<td><p>m</p></td>
<td><p>(nx)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">y</span></code></p></td>
<td><p>y-Coordinate of the CRS</p></td>
<td><p>m</p></td>
<td><p>(ny)</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The CIMR Level-2 TSA product are gridded files. The dimensions of each variable in the Level-2 file refer to the (nx,ny) dimensions of the product grid, i.e. EASE-Grid 2.0 NH polar projection.</p>
</div>
<table class="colwidths-auto table" id="variable-attributes">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">Standard variable attributes (tbc).</span><a class="headerlink" href="#variable-attributes" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">standard_name</span></code></p></td>
<td><p>Sandard name referencing the description of a variable’s content</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">long_name</span></code></p></td>
<td><p>Descriptive name indicating a variable’s content</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fill_value</span></code></p></td>
<td><p>Value indicating missing or undefined data</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">units</span></code></p></td>
<td><p>Unit of measure</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-auto table" id="global-attributes">
<caption><span class="caption-number">Table 3 </span><span class="caption-text">Global attributes (tbc).</span><a class="headerlink" href="#global-attributes" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">title</span></code></p></td>
<td><p>CIMR L2 Terrestrial Snow Area</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">processing_level</span></code></p></td>
<td><p>Level-2</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">time_coverage_start</span></code></p></td>
<td><p>Valid start time of the product</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">time_coverage_end</span></code></p></td>
<td><p>Valid end time of the product</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">area</span></code></p></td>
<td><p>Northern Hemisphere</p></td>
</tr>
</tbody>
</table>
</section>
<span id="document-book/baseline_algorithm_definition"></span><section class="tex2jax_ignore mathjax_ignore" id="baseline-algorithm-definition">
<h2>Baseline Algorithm Definition<a class="headerlink" href="#baseline-algorithm-definition" title="Permalink to this heading">#</a></h2>
<p>The <a class="reference internal" href="book/intro.html#term-TSA"><span class="xref std std-term">TSA</span></a> algorithm is based on dry snow detection as described by <span id="id1">Hall <em>et al.</em> [<a class="reference internal" href="book/intro.html#id2" title="D. Hall, R. Kelly, G. Riggs, A. Chang, and J. Foster. Assessment of the relative accuracy of hemispheric-scale snow-cover maps. Ann. Glaciol., 34:24-30, 2002. doi:10.3189/172756402781817770.">2002</a>]</span> and <span id="id2">Pulliainen <em>et al.</em> [<a class="reference internal" href="book/intro.html#id3" title="J. Pulliainen, P. Lahtinen, J. Kärnä, and S. Koponen. Algorithm Theoretical Definition Document (ATDD) for Product SN-OBS-2 - Snow Status (Dry/Wet) by Microwave Radiometry. Technical Report H11, EUMETSAT H-SAF, 2010.">2010</a>]</span>. This empirical algorithm is based on the underlying physical principle that microwave radiation of higher frequencies is attenuated by snow cover due to volume scattering, while lower frequencies remain mostly unaffected.
The TSA product is only concerned with snow cover in the Northern Hemisphere, where seasonal terrestrial snow predominantly occurs.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Refer <a class="reference internal" href="book/intro.html#document-algorithm/run_CIMR_L2_TSA"><span class="doc std std-doc">here</span></a> for a top-level script of the Level-2 TSA algorithm including output file generation, and <a class="reference internal" href="book/intro.html#document-algorithm/run_CIMR_L2_TSA"><span class="doc std std-doc">here</span></a> for added step-by-step visualization.</p>
</div>
<section id="retrieval-method">
<h3>Retrieval Method<a class="headerlink" href="#retrieval-method" title="Permalink to this heading">#</a></h3>
<p>The retrieval of TSA encompasses the following main steps:</p>
<ul class="simple">
<li><p>Step 1: <strong>Dry snow detection</strong> algorithm</p></li>
<li><p>Step 2: <strong>Combined reprojection</strong> of forward and backward TSA maps</p></li>
<li><p>Step 3: <strong>Masking and Flagging</strong> for final TSA maps including qualitative uncertainty estimates</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The specifics of the retrieval methodology may be subject to change, but will follow the general structure as outlined.</p>
</div>
</section>
<section id="forward-model">
<h3>Forward Model<a class="headerlink" href="#forward-model" title="Permalink to this heading">#</a></h3>
<p>The origins of the implemented algorithm stem from <span id="id3">Chang <em>et al.</em> [<a class="reference internal" href="book/intro.html#id7" title="A. Chang, J. Foster, and D. Hall. Nimbus-7 SMMR derived global snow cover parameters. Ann. Glaciol., 9:39-44, 1987. doi:10.3189/S0260305500200736.">1987</a>]</span>, who present a linear relationship between snow depth and spectral difference (see <a class="reference internal" href="#equation-tb-diff">(1)</a>).
This relationship is derived from an empirical fit of simulated microwave brightness temperatures for varying <a class="reference internal" href="book/intro.html#term-SWE"><span class="xref std std-term">SWE</span></a>, using a microscopic scattering model <span id="id4">[<a class="reference internal" href="book/intro.html#id23" title="A. Chang, J. Foster, D. Hall, A. Rango, and B. Hartline. Snow water equivalent estimation by microwave radiometry. Cold Regions Science and Technology, 5(3):259–267, 1982. doi:10.1016/0165-232X(82)90019-2.">Chang <em>et al.</em>, 1982</a>]</span>.
The model takes into consideration the underlying (un-)frozen surface conditions as well as the physical temperature, density, and grain size of the snowpack.
Snow grains are assumed to be spherical and randomly-spaced, resulting in incoherent scattering.
The radiative transfer equation is solved numerically.</p>
</section>
<section id="cimr-level-1b-resampling-approach">
<h3>CIMR Level-1b Resampling Approach<a class="headerlink" href="#cimr-level-1b-resampling-approach" title="Permalink to this heading">#</a></h3>
<p>Prior to the main TSA algorithm, the current <a class="reference internal" href="book/intro.html#term-CIMR"><span class="xref std std-term">CIMR</span></a> Level-2 TSA framework includes the resampling of L1b TB data to collocate channels to a target channel.
The implemented resampling approach stems from the <a class="reference external" href="https://github.com/CIMR-Algos/Tools">CIMR Devalgo Tools</a>, with the target resolution of Ku-band TB data being set to match Ka-band resolution.
For future research purposes, it is encouraged to also remap X-band TB data with Ka-band as target.</p>
</section>
<section id="algorithm-assumptions-and-simplifications">
<h3>Algorithm Assumptions and Simplifications<a class="headerlink" href="#algorithm-assumptions-and-simplifications" title="Permalink to this heading">#</a></h3>
<p>The implemented algorithm follows a static approach, assuming that snow density and snow grain properties are spatially and temporally constant.
Different land cover properties are not considered.</p>
</section>
<section id="level-2-end-to-end-algorithm-functional-flow-diagram">
<h3>Level-2 End-to-End Algorithm Functional Flow Diagram<a class="headerlink" href="#level-2-end-to-end-algorithm-functional-flow-diagram" title="Permalink to this heading">#</a></h3>
<p><a class="reference internal" href="#flow-diagram"><span class="std std-numref">Fig. 4</span></a> shows the functional structure for the computation of the TSA product.</p>
<figure class="align-default" id="flow-diagram">
<a class="reference internal image-reference" href="../_images/L2-algorithm.png"><img alt="../_images/L2-algorithm.png" src="../_images/L2-algorithm.png" style="width: 450px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Functional flow diagram of the Level-2 end to end algorithm of the TSA product.</span><a class="headerlink" href="#flow-diagram" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="functional-description-of-each-algorithm-step">
<h3>Functional Description of Each Algorithm Step<a class="headerlink" href="#functional-description-of-each-algorithm-step" title="Permalink to this heading">#</a></h3>
<p>The three main steps, as outlined in the flow diagram in <a class="reference internal" href="#flow-diagram"><span class="std std-numref">Fig. 4</span></a>, are described hereafter.</p>
<section id="dry-snow-detection">
<h4>Dry Snow Detection<a class="headerlink" href="#dry-snow-detection" title="Permalink to this heading">#</a></h4>
<section id="mathematical-description">
<h5>Mathematical description<a class="headerlink" href="#mathematical-description" title="Permalink to this heading">#</a></h5>
<p>The dry snow detection algorithm of the TSA product is based on the approach of <span id="id5">Hall <em>et al.</em> [<a class="reference internal" href="book/intro.html#id2" title="D. Hall, R. Kelly, G. Riggs, A. Chang, and J. Foster. Assessment of the relative accuracy of hemispheric-scale snow-cover maps. Ann. Glaciol., 34:24-30, 2002. doi:10.3189/172756402781817770.">2002</a>]</span> but applies updated empirically derived thresholds as implemented for the EUMETSAT H SAF snow status product H11 <span id="id6">[<a class="reference internal" href="book/intro.html#id3" title="J. Pulliainen, P. Lahtinen, J. Kärnä, and S. Koponen. Algorithm Theoretical Definition Document (ATDD) for Product SN-OBS-2 - Snow Status (Dry/Wet) by Microwave Radiometry. Technical Report H11, EUMETSAT H-SAF, 2010.">Pulliainen <em>et al.</em>, 2010</a>]</span>. The brightness temperature difference between the Ku and Ka-band is used to estimate snow depth (SD) as</p>
<div class="math notranslate nohighlight" id="equation-tb-diff">
<span class="eqno">(1)<a class="headerlink" href="#equation-tb-diff" title="Permalink to this equation">#</a></span>\[\text{SD} = R_c \cdot (T_B^{18H}-T_B^{37H}),\]</div>
<p>with regression coefficient <span class="math notranslate nohighlight">\(R_c\)</span> of 1.59 cm/K and brightness temperatures <span class="math notranslate nohighlight">\(T_B\)</span>, where the superscripts indicate the frequency and polarisation.
For the algorithm in <a class="reference internal" href="#equation-tb-diff">(1)</a> to detect dry snow, the following thresholds must be met:</p>
<div class="math notranslate nohighlight" id="equation-tb-thresholds">
<span class="eqno">(2)<a class="headerlink" href="#equation-tb-thresholds" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
\text{SD} &amp;≥ 3.0~\text{cm}\\
T_B^{37V} &amp;&lt; 255~\text{K}\\
T_B^{37H} &amp;&lt; 250~\text{K}.
\end{aligned}\end{split}\]</div>
<p>The conditions in <a class="reference internal" href="#equation-tb-diff">(1)</a> and <a class="reference internal" href="#equation-tb-thresholds">(2)</a> are applied separately to TBs from forward and backward scans.</p>
</section>
<section id="input-data">
<h5>Input data<a class="headerlink" href="#input-data" title="Permalink to this heading">#</a></h5>
<p>After resampling to Ka-band as target, both the forward and backward-looking data of the following brightness temperatures are used as input:</p>
<ul class="simple">
<li><p>Ku-band TBs (horizontal polarisation)</p></li>
<li><p>Ku-band TBs (horizontal and vertical polarisation)</p></li>
</ul>
</section>
<section id="output-data">
<h5>Output data<a class="headerlink" href="#output-data" title="Permalink to this heading">#</a></h5>
<ul class="simple">
<li><p>Binary TSA maps, one for each scan direction (forward and backward).</p></li>
</ul>
</section>
</section>
<section id="combined-reprojection">
<h4>Combined Reprojection<a class="headerlink" href="#combined-reprojection" title="Permalink to this heading">#</a></h4>
<section id="description">
<h5>Description<a class="headerlink" href="#description" title="Permalink to this heading">#</a></h5>
<p>The preceeding dry snow detection step is applied to resampled swath brightness temperatures of both scan directions.
The forward and backward TSA maps in swath format are each individually reprojected to the <a class="reference internal" href="book/intro.html#term-EASE-Grid"><span class="xref std std-term">EASE-Grid</span></a> 2.0 <a class="reference internal" href="book/intro.html#term-NH"><span class="xref std std-term">NH</span></a>, and subsequently combined into a single map.
When combining the binary TSA maps, all snow pixels are retained in order to counteract the tendency of passive microwave approaches to underestimate TSA.
In other words, snow is flagged when at least one scan direction detects snow.</p>
</section>
<section id="id7">
<h5>Input data<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h5>
<ul class="simple">
<li><p>Binary TSA maps, one for each scan direction (forward and backward).</p></li>
</ul>
</section>
<section id="id8">
<h5>Output data<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h5>
<ul class="simple">
<li><p>Gridded binary TSA maps, one for each scan direction (forward and backward).</p></li>
<li><p>Gridded combined binary TSA map</p></li>
</ul>
</section>
</section>
<section id="masking-and-flagging">
<h4>Masking and Flagging<a class="headerlink" href="#masking-and-flagging" title="Permalink to this heading">#</a></h4>
<section id="id9">
<h5>Description<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h5>
<p>Although masking and flagging are not strictly necessary to retrieve TSA, this step provides relevant complementary information.
Generally, flagging is preferred over masking with the reasoning that users can later individually tailor the daily TSA map to their needs.</p>
<p>The TSA Uncertainty Flag in its current form is based on the gridded forward (<a class="reference internal" href="book/intro.html#term-FWD"><span class="xref std std-term">FWD</span></a>) and backward (<a class="reference internal" href="book/intro.html#term-BCK"><span class="xref std std-term">BCK</span></a>) TSA maps.
Grid cells which see detected snow for both scans (FWD &amp; BCK) are flagged as ‘very likely snow covered’, whereas detected snow for one scan only (FWD | BCK) are set to ‘likely snow covered’.
If no snow is detected for both scans (FWD &amp; BCK), the flag reads ‘very likely snow free’.
The Status Flag contains information for each grid cell whether its spatial location corresponds to open water, land, or snow-covered land (valid dry snow), and indicates cells with missing data or out of grid.</p>
</section>
<section id="id10">
<h5>Input data<a class="headerlink" href="#id10" title="Permalink to this heading">#</a></h5>
<ul class="simple">
<li><p>Gridded binary TSA maps, one for each scan direction (forward and backward).</p></li>
<li><p>Gridded combined binary TSA map</p></li>
<li><p>Land and water mask</p></li>
</ul>
</section>
<section id="id11">
<h5>Output data<a class="headerlink" href="#id11" title="Permalink to this heading">#</a></h5>
<ul class="simple">
<li><p>TSA Uncertainty Flag</p></li>
<li><p>Status Flag</p></li>
</ul>
</section>
<section id="auxiliary-data">
<h5>Auxiliary data<a class="headerlink" href="#auxiliary-data" title="Permalink to this heading">#</a></h5>
<p>For future releases, auxiliary data may be included for more comprehensive masking and flagging.
Information on freshwater lakes could be considered in order to mask or flag grid cells that likely experience water spill-over effects, for instance along coastal areas or in proximity to large water bodies.
Grid cells with surface water fractions larger than about 50% could accordingly be flagged.
Besides, the qualitative TSA uncertainty estimates could further draw upon threshold error margins of <a class="reference internal" href="#equation-tb-diff">(1)</a> and <a class="reference internal" href="#equation-tb-thresholds">(2)</a>, brightness temperature uncertainties and Noise Equivalent Delta Temperatures (NE<span class="math notranslate nohighlight">\(\Delta\)</span>T) for Ku and Ka-band brightness temperatures, as well as regional and seasonal snow likelihoods.</p>
</section>
<section id="ancillary-data">
<h5>Ancillary data<a class="headerlink" href="#ancillary-data" title="Permalink to this heading">#</a></h5>
<p>The masking of regions which historically do not experience snow cover according to a snow climatology may be part of future R&amp;D activities.
Such ancillary data could further compliment TSA uncertainty estimates.</p>
</section>
<section id="validation-process">
<h5>Validation process<a class="headerlink" href="#validation-process" title="Permalink to this heading">#</a></h5>
<p>N/a</p>
</section>
</section>
</section>
</section>
<span id="document-book/algorithm_input_output_data_definition"></span><section class="tex2jax_ignore mathjax_ignore" id="algorithm-input-and-output-data-definition-iodd">
<h2>Algorithm Input and Output Data Definition (IODD)<a class="headerlink" href="#algorithm-input-and-output-data-definition-iodd" title="Permalink to this heading">#</a></h2>
<p>Except for the input L1b <a class="reference internal" href="book/intro.html#term-TB"><span class="xref std std-term">TB</span></a> data, all auxiliary and output data follow the <a class="reference internal" href="book/intro.html#term-EASE-Grid"><span class="xref std std-term">EASE-Grid</span></a> 2.0 polar projection of the Northern Hemisphere.
The current target spatial resolution for regridding is 3.125km.</p>
<section id="input-data">
<h3>Input data<a class="headerlink" href="#input-data" title="Permalink to this heading">#</a></h3>
<p>Daily Level-2 brightness temperature data are the main input, namely Ku-band data of horizontal polarisation and Ka-band data of both polarisations.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If available, night or morning acquisition times are preferred over afternoon or evening brightness temperature data, in order to minimise effects of liquid water within the snowpack due to melt.</p>
</div>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Shape/Amount</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>L1b TB Ku-band  </p></td>
<td><p>L1B Brightness Temperatures at 18.7 GHZ <br> (H polarisation)</p></td>
<td><p>Full swath or swath section <br> (Nscans,Npos)</p></td>
</tr>
<tr class="row-odd"><td><p>L1b TB Ka-band  </p></td>
<td><p>L1B Brightness Temperatures at 36.5 GHZ <br> (H and V polarisation)</p></td>
<td><p>Full swath or swath section <br> (Nscans,Npos)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="output-data">
<h3>Output data<a class="headerlink" href="#output-data" title="Permalink to this heading">#</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Shape/Amount</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TSA</p></td>
<td><p>Terrestrial Snow Area (TSA)</p></td>
<td><p>EASE-Grid 2.0 NH <br> (nx,ny)</p></td>
</tr>
<tr class="row-odd"><td><p>TSA Uncertainty</p></td>
<td><p>Qualitative uncertainty of TSA variable: <br> ‘0: very likely snow-free (FWD &amp; BCK); 1: likely snow (FWD</p></td>
<td><p>BCK); 2: very likely snow (FWD &amp; BCK)’</p></td>
</tr>
<tr class="row-even"><td><p>Status Flag  </p></td>
<td><p>Status flag for TSA</p></td>
<td><p>EASE-Grid 2.0 NH <br> (nx,ny)</p></td>
</tr>
</tbody>
</table>
<p>The main TSA variable (<code class="docutils literal notranslate"><span class="pre">tsa</span></code>) is a binary mask indicating snow-free pixels as <code class="docutils literal notranslate"><span class="pre">0</span></code>, and snow-covered pixels as <code class="docutils literal notranslate"><span class="pre">1</span></code>.
The TSA uncertainty (<code class="docutils literal notranslate"><span class="pre">tsa_uncertainty</span></code>) in turn is described through an 8-bit mask with the following allocated values:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Bit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Very likely snow free</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Likely snow covered</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Very likely snow covered</p></td>
</tr>
</tbody>
</table>
<p>The status flag (<code class="docutils literal notranslate"><span class="pre">status_flag</span></code>) similarly is an 8-bit mask with the following allocated values:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Bit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Water</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Land</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Dry snow (valid)</p></td>
</tr>
<tr class="row-odd"><td><p>3-7</p></td>
<td><p>Placeholders</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>No data, out of grid</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Empty placeholders within the status flag may be used for future R&amp;D activities, such as the development of a wet snow flag.</p>
</div>
</section>
<section id="auxiliary-data">
<h3>Auxiliary data<a class="headerlink" href="#auxiliary-data" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Land and water mask
Although the application of auxiliary data is not required to run the TSA algorithm per se, it is highly recommended to mask out known large water bodies thereby ensuring satisfactory product quality.</p></li>
</ul>
</section>
<section id="ancillary-data">
<h3>Ancillary data<a class="headerlink" href="#ancillary-data" title="Permalink to this heading">#</a></h3>
<p>N/a</p>
</section>
</section>
<span id="document-book/algorithm_performance_assessment"></span><section class="tex2jax_ignore mathjax_ignore" id="algorithm-performance-assessment">
<h2>Algorithm Performance Assessment<a class="headerlink" href="#algorithm-performance-assessment" title="Permalink to this heading">#</a></h2>
<p>The following performance assessment of the CIMR L2 TSA algorithm focuses predominantly on the radiometric scene of the Demonstration Reference Scenario.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Refer <a class="reference internal" href="book/intro.html#document-algorithm/CIMR_L2_TSA_SCEPS"><span class="doc std std-doc">here</span></a> for a demonstration of the TSA algorithm for the SCEPS Polar Scene.</p>
</div>
<section id="l1-e2es-demonstration-reference-scenario-picasso-scene-definition">
<h3>L1 E2ES Demonstration Reference Scenario (Picasso) scene definition<a class="headerlink" href="#l1-e2es-demonstration-reference-scenario-picasso-scene-definition" title="Permalink to this heading">#</a></h3>
<p>The Demonstration Reference Scenario consists of two scenes, highlighting radiometric and geometric properties, respectively.
Each scene encorporates up to 8 different surface types, including sea ice (first and multi-year ice), land (snow-free and snow-covered), and open ocean (four states of varying sea surface temperature and salinity).
Each surface condition has allocated a representative <a class="reference internal" href="book/intro.html#term-TB"><span class="xref std std-term">TB</span></a> for each <a class="reference internal" href="book/intro.html#term-CIMR"><span class="xref std std-term">CIMR</span></a> channel and polarisation, with the land TBs being provided in <a class="reference internal" href="#picasso-tb"><span class="std std-numref">Table 4</span></a>.</p>
<table class="colwidths-auto table" id="picasso-tb">
<caption><span class="caption-number">Table 4 </span><span class="caption-text">Brightness temperatures of horizontal and vertical polarization for snow-free and snow-covered land.</span><a class="headerlink" href="#picasso-tb" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="text-left head"><p> </p></th>
<th class="head"><p>Snow-covered</p></th>
<th class="head"><p>TB h-pol (K)</p></th>
<th class="head"><p>TB v-pol (K)</p></th>
<th class="text-left head"><p>Snow-free</p></th>
<th class="head"><p>TB h-pol (K)</p></th>
<th class="head"><p>TB v-pol (K)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>L  (1.4GHz)</p></td>
<td><p> </p></td>
<td><p>229</p></td>
<td><p>247</p></td>
<td class="text-left"><p></p></td>
<td><p>240</p></td>
<td><p>262</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>C  (6.9GHz)</p></td>
<td><p> </p></td>
<td><p>239</p></td>
<td><p>257</p></td>
<td class="text-left"><p></p></td>
<td><p>248</p></td>
<td><p>252</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>X  (10.9GHz)</p></td>
<td><p> </p></td>
<td><p>248</p></td>
<td><p>261</p></td>
<td class="text-left"><p></p></td>
<td><p>247</p></td>
<td><p>251</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Ku (18.7GHz)</p></td>
<td><p> </p></td>
<td><p>261</p></td>
<td><p>266</p></td>
<td class="text-left"><p></p></td>
<td><p>248</p></td>
<td><p>260</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Ka (36.5GHz)</p></td>
<td><p> </p></td>
<td><p>259</p></td>
<td><p>262</p></td>
<td class="text-left"><p></p></td>
<td><p>245</p></td>
<td><p>240</p></td>
</tr>
</tbody>
</table>
<p>In the radiometric scene, all surface types are placed adjacent to each other to artificially construct all possible boundary transitions, whilst also providing sea ice concentration sub-resolution gradients (see <a class="reference internal" href="#picasso-scene"><span class="std std-numref">Fig. 5</span></a>, left).
The geometric scene, on the other hand, features high-contrast brightness temperature patterns for ocean parameters (see <a class="reference internal" href="#picasso-scene"><span class="std std-numref">Fig. 5</span></a>, right).</p>
<figure class="align-default" id="picasso-scene">
<a class="reference internal image-reference" href="../_images/picasso-scene.png"><img alt="../_images/picasso-scene.png" src="../_images/picasso-scene.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">Demonstration Reference Scenario (Picasso) including a radiometric scene (left) and a geometric scene (right).</span><a class="headerlink" href="#picasso-scene" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="algorithm-performance-metrics-mpef">
<h3>Algorithm Performance Metrics (MPEF)<a class="headerlink" href="#algorithm-performance-metrics-mpef" title="Permalink to this heading">#</a></h3>
<p>The performance of the binary TSA algorithm is evaluated by means of a confusion matrix set-up.
For this, TSA estimates are divided into true positive (<a class="reference internal" href="book/intro.html#term-TP"><span class="xref std std-term">TP</span></a>), false positive (<a class="reference internal" href="book/intro.html#term-FP"><span class="xref std std-term">FP</span></a>), true negative (<a class="reference internal" href="book/intro.html#term-TN"><span class="xref std std-term">TN</span></a>) and false negative (<a class="reference internal" href="book/intro.html#term-FN"><span class="xref std std-term">FN</span></a>) observations.
Those observation classes are used to calculate the classification accuracy per scene:</p>
<div class="math notranslate nohighlight" id="equation-accuracy">
<span class="eqno">(3)<a class="headerlink" href="#equation-accuracy" title="Permalink to this equation">#</a></span>\[\text{accuracy} = \frac{\text{TP}+\text{TN}}{\text{TP}+\text{FP}+\text{TN}+\text{FN}}.\]</div>
<p>The evaluation addresses the main TSA product incorporating TB data from forward and backward scans.
Metrics are further computed separately for the forward and the backward scan to demonstrate the concept’s suitability.</p>
</section>
<section id="algorithm-calibration-data-set-acdat">
<h3>Algorithm Calibration Data Set (ACDAT)<a class="headerlink" href="#algorithm-calibration-data-set-acdat" title="Permalink to this heading">#</a></h3>
<p>N/a</p>
</section>
<section id="algorithm-validation-data-set-avdat">
<h3>Algorithm Validation Data Set (AVDAT)<a class="headerlink" href="#algorithm-validation-data-set-avdat" title="Permalink to this heading">#</a></h3>
<p>N/a</p>
</section>
<section id="test-results-using-demonstration-reference-scenario">
<h3>Test Results using Demonstration Reference Scenario<a class="headerlink" href="#test-results-using-demonstration-reference-scenario" title="Permalink to this heading">#</a></h3>
<p>The algorithm performance assessment for the radiometric scene as well as the algorithm demonstration for the geometric scene follow the overall procedure:</p>
<ul class="simple">
<li><p>Definition of the Coordinate Reference System (<a class="reference internal" href="book/intro.html#term-CRS"><span class="xref std std-term">CRS</span></a>)</p></li>
<li><p>Loading and visualisation of the scene’s ground truth</p></li>
<li><p>Read in TB data collocated to the Ka-band channel</p></li>
<li><p>Run the TSA algorithm incl. reprojection to the CRS</p></li>
</ul>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span> 
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">pyresample</span> <span class="k">as</span> <span class="nn">pr</span>
<span class="kn">import</span> <span class="nn">importlib</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span>
<span class="kn">from</span> <span class="nn">cartopy</span> <span class="kn">import</span> <span class="n">crs</span> <span class="k">as</span> <span class="n">ccrs</span>

<span class="c1"># local imports</span>
<span class="k">if</span> <span class="s1">&#39;/algorithm/&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;../.../&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;algorithm/&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="s1">&#39;/tools/&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;../.../&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;algorithm/tools/&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">l2_format</span> <span class="k">as</span> <span class="nn">l2</span>
<span class="kn">import</span> <span class="nn">TSA_algorithm</span> <span class="k">as</span> <span class="nn">algorithm</span>
<span class="kn">import</span> <span class="nn">l2_tools</span> <span class="k">as</span> <span class="nn">tools</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reload local imports</span>
<span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">algorithm</span><span class="p">)</span>
<span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">tools</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>For the performance assessment, the <a class="reference internal" href="book/intro.html#term-CRS"><span class="xref std std-term">CRS</span></a> corresponds to the native grid of the Demonstration Reference Scenario, namely EASE-Grid 2.0 polar projection of the Northern Hemisphere with a spatial resolution of 1km.
Outputs of the TSA algorithm are reprojected to this grid for a comparison with the test card ground truth.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l2_grid</span> <span class="o">=</span> <span class="s1">&#39;ease2-1.0km-testcard&#39;</span>
<span class="n">area_def</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">load_area</span><span class="p">(</span><span class="s1">&#39;../algorithm/ease2_adef.yaml&#39;</span><span class="p">,</span><span class="n">l2_grid</span><span class="p">)</span>

<span class="n">cart_crs</span> <span class="o">=</span> <span class="n">area_def</span><span class="o">.</span><span class="n">to_cartopy_crs</span><span class="p">()</span>
<span class="n">trg_lon</span><span class="p">,</span> <span class="n">trg_lat</span> <span class="o">=</span> <span class="n">area_def</span><span class="o">.</span><span class="n">get_lonlats</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="radiometric-demonstration-reference-scenario">
<h4>Radiometric Demonstration Reference Scenario<a class="headerlink" href="#radiometric-demonstration-reference-scenario" title="Permalink to this heading">#</a></h4>
<p>The snow cover conditions in the radiometric scene simulate an established snowpack of sufficient snow depth and snow density to cause noticeable volume scattering effects for Ka-band brightness temperatures.
Challenging conditions such as shallow or wet snow are not represented, nor are complex terrain or lake ice.
Therefore, the results should be interpreted as optimistic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load ground truth of test card</span>
<span class="n">test_card_name</span> <span class="o">=</span> <span class="s1">&#39;devalgo_radiometric&#39;</span>

<span class="n">dem_ref_scene</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;../../../..../&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;Data/Test_scenes_downscaled_projected/test_scene_1_compressed_lowres.nc&#39;</span>
<span class="n">data_rad</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">dem_ref_scene</span><span class="p">)</span>

<span class="c1"># mirror ground truth on x-axis</span>
<span class="n">landmask_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">data_rad</span><span class="p">[</span><span class="s1">&#39;landflag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">surfaces_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">data_rad</span><span class="p">[</span><span class="s1">&#39;surfaces&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">lon_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">data_rad</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">lat_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">data_rad</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span> <span class="s1">&#39;darkgoldenrod&#39;</span><span class="p">])</span>
<span class="n">vrange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">]</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">vrange</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">LambertAzimuthalEqualArea</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=+</span><span class="mf">90.0</span><span class="p">))</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lon_rad</span><span class="p">,</span> <span class="n">lat_rad</span><span class="p">,</span> <span class="n">landmask_rad</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">boundaries</span><span class="o">=</span><span class="n">vrange</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.031</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.046</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;Water&#39;</span><span class="p">,</span> <span class="s1">&#39;Land&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">cmap</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;darkgoldenrod&#39;</span><span class="p">,</span> <span class="s1">&#39;#89A0CA&#39;</span><span class="p">,</span> <span class="s1">&#39;#658AC7&#39;</span><span class="p">,</span> <span class="s1">&#39;#3869A8&#39;</span><span class="p">,</span> <span class="s1">&#39;#1F4C7B&#39;</span><span class="p">])</span>
<span class="n">vrange</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">3.5</span><span class="p">,</span><span class="mf">4.5</span><span class="p">,</span><span class="mf">5.5</span><span class="p">,</span><span class="mf">6.5</span><span class="p">,</span><span class="mf">7.5</span><span class="p">,</span><span class="mf">8.5</span><span class="p">]</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">vrange</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">LambertAzimuthalEqualArea</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=+</span><span class="mf">90.0</span><span class="p">))</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lon_rad</span><span class="p">,</span> <span class="n">lat_rad</span><span class="p">,</span> <span class="n">surfaces_rad</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<span class="c1"># ax.set_title(&#39;Test Card Surfaces&#39;)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">boundaries</span><span class="o">=</span><span class="n">vrange</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.031</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.046</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;1 : First-year sea ice&#39;</span><span class="p">,</span> <span class="s1">&#39;2 : Multi-year sea ice&#39;</span><span class="p">,</span> <span class="s1">&#39;3 : Snow-covered land&#39;</span><span class="p">,</span> <span class="s1">&#39;4 : Snow-free land&#39;</span><span class="p">,</span> <span class="s1">&#39;5 : Ocean&#39;</span><span class="p">,</span> <span class="s1">&#39;6 : Ocean&#39;</span><span class="p">,</span> <span class="s1">&#39;7 : Ocean&#39;</span><span class="p">,</span> <span class="s1">&#39;8 : Ocean&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/d1360049f704ce8fd8db604dcd8fb722eecd597154204acd83e725bb5b0c79bb.png" src="../_images/d1360049f704ce8fd8db604dcd8fb722eecd597154204acd83e725bb5b0c79bb.png" />
<img alt="../_images/83ab0be697ef99dc3b69e0d83d8c9823a770253e523177e2c835bcb30f4a7a79.png" src="../_images/83ab0be697ef99dc3b69e0d83d8c9823a770253e523177e2c835bcb30f4a7a79.png" />
</div>
</div>
<p>Testing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">test_card_name</span> <span class="o">==</span> <span class="s1">&#39;devalgo_radiometric&#39;</span><span class="p">:</span>
    <span class="n">l1x</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;../../../..../&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;Data/L1C Files/Radiometric/W_PT-DME-Lisbon-SAT-CIMR-1X@KA_C_DME_20230420T103323_LD_20280110T114800_20280110T115700_TN.nc&#39;</span>
<span class="k">elif</span> <span class="n">test_card_name</span> <span class="o">==</span> <span class="s1">&#39;devalgo_geometric&#39;</span><span class="p">:</span>
    <span class="n">l1x</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;../../../..../&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;Data/L1C Files/Geometric/W_PT-DME-Lisbon-SAT-CIMR-1X@KA_C_DME_20230417T105425_LD_20280110T114800_20280110T115700_TN.nc&#39;</span>

<span class="n">data_fwd</span><span class="p">,</span><span class="n">geoloc_fwd</span><span class="p">,</span><span class="n">data_bck</span><span class="p">,</span><span class="n">geoloc_bck</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">read_l1x</span><span class="p">(</span><span class="n">l1x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TSA algorithm</span>
<span class="n">algo</span> <span class="o">=</span> <span class="s1">&#39;Pulliainen2010&#39;</span>

<span class="n">TSA_fwd</span> <span class="o">=</span> <span class="n">algorithm</span><span class="o">.</span><span class="n">dry_snow_detection</span><span class="p">(</span><span class="n">data_fwd</span><span class="p">,</span><span class="n">tsa_algorithm</span><span class="o">=</span><span class="n">algo</span><span class="p">)</span>
<span class="n">TSA_bck</span> <span class="o">=</span> <span class="n">algorithm</span><span class="o">.</span><span class="n">dry_snow_detection</span><span class="p">(</span><span class="n">data_bck</span><span class="p">,</span><span class="n">tsa_algorithm</span><span class="o">=</span><span class="n">algo</span><span class="p">)</span>

<span class="n">TSA_fwd_rad</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">reproject_to_grid</span><span class="p">(</span><span class="n">TSA_fwd</span><span class="p">,</span><span class="n">geoloc_fwd</span><span class="p">,</span><span class="n">area_def</span><span class="o">=</span><span class="n">area_def</span><span class="p">,</span><span class="n">radius_of_influence</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">TSA_bck_rad</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">reproject_to_grid</span><span class="p">(</span><span class="n">TSA_bck</span><span class="p">,</span><span class="n">geoloc_bck</span><span class="p">,</span><span class="n">area_def</span><span class="o">=</span><span class="n">area_def</span><span class="p">,</span><span class="n">radius_of_influence</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>

<span class="n">TSA_rad</span><span class="p">,</span> <span class="n">TSA_uncert_rad</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">combine_proj</span><span class="p">(</span><span class="n">TSA_fwd_rad</span><span class="p">,</span><span class="n">TSA_bck_rad</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TSA_plot_rad</span> <span class="o">=</span> <span class="n">TSA_uncert_rad</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">TSA_plot_rad</span><span class="p">[</span><span class="n">landmask_rad</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>                              <span class="c1"># water</span>
<span class="n">TSA_plot_rad</span><span class="p">[</span><span class="n">TSA_plot_rad</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span> 
<span class="n">TSA_plot_rad</span><span class="p">[</span><span class="n">TSA_plot_rad</span> <span class="o">==</span> <span class="mf">1.5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">cmap</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">])</span>
<span class="n">vrange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">3.5</span><span class="p">]</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">vrange</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">LambertAzimuthalEqualArea</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=+</span><span class="mf">90.0</span><span class="p">))</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">trg_lon</span><span class="p">,</span> <span class="n">trg_lat</span><span class="p">,</span> <span class="n">TSA_plot_rad</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<span class="c1"># ax.set_title(&#39;Radiometric Test Card Evaluation&#39;)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">boundaries</span><span class="o">=</span><span class="n">vrange</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.031</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.046</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;Water&#39;</span><span class="p">,</span> <span class="s1">&#39;Snow-free land</span><span class="se">\n</span><span class="s1">(high certainty: FWD&amp;BCK)&#39;</span><span class="p">,</span> <span class="s1">&#39;Snow cover</span><span class="se">\n</span><span class="s1">(medium certainty: FWD|BCK)&#39;</span><span class="p">,</span> <span class="s1">&#39;Snow cover</span><span class="se">\n</span><span class="s1">(high certainty: FWD&amp;BCK)&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="c1"># plt.gcf().set_size_inches((20,20))</span>

<span class="c1"># plt.savefig(&#39;tsa_uncert.png&#39;, format=&#39;png&#39;, dpi=1200, bbox_inches=&#39;tight&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/cd1238cc318ad249873f60deabd5ecf07aae647e896924e885fefc83f99dc146.png" src="../_images/cd1238cc318ad249873f60deabd5ecf07aae647e896924e885fefc83f99dc146.png" />
</div>
</div>
</section>
<section id="geometric-demonstration-reference-scenario">
<h4>Geometric Demonstration Reference Scenario<a class="headerlink" href="#geometric-demonstration-reference-scenario" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load ground truth of test card</span>
<span class="n">test_card_name</span> <span class="o">=</span> <span class="s1">&#39;devalgo_geometric&#39;</span>

<span class="n">dem_ref_scene</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;../../../..../&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;Data/Test_scenes_downscaled_projected/test_scene_2_compressed_lowres.nc&#39;</span>
<span class="n">data_geo</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">dem_ref_scene</span><span class="p">)</span>

<span class="c1"># mirror ground truth on x-axis</span>
<span class="c1"># landmask_geo = np.flip(data_ref[&#39;landflag&#39;].values,0)</span>
<span class="n">surfaces_geo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">data_geo</span><span class="p">[</span><span class="s1">&#39;surfaces&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">lon_geo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">data_geo</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">lat_geo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">data_geo</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;#89A0CA&#39;</span><span class="p">])</span>
<span class="n">vrange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">5.5</span><span class="p">]</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">vrange</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">LambertAzimuthalEqualArea</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=+</span><span class="mf">90.0</span><span class="p">))</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lon_geo</span><span class="p">,</span> <span class="n">lat_geo</span><span class="p">,</span> <span class="n">surfaces_geo</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">boundaries</span><span class="o">=</span><span class="n">vrange</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.031</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.046</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;1 : Sea ice&#39;</span><span class="p">,</span> <span class="s1">&#39;5: Ocean&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/505bd09ccbc523f2612a26e364a5223abdd28ca3c1f7d06aaef0e152fc716e60.png" src="../_images/505bd09ccbc523f2612a26e364a5223abdd28ca3c1f7d06aaef0e152fc716e60.png" />
</div>
</div>
<p>Testing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">test_card_name</span> <span class="o">==</span> <span class="s1">&#39;devalgo_radiometric&#39;</span><span class="p">:</span>
    <span class="n">l1x</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;../../../..../&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;Data/L1C Files/Radiometric/W_PT-DME-Lisbon-SAT-CIMR-1X@KA_C_DME_20230420T103323_LD_20280110T114800_20280110T115700_TN.nc&#39;</span>
<span class="k">elif</span> <span class="n">test_card_name</span> <span class="o">==</span> <span class="s1">&#39;devalgo_geometric&#39;</span><span class="p">:</span>
    <span class="n">l1x</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;../../../..../&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;Data/L1C Files/Geometric/W_PT-DME-Lisbon-SAT-CIMR-1X@KA_C_DME_20230417T105425_LD_20280110T114800_20280110T115700_TN.nc&#39;</span>

<span class="n">data_fwd</span><span class="p">,</span><span class="n">geoloc_fwd</span><span class="p">,</span><span class="n">data_bck</span><span class="p">,</span><span class="n">geoloc_bck</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">read_l1x</span><span class="p">(</span><span class="n">l1x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TSA algorithm</span>
<span class="n">algo</span> <span class="o">=</span> <span class="s1">&#39;Pulliainen2010&#39;</span>

<span class="n">TSA_fwd</span> <span class="o">=</span> <span class="n">algorithm</span><span class="o">.</span><span class="n">dry_snow_detection</span><span class="p">(</span><span class="n">data_fwd</span><span class="p">,</span><span class="n">tsa_algorithm</span><span class="o">=</span><span class="n">algo</span><span class="p">)</span>
<span class="n">TSA_bck</span> <span class="o">=</span> <span class="n">algorithm</span><span class="o">.</span><span class="n">dry_snow_detection</span><span class="p">(</span><span class="n">data_bck</span><span class="p">,</span><span class="n">tsa_algorithm</span><span class="o">=</span><span class="n">algo</span><span class="p">)</span>

<span class="n">TSA_fwd_geo</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">reproject_to_grid</span><span class="p">(</span><span class="n">TSA_fwd</span><span class="p">,</span><span class="n">geoloc_fwd</span><span class="p">,</span><span class="n">area_def</span><span class="o">=</span><span class="n">area_def</span><span class="p">,</span><span class="n">radius_of_influence</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">TSA_bck_geo</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">reproject_to_grid</span><span class="p">(</span><span class="n">TSA_bck</span><span class="p">,</span><span class="n">geoloc_bck</span><span class="p">,</span><span class="n">area_def</span><span class="o">=</span><span class="n">area_def</span><span class="p">,</span><span class="n">radius_of_influence</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>

<span class="n">TSA_geo</span><span class="p">,</span> <span class="n">TSA_uncert_geo</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">combine_proj</span><span class="p">(</span><span class="n">TSA_fwd_geo</span><span class="p">,</span><span class="n">TSA_bck_geo</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TSA_plot_geo</span> <span class="o">=</span> <span class="n">TSA_uncert_geo</span> <span class="o">+</span> <span class="mi">1</span>
<span class="c1"># TSA_plot_geo[landmask_geo == 0] = 0                              # no water mask for geometric scene</span>
<span class="n">TSA_plot_geo</span><span class="p">[</span><span class="n">TSA_plot_geo</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span> 
<span class="n">TSA_plot_geo</span><span class="p">[</span><span class="n">TSA_plot_geo</span> <span class="o">==</span> <span class="mf">1.5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">cmap</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">])</span>
<span class="n">vrange</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">3.5</span><span class="p">]</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">vrange</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">LambertAzimuthalEqualArea</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=+</span><span class="mf">90.0</span><span class="p">))</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">trg_lon</span><span class="p">,</span> <span class="n">trg_lat</span><span class="p">,</span> <span class="n">TSA_plot_geo</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<span class="c1"># ax.set_title(&#39;Geometric Test Card Evaluation&#39;)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">boundaries</span><span class="o">=</span><span class="n">vrange</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.031</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.046</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;Snow-free</span><span class="se">\n</span><span class="s1">(high certainty: FWD&amp;BCK)&#39;</span><span class="p">,</span> <span class="s1">&#39;Snow</span><span class="se">\n</span><span class="s1">(medium certainty: FWD|BCK)&#39;</span><span class="p">,</span> <span class="s1">&#39;Snow</span><span class="se">\n</span><span class="s1">(high certainty: FWD&amp;BCK)&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="c1"># plt.gcf().set_size_inches((20,20))</span>

<span class="c1"># plt.savefig(&#39;tsa_uncert2.png&#39;, format=&#39;png&#39;, dpi=1200, bbox_inches=&#39;tight&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/5a2fe3c1c8cbff6ae11f7b70bae3ca977f0cc76f2a4f0faa99ba0fa0a553314d.png" src="../_images/5a2fe3c1c8cbff6ae11f7b70bae3ca977f0cc76f2a4f0faa99ba0fa0a553314d.png" />
</div>
</div>
</section>
</section>
<section id="algorithm-performance-assessment-using-demonstration-reference-scenario">
<h3>Algorithm Performance Assessment using Demonstration Reference Scenario<a class="headerlink" href="#algorithm-performance-assessment-using-demonstration-reference-scenario" title="Permalink to this heading">#</a></h3>
<p>The core of the performance assessment is conducted using the radiometric test card, as it covers snow-free as well as snow-covered land surfaces.
The performance metrics are computed for the standard TSA algorithm combining forward and backward scan data, as well as for individual scans.
Note that the choice of reprojection parameters introduces an uncertainty in the evaluation metrics of about <span class="math notranslate nohighlight">\(\pm\)</span>3%.</p>
<p>Forward and backward scan:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TSA_rad_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">TSA_rad</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">TSA_rad_diff</span><span class="p">[</span><span class="n">TSA_rad_diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="n">TSA_rad_diff</span><span class="p">[(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TSA_rad</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># FN</span>
<span class="n">TSA_rad_diff</span><span class="p">[(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TSA_rad</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># TP</span>
<span class="n">TSA_rad_diff</span><span class="p">[(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TSA_rad</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># TN</span>
<span class="n">TSA_rad_diff</span><span class="p">[(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TSA_rad</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">2</span>   <span class="c1"># FP</span>
<span class="n">TSA_rad_diff</span><span class="p">[</span><span class="n">landmask_rad</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>                               <span class="c1"># water</span>
<span class="n">TSA_rad_diff</span><span class="p">[(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>       <span class="c1"># sea ice</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># count evaluated pixels</span>
<span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">TSA_rad_diff</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># print(dict(zip(unique,counts)))</span>
<span class="n">fn</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>              <span class="c1"># -1: FN</span>
<span class="n">tp</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>              <span class="c1">#  0: TP</span>
<span class="n">tn</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>              <span class="c1">#  1: TN</span>
<span class="n">fp</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>              <span class="c1">#  2: FP</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>  <span class="c1"># ignore water and sea ice for total count</span>

<span class="n">acc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tp</span><span class="o">+</span><span class="n">tn</span><span class="p">)</span><span class="o">/</span><span class="n">total</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy:&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%.5f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">acc</span><span class="p">)</span>
<span class="n">tpr</span> <span class="o">=</span> <span class="n">tp</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tp</span><span class="o">+</span><span class="n">fn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TP rate: &#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%.5f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">tpr</span><span class="p">)</span>
<span class="n">tnr</span> <span class="o">=</span> <span class="n">tn</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TN rate: &#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%.5f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">tnr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.95989
TP rate:  0.95590
TN rate:  0.96387
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confusion Matrix
TP =  134897  |  FP =  5099
FN =  6223    |  TN =  136021
</pre></div>
</div>
</div>
</div>
<p>The tendency to underestimate snow presence is reflected by the true negative rate which is higher than the true positive rate.
For the given test card grid, the TSA algorithm detects a snow cover extent of 134,897km<sup>2</sup> out of the ground truth of 141,120km<sup>2</sup>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;darkgoldenrod&#39;</span><span class="p">,</span> <span class="s1">&#39;darkred&#39;</span><span class="p">])</span>
<span class="n">vrange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">]</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">vrange</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">LambertAzimuthalEqualArea</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=+</span><span class="mf">90.0</span><span class="p">))</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">trg_lon</span><span class="p">,</span> <span class="n">trg_lat</span><span class="p">,</span> <span class="n">TSA_rad_diff</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<span class="c1"># ax.set_title(&#39;Test Card Evaluation&#39;)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">boundaries</span><span class="o">=</span><span class="n">vrange</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.031</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.046</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;Sea ice&#39;</span><span class="p">,</span> <span class="s1">&#39;Water&#39;</span><span class="p">,</span> <span class="s1">&#39;False Negative (Underestimation)&#39;</span><span class="p">,</span> <span class="s1">&#39;True Positive (Snow)&#39;</span><span class="p">,</span> <span class="s1">&#39;True Negative (Snow-free land)&#39;</span><span class="p">,</span> <span class="s1">&#39;False Positive (Overestimation)&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/456cc8d2712e4df4d6908adde1d5e2e9ff97422b8c8db0c4c35055a844882836.png" src="../_images/456cc8d2712e4df4d6908adde1d5e2e9ff97422b8c8db0c4c35055a844882836.png" />
</div>
</div>
<p>For the forward scan, the following metrics are obtained:</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TSA_fwd_rad_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">TSA_fwd_rad</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">TSA_fwd_rad_diff</span><span class="p">[</span><span class="n">TSA_fwd_rad_diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="n">TSA_fwd_rad_diff</span><span class="p">[(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TSA_fwd_rad</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># FN</span>
<span class="n">TSA_fwd_rad_diff</span><span class="p">[(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TSA_fwd_rad</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># TP</span>
<span class="n">TSA_fwd_rad_diff</span><span class="p">[(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TSA_fwd_rad</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># TN</span>
<span class="n">TSA_fwd_rad_diff</span><span class="p">[(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TSA_fwd_rad</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">2</span>   <span class="c1"># FP</span>
<span class="n">TSA_fwd_rad_diff</span><span class="p">[</span><span class="n">landmask_rad</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>                               <span class="c1"># water</span>
<span class="n">TSA_fwd_rad_diff</span><span class="p">[(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>       <span class="c1"># sea ice</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># count evaluated pixels</span>
<span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">TSA_fwd_rad_diff</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># print(dict(zip(unique,counts)))</span>
<span class="n">fn</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>              <span class="c1"># -1: FN</span>
<span class="n">tp</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>              <span class="c1">#  0: TP</span>
<span class="n">tn</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>              <span class="c1">#  1: TN</span>
<span class="n">fp</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>              <span class="c1">#  2: FP</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>  <span class="c1"># ignore water and sea ice for total count</span>

<span class="n">acc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tp</span><span class="o">+</span><span class="n">tn</span><span class="p">)</span><span class="o">/</span><span class="n">total</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy:&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%.5f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">acc</span><span class="p">)</span>
<span class="n">tpr</span> <span class="o">=</span> <span class="n">tp</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tp</span><span class="o">+</span><span class="n">fn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TP rate: &#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%.5f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">tpr</span><span class="p">)</span>
<span class="n">tnr</span> <span class="o">=</span> <span class="n">tn</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TN rate: &#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%.5f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">tnr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.95212
TP rate:  0.92301
TN rate:  0.98124
</pre></div>
</div>
</div>
</div>
<p>For the backward scan, the following metrics are obtained:</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TSA_bck_rad_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">TSA_bck_rad</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">TSA_bck_rad_diff</span><span class="p">[</span><span class="n">TSA_bck_rad_diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="n">TSA_bck_rad_diff</span><span class="p">[(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TSA_bck_rad</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># FN</span>
<span class="n">TSA_bck_rad_diff</span><span class="p">[(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TSA_bck_rad</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># TP</span>
<span class="n">TSA_bck_rad_diff</span><span class="p">[(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TSA_bck_rad</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># TN</span>
<span class="n">TSA_bck_rad_diff</span><span class="p">[(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">TSA_bck_rad</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">2</span>   <span class="c1"># FP</span>
<span class="n">TSA_bck_rad_diff</span><span class="p">[</span><span class="n">landmask_rad</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>                               <span class="c1"># water</span>
<span class="n">TSA_bck_rad_diff</span><span class="p">[(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">surfaces_rad</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>       <span class="c1"># sea ice</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># count evaluated pixels</span>
<span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">TSA_bck_rad_diff</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># print(dict(zip(unique,counts)))</span>
<span class="n">fn</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>              <span class="c1"># -1: FN</span>
<span class="n">tp</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>              <span class="c1">#  0: TP</span>
<span class="n">tn</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>              <span class="c1">#  1: TN</span>
<span class="n">fp</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>              <span class="c1">#  2: FP</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>  <span class="c1"># ignore water and sea ice for total count</span>

<span class="n">acc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tp</span><span class="o">+</span><span class="n">tn</span><span class="p">)</span><span class="o">/</span><span class="n">total</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy:&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%.5f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">acc</span><span class="p">)</span>
<span class="n">tpr</span> <span class="o">=</span> <span class="n">tp</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tp</span><span class="o">+</span><span class="n">fn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TP rate: &#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%.5f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">tpr</span><span class="p">)</span>
<span class="n">tnr</span> <span class="o">=</span> <span class="n">tn</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tn</span><span class="o">+</span><span class="n">fp</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TN rate: &#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%.5f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">tnr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.94831
TP rate:  0.91927
TN rate:  0.97735
</pre></div>
</div>
</div>
</div>
<p>Both the accuracy and the TP rate are higher for the TSA product when using combined rather than individual scans.
Passive microwave snow detection approaches commonly underestimate snow cover area, which can be counteracted when incorporating both scan directions.</p>
</section>
<section id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h3>
<p>An initial performance assessment of the CIMR L2 TSA algorithm is conducted using primarily the radiometric scene of the Demonstration Reference Scenario (Picasso).
The radiometric scene contains two land surface types: snow-free and snow-covered ground.
Note that distinct bare ground as well as established snowpacks are represented, while more challenging conditions such as shallow or wet snow, complex terrain, dense vegetation, and lake ice are not considered.
Due to this idealistic nature of the artificial scene, high algorithm performance is to be expected.
Indeed, the TSA algorithm achieves an accuracy of 95.99% together with a true positive rate of 95.59% and a true negative rate of 96.39%.</p>
<p>The metrics, however, still reflect the common tendency of passive microwave snow detection methodologies to underestimate snow cover area, as the true negative rate is larger than the true positive rate.
False negative pixels, i.e. pixels affected by underestimation are predominantly found in proximity to land-water boundaries.
Although more dependent on different sea and sea ice conditions, false positive pixels representing overestimation similarly form elongated clusters along ‘coastlines’.
Even this simple test scene therefore emphasises the need for water spill-over corrections.</p>
<p>Despite their simplicity, both scenes of the Demonstration Reference Scenario provide insights into the utility of CIMR’s scanning geometry.
In case of the radiometric scene, combining snow area estimates from both forward and backward-looking brightness temperatures proves beneficial.
The overall algorithm performance is better when compared to snow area estimates from only one look direction.
This supports the current approach of combining snow area estimates after separate processing of forward and backward scans.
In case of the geometric scene, land surface types are not included.
Nevertheless, the high-contrast brightness temperature patterns happen to provide a visualisation of the implemented TSA uncertainty flag, highlighting its behaviour and utility along sharp borders and transitions.
Both aspects encourage the partition of CIMR brightness temperatures depending on look direction.</p>
<p>In contrast to the Demonstration Reference Scenario, more realistic conditions are found in the SCEPS Polar Scene.
Yet when applying the TSA algorithm to said polar scene, barely any snow cover is detected over land.
The primary condition for snow cover to be detected relies on a depression in Ka-band brightness temperature of horizontal polarisation, due to volume scattering effects of snowpacks.
This is simply not met for the vast majority of the land area.
It is understood that sample emissivities might have been used for the simulation of land parts contained within the scene.
Those emissivities likely reflect glacial conditions, which would not result in volume scattering effects due to the continuous transition between snow, firn, and glacial ice.
Similarly, Ku-band brightness temperatures serve as scatter-free reference which relies on a clear interface between the snowpack and the subnivean substrate.
Terrestrial snow detection approaches are hence not applicable over glaciers and ice caps.</p>
<p>Overall, the performance of the TSA algorithm is successfully demonstrated for the different test scenarios.
Even though synthetic data naturally cannot fully replace real data, the assessment provides a first proof of concept for the algorithm’s handling of forward and backward brightness temperatures in order to estimate snow area and its qualitative uncertainty.</p>
</section>
</section>
<span id="document-book/roadmap"></span><section class="tex2jax_ignore mathjax_ignore" id="roadmap-for-future-atbd-development">
<h2>Roadmap for Future ATBD Development<a class="headerlink" href="#roadmap-for-future-atbd-development" title="Permalink to this heading">#</a></h2>
<p>Passive microwave snow detection algorithms are known to underestimate global snow cover area <span id="id1">[<a class="reference internal" href="book/intro.html#id2" title="D. Hall, R. Kelly, G. Riggs, A. Chang, and J. Foster. Assessment of the relative accuracy of hemispheric-scale snow-cover maps. Ann. Glaciol., 34:24-30, 2002. doi:10.3189/172756402781817770.">Hall <em>et al.</em>, 2002</a>, <a class="reference internal" href="book/intro.html#id18" title="L. Zschenderlein, K. Luojus, M. Takala, P. Venäläinen, and J. Pulliainen. Evaluation of passive microwave dry snow detection algorithms and application to SWE retrieval during seasonal snow accumulation. Remote Sensing of Environment, 288:113476, 2023. doi:10.1016/j.rse.2023.113476.">Zschenderlein <em>et al.</em>, 2023</a>]</span>.
They are sensitive to dry snowpacks with minimal water content, and hence struggle to capture wet snow areas due to fundamentally different radiometric properties <span id="id2">[<a class="reference internal" href="book/intro.html#id13" title="C. Mätzler. Passive microwave signatures of landscapes in winter. Meteorology and Atmospheric Physics, 54:241-260, 1994. doi:10.1007/BF01030063.">Mätzler, 1994</a>]</span>.
To expand the capabilities of the Level-2 <a class="reference internal" href="book/intro.html#term-TSA"><span class="xref std std-term">TSA</span></a> product to reliably map also wet snow, the operational implementation of a wet snow detection module should be investigated.
For this purpose, feasible approaches might incorporate diurnal amplitude variations (e.g. <span id="id3">Semmens <em>et al.</em> [<a class="reference internal" href="book/intro.html#id10" title="Kathryn Semmens, Joan Ramage, Jeremy Apgar, Katrina Bennett, Glen Liston, and Elias Deeb. Passive Microwave Remote Sensing of Snowmelt and Melt‐Refreeze Using Diurnal Amplitude Variations. In Geophysical Monograph Series, pages 215–226. Wiley, 1 edition, 2014. doi:10.1002/9781118872086.ch13.">2014</a>]</span>), L-band brightness temperatures of horizontal polarization <span id="id4">[<a class="reference internal" href="book/intro.html#id26" title="T. Pellarin, A. Mialon, R. Biron, C. Coulaud, F. Gibon, Y. Kerr, M. Lafaysse, B. Mercier, S. Morin, I. Redor, M. Schwank, and I. Völksch. Three years of L-band brightness temperature measurements in a mountainous area: Topography, vegetation and snowmelt issues. Remote Sensing of Environment, 180:85–98, 2016. doi:10.1016/j.rse.2016.02.047.">Pellarin <em>et al.</em>, 2016</a>, <a class="reference internal" href="book/intro.html#id25" title="K. Rautiainen, J. Lemmetyinen, J. Pulliainen, J. Vehviläinen, M. Drusch, A. Kontu, J. Kainulainen, and J. Seppänen. L-Band Radiometer Observations of Soil Processes in Boreal and Subarctic Environments. IEEE Transactions on Geoscience and Remote Sensing, 50(5):1483–1497, 2012. doi:10.1109/TGRS.2011.2167755.">Rautiainen <em>et al.</em>, 2012</a>]</span>, or numerical weather prediction (<a class="reference internal" href="book/intro.html#term-NWP"><span class="xref std std-term">NWP</span></a>) temperature data <span id="id5">[<a class="reference internal" href="book/intro.html#id24" title="S. Tuttle and J. Jacobs. Enhanced Identification of Snow Melt and Refreeze Events From Passive Microwave Brightness Temperature Using Air Temperature. Water Resources Research, 55(4):3248–3265, 2019. doi:10.1029/2018WR023995.">Tuttle and Jacobs, 2019</a>]</span>.</p>
<p>Besides, the concept of the status flag as an indicator of uncertainty may be expanded and refined in the future.
For binary classifications as implemented within the TSA product, we lack a comprehensive quantitative and/or qualitative uncertainty characterization.
Further traceable uncertainty sources have to be identified in addition to the current components derived from <a class="reference internal" href="book/intro.html#term-TB"><span class="xref std std-term">TB</span></a> data of different looking directions, including for instance the impact of brightness temperature measurement uncertainties on the snow detection results.
Moreover, land surface or air temperature data could enable same-day identification of meteorological conditions that make snow presence (un)likely, thereby supporting near real-time (<a class="reference internal" href="book/intro.html#term-NRT"><span class="xref std std-term">NRT</span></a>) quality assurance.
Such temperature data would also allow for retrospective quality assessment of the TSA maps: Using temperature data of the whole snow season, an end-of-season quality flag could be generated which affirms or rules out snow cover based on the weather conditions across consecutive days.
Furthermore, the use of a snow climatology could be considered to restrict snow detection to geolocations that have historically experienced snow cover, e.g. <span id="id6">Dewey and Heim [<a class="reference internal" href="book/intro.html#id20" title="K. Dewey and R. Heim. A Digital Archive of Northern Hemisphere Snow Cover, November 1966 through December 1980. Bulletin of the American Meteorological Society, 63(10):1132–1141, 1982. doi:10.1175/1520-0477(1982)063&lt;1132:ADAONH&gt;2.0.CO;2.">1982</a>]</span> in <span id="id7">Kelly [<a class="reference internal" href="book/intro.html#id12" title="R. Kelly. The AMSR-E Snow Depth Algorithm: Description and Initial Results. Journal of the Remote Sensing Society of Japan, 29:307-17, 01 2009. doi:10.11440/rssj.29.307.">2009</a>]</span>.
This would not only improve the TSA algorithm accuracy but would also provide likelihoods for snow presence in the spatial and temporal domain, which could again feed into the NRT quality flag.</p>
<p>As the performance assessment highlighted, brightness temperature correction for water contamination per footprint or per grid cell is desirable.
In the unfortunate case that such a correction is not provided for CIMR L1b/L1c data products, the TSA algorithm would benefit from open water filtering, masking or correction in order to improve snow mapping accuracy in proximity to coastlines and (unmasked) freshwater lakes.
Other product extensions could address the screening for precipitation and the detection of thin snow cover.
Both the additional scattering due to hydrometeors and the lesser scattering of thin snowpacks are known challenges to passive microwave dry snow detection <span id="id8">[<a class="reference internal" href="book/intro.html#id13" title="C. Mätzler. Passive microwave signatures of landscapes in winter. Meteorology and Atmospheric Physics, 54:241-260, 1994. doi:10.1007/BF01030063.">Mätzler, 1994</a>]</span>;
They have been previously addressed by means of brightness temperatures at 22 GHz and 85 GHz, which are sensitive to the respective scattering behaviours <span id="id9">[<a class="reference internal" href="book/intro.html#id21" title="J. Foster, D. Hall, J. Eylander, G. Riggs, S. Nghiem, M. Tedesco, E. Kim, P. Montesano, R. Kelly, K. Casey, and B. Choudhury. A blended global snow product using visible, passive microwave and scatterometer satellite data. International Journal of Remote Sensing, 32(5):1371–1395, 2011. doi:10.1080/01431160903548013.">Foster <em>et al.</em>, 2011</a>, <a class="reference internal" href="book/intro.html#id9" title="N. Grody and A. Basist. Global identification of snowcover using SSM/I measurements. IEEE Transactions on Geoscience and Remote Sensing, 34(1):237-249, 1996. doi:10.1109/36.481908.">Grody and Basist, 1996</a>]</span>.
Since those channels are not available for CIMR, the TSA product could draw upon external satellite TBs although this would fall beyond the Level-2 status.</p>
<p>While the CIMR Level-2 TSA product is a stand-alone data product within the CIMR product suite, the development and implementation of the CIMR Level-2 Global Snow Water Equivalent (<a class="reference internal" href="book/intro.html#term-SWE"><span class="xref std std-term">SWE</span></a>) product will be closely linked – directly incorporating the TSA output in its processing chain (compare e.g. <span id="id10">[<a class="reference internal" href="book/intro.html#id22" title="K. Luojus, J. Pulliainen, M. Takala, J. Lemmetyinen, C. Mortimer, C. Derksen, L. Mudryk, M. Moisander, M. Hiltunen, T. Smolander, J. Ikonen, J. Cohen, M. Salminen, J. Norberg, K. Veijola, and P. Venäläinen. GlobSnow v3.0 Northern Hemisphere snow water equivalent dataset. Scientific Data, 8(163):163, 2021. doi:10.1038/s41597-021-00939-2.">Luojus <em>et al.</em>, 2021</a>]</span>).
Although the SWE retrieval itself will require noticeable development efforts, future improvement and development of the TSA algorithm and <a class="reference internal" href="book/intro.html#term-ATBD"><span class="xref std std-term">ATBD</span></a> remain of high interest.</p>
</section>
<span id="document-book/references"></span><section class="tex2jax_ignore mathjax_ignore" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<div class="docutils container" id="id1">
<dl class="citation">
<dt class="label" id="id11"><span class="brackets">1</span></dt>
<dd><p>R. Armstrong and M. Brodzik. Recent Northern Hemisphere snow extent: a comparison of data derived from visible and microwave satellite sensors. <em>Geophysical Research Letters</em>, 28(19):3673–3676, 2001. <a class="reference external" href="https://doi.org/10.1029/2000GL012556">doi:10.1029/2000GL012556</a>.</p>
</dd>
<dt class="label" id="id17"><span class="brackets">2</span></dt>
<dd><p>M. Brodzik, B. Billingsley, T. Haran, B. Raup, and M. Savoie. EASE-Grid 2.0: Incremental but Significant Improvements for Earth-Gridded Data Sets. <em>ISPRS International Journal of Geo-Information</em>, 1(1):32–45, 2012. <a class="reference external" href="https://doi.org/10.3390/ijgi1010032">doi:10.3390/ijgi1010032</a>.</p>
</dd>
<dt class="label" id="id7"><span class="brackets">3</span></dt>
<dd><p>A. Chang, J. Foster, and D. Hall. Nimbus-7 SMMR derived global snow cover parameters. <em>Ann. Glaciol.</em>, 9:39–44, 1987. <a class="reference external" href="https://doi.org/10.3189/S0260305500200736">doi:10.3189/S0260305500200736</a>.</p>
</dd>
<dt class="label" id="id23"><span class="brackets">4</span></dt>
<dd><p>A. Chang, J. Foster, D. Hall, A. Rango, and B. Hartline. Snow water equivalent estimation by microwave radiometry. <em>Cold Regions Science and Technology</em>, 5(3):259–267, 1982. <a class="reference external" href="https://doi.org/10.1016/0165-232X(82)90019-2">doi:10.1016/0165-232X(82)90019-2</a>.</p>
</dd>
<dt class="label" id="id20"><span class="brackets">5</span></dt>
<dd><p>K. Dewey and R. Heim. A Digital Archive of Northern Hemisphere Snow Cover, November 1966 through December 1980. <em>Bulletin of the American Meteorological Society</em>, 63(10):1132–1141, 1982. <a class="reference external" href="https://doi.org/10.1175/1520-0477(1982)063&lt;1132:ADAONH&gt;2.0.CO;2">doi:10.1175/1520-0477(1982)063&lt;1132:ADAONH&gt;2.0.CO;2</a>.</p>
</dd>
<dt class="label" id="id8"><span class="brackets">6</span></dt>
<dd><p>J. Foster, A. Chang, and D. Hall. Comparison of snow mass estimates from a prototype passive microwave snow algorithm, a revised algorithm and a snow depth climatology. <em>Remote Sensing of Environment</em>, 62(2):132–142, 1997. <a class="reference external" href="https://doi.org/10.1016/S0034-4257(97)00085-0">doi:10.1016/S0034-4257(97)00085-0</a>.</p>
</dd>
<dt class="label" id="id21"><span class="brackets">7</span></dt>
<dd><p>J. Foster, D. Hall, J. Eylander, G. Riggs, S. Nghiem, M. Tedesco, E. Kim, P. Montesano, R. Kelly, K. Casey, and B. Choudhury. A blended global snow product using visible, passive microwave and scatterometer satellite data. <em>International Journal of Remote Sensing</em>, 32(5):1371–1395, 2011. <a class="reference external" href="https://doi.org/10.1080/01431160903548013">doi:10.1080/01431160903548013</a>.</p>
</dd>
<dt class="label" id="id9"><span class="brackets">8</span></dt>
<dd><p>N. Grody and A. Basist. Global identification of snowcover using SSM/I measurements. <em>IEEE Transactions on Geoscience and Remote Sensing</em>, 34(1):237–249, 1996. <a class="reference external" href="https://doi.org/10.1109/36.481908">doi:10.1109/36.481908</a>.</p>
</dd>
<dt class="label" id="id2"><span class="brackets">9</span></dt>
<dd><p>D. Hall, R. Kelly, G. Riggs, A. Chang, and J. Foster. Assessment of the relative accuracy of hemispheric-scale snow-cover maps. <em>Ann. Glaciol.</em>, 34:24–30, 2002. <a class="reference external" href="https://doi.org/10.3189/172756402781817770">doi:10.3189/172756402781817770</a>.</p>
</dd>
<dt class="label" id="id12"><span class="brackets">10</span></dt>
<dd><p>R. Kelly. The AMSR-E Snow Depth Algorithm: Description and Initial Results. <em>Journal of the Remote Sensing Society of Japan</em>, 29:307–17, 01 2009. <a class="reference external" href="https://doi.org/10.11440/rssj.29.307">doi:10.11440/rssj.29.307</a>.</p>
</dd>
<dt class="label" id="id16"><span class="brackets">11</span></dt>
<dd><p>R. Kelly, A. Chang, L. Tsang, and J. Foster. A prototype AMSR-E global snow area and snow depth algorithm. <em>IEEE Transactions on Geoscience and Remote Sensing</em>, 41(2):230–242, 2003. <a class="reference external" href="https://doi.org/10.1109/TGRS.2003.809118">doi:10.1109/TGRS.2003.809118</a>.</p>
</dd>
<dt class="label" id="id22"><span class="brackets">12</span></dt>
<dd><p>K. Luojus, J. Pulliainen, M. Takala, J. Lemmetyinen, C. Mortimer, C. Derksen, L. Mudryk, M. Moisander, M. Hiltunen, T. Smolander, J. Ikonen, J. Cohen, M. Salminen, J. Norberg, K. Veijola, and P. Venäläinen. GlobSnow v3.0 Northern Hemisphere snow water equivalent dataset. <em>Scientific Data</em>, 8(163):163, 2021. <a class="reference external" href="https://doi.org/10.1038/s41597-021-00939-2">doi:10.1038/s41597-021-00939-2</a>.</p>
</dd>
<dt class="label" id="id13"><span class="brackets">13</span></dt>
<dd><p>C. Mätzler. Passive microwave signatures of landscapes in winter. <em>Meteorology and Atmospheric Physics</em>, 54:241–260, 1994. <a class="reference external" href="https://doi.org/10.1007/BF01030063">doi:10.1007/BF01030063</a>.</p>
</dd>
<dt class="label" id="id26"><span class="brackets">14</span></dt>
<dd><p>T. Pellarin, A. Mialon, R. Biron, C. Coulaud, F. Gibon, Y. Kerr, M. Lafaysse, B. Mercier, S. Morin, I. Redor, M. Schwank, and I. Völksch. Three years of L-band brightness temperature measurements in a mountainous area: Topography, vegetation and snowmelt issues. <em>Remote Sensing of Environment</em>, 180:85–98, 2016. <a class="reference external" href="https://doi.org/10.1016/j.rse.2016.02.047">doi:10.1016/j.rse.2016.02.047</a>.</p>
</dd>
<dt class="label" id="id3"><span class="brackets">15</span></dt>
<dd><p>J. Pulliainen, P. Lahtinen, J. Kärnä, and S. Koponen. Algorithm Theoretical Definition Document (ATDD) for Product SN-OBS-2 - Snow Status (Dry/Wet) by Microwave Radiometry. Technical Report H11, EUMETSAT H-SAF, 2010.</p>
</dd>
<dt class="label" id="id6"><span class="brackets">16</span></dt>
<dd><p>J. Pulliainen, K. Luojus, C. Derksen, L. Mudryk, J. Lemmetyinen, M. Salminen, J. Ikonen, M. Takala, J. Cohen, T. Smolander, and J. Norberg. Patterns and trends of Northern Hemisphere snow mass from 1980 to 2018. <em>Nature</em>, 581:294–298, 2020. <a class="reference external" href="https://doi.org/10.1038/s41586-020-2258-0">doi:10.1038/s41586-020-2258-0</a>.</p>
</dd>
<dt class="label" id="id25"><span class="brackets">17</span></dt>
<dd><p>K. Rautiainen, J. Lemmetyinen, J. Pulliainen, J. Vehviläinen, M. Drusch, A. Kontu, J. Kainulainen, and J. Seppänen. L-Band Radiometer Observations of Soil Processes in Boreal and Subarctic Environments. <em>IEEE Transactions on Geoscience and Remote Sensing</em>, 50(5):1483–1497, 2012. <a class="reference external" href="https://doi.org/10.1109/TGRS.2011.2167755">doi:10.1109/TGRS.2011.2167755</a>.</p>
</dd>
<dt class="label" id="id14"><span class="brackets">18</span></dt>
<dd><p>K. Rautiainen, J. Lemmetyinen, M. Schwank, A. Kontu, C. Ménard, C. Mätzler, M. Drusch, A. Wiesmann, J. Ikonen, and J. Pulliainen. Detection of soil freezing from L-band passive microwave observations. <em>Remote Sensing of Environment</em>, 147:206–218, 2014. <a class="reference external" href="https://doi.org/10.1016/j.rse.2014.03.007">doi:10.1016/j.rse.2014.03.007</a>.</p>
</dd>
<dt class="label" id="id5"><span class="brackets">19</span></dt>
<dd><p>W. Rees. <em>Remote Sensing of Snow and Ice</em>. CRC Press, 2005. <a class="reference external" href="https://doi.org/10.1201/9781420023749">doi:10.1201/9781420023749</a>.</p>
</dd>
<dt class="label" id="id10"><span class="brackets">20</span></dt>
<dd><p>Kathryn Semmens, Joan Ramage, Jeremy Apgar, Katrina Bennett, Glen Liston, and Elias Deeb. Passive Microwave Remote Sensing of Snowmelt and Melt‐Refreeze Using Diurnal Amplitude Variations. In <em>Geophysical Monograph Series</em>, pages 215–226. Wiley, 1 edition, 2014. <a class="reference external" href="https://doi.org/10.1002/9781118872086.ch13">doi:10.1002/9781118872086.ch13</a>.</p>
</dd>
<dt class="label" id="id19"><span class="brackets">21</span></dt>
<dd><p>M. Takala, K. Luojus, J. Pulliainen, C. Derksen, J. Lemmetyinen, J. Kärnä, J. Koskinen, and B. Bojkov. Estimating northern hemisphere snow water equivalent for climate research through assimilation of space-borne radiometer data and ground-based measurements. <em>Remote Sensing of Environment</em>, 115:3517–3529, 2011. <a class="reference external" href="https://doi.org/10.1016/j.rse.2011.08.014">doi:10.1016/j.rse.2011.08.014</a>.</p>
</dd>
<dt class="label" id="id4"><span class="brackets">22</span></dt>
<dd><p>M. Tedesco. <em>Remote Sensing of the Cryosphere</em>. John Wiley &amp; Sons, Ltd, 2014. <a class="reference external" href="https://doi.org/10.1002/9781118368909">doi:10.1002/9781118368909</a>.</p>
</dd>
<dt class="label" id="id24"><span class="brackets">23</span></dt>
<dd><p>S. Tuttle and J. Jacobs. Enhanced Identification of Snow Melt and Refreeze Events From Passive Microwave Brightness Temperature Using Air Temperature. <em>Water Resources Research</em>, 55(4):3248–3265, 2019. <a class="reference external" href="https://doi.org/10.1029/2018WR023995">doi:10.1029/2018WR023995</a>.</p>
</dd>
<dt class="label" id="id15"><span class="brackets">24</span></dt>
<dd><p>F. Ulaby and D. Long. <em>Microwave Radar and Radiometric Remote Sensing</em>. The University of Michigan Press, 2014. <a class="reference external" href="https://doi.org/10.3998/0472119356">doi:10.3998/0472119356</a>.</p>
</dd>
<dt class="label" id="id18"><span class="brackets">25</span></dt>
<dd><p>L. Zschenderlein, K. Luojus, M. Takala, P. Venäläinen, and J. Pulliainen. Evaluation of passive microwave dry snow detection algorithms and application to SWE retrieval during seasonal snow accumulation. <em>Remote Sensing of Environment</em>, 288:113476, 2023. <a class="reference external" href="https://doi.org/10.1016/j.rse.2023.113476">doi:10.1016/j.rse.2023.113476</a>.</p>
</dd>
</dl>
</div>
</section>
<span id="document-book/annex"></span><section class="tex2jax_ignore mathjax_ignore" id="annex">
<h2>Annex<a class="headerlink" href="#annex" title="Permalink to this heading">#</a></h2>
</section>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./book"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/abstract">Abstract</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/applicable_ref_docs">Applicable and Reference Documents</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/acronyms">Acronyms</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/definitions">Definitions</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/introduction_purpose_scope">Introduction, Purpose and Scope</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/background_justification_algorithm">Background and Justification of Selected Algorithm</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/L2_product_definition">Level-2 Product Definition</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/baseline_algorithm_definition">Baseline Algorithm Definition</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/algorithm_input_output_data_definition">Algorithm Input and Output Data Definition (IODD)</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/algorithm_performance_assessment">Algorithm Performance Assessment</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/roadmap">Roadmap for Future ATBD Development</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/references">References</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="book/intro.html#document-book/annex">Annex</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Finnish Meteorological Institute
</p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
This ATBD was developed in the context of the ESA-funded CIMR DEVALGO study (2022-2024) (contract 4000137493).
<br>
ESA is not responsible in any way for the content of this document.
</p>

</div>
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>