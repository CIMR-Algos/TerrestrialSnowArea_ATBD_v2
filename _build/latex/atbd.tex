%% Generated by Sphinx.
\def\sphinxdocclass{jupyterBook}
\documentclass[letterpaper,10pt,english]{jupyterBook}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}
%% turn off hyperref patch of \index as sphinx.xdy xindy module takes care of
%% suitable \hyperpage mark-up, working around hyperref-xindy incompatibility
\PassOptionsToPackage{hyperindex=false}{hyperref}
%% memoir class requires extra handling
\makeatletter\@ifclassloaded{memoir}
{\ifdefined\memhyperindexfalse\memhyperindexfalse\fi}{}\makeatother

\PassOptionsToPackage{warn}{textcomp}

\catcode`^^^^00a0\active\protected\def^^^^00a0{\leavevmode\nobreak\ }
\usepackage{cmap}
\usepackage{fontspec}
\defaultfontfeatures[\rmfamily,\sffamily,\ttfamily]{}
\usepackage{amsmath,amssymb,amstext}
\usepackage{polyglossia}
\setmainlanguage{english}



\setmainfont{FreeSerif}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Italic,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldItalic
]
\setsansfont{FreeSans}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]
\setmonofont{FreeMono}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]



\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}



        % Start of preamble defined in sphinx-jupyterbook-latex %
         \usepackage[Latin,Greek]{ucharclasses}
        \usepackage{unicode-math}
        % fixing title of the toc
        \addto\captionsenglish{\renewcommand{\contentsname}{Contents}}
        \hypersetup{
            pdfencoding=auto,
            psdextra
        }
        % End of preamble defined in sphinx-jupyterbook-latex %
        

\title{CIMR L2 Terrestrial Snow Area ATBD v2}
\date{May 31, 2024}
\release{}
\author{Finnish Meteorological Institute}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{book/intro::doc}}


\sphinxAtStartPar
This document describes the algorithm theoretical basis for the Terrestrial Snow Area (TSA) Level\sphinxhyphen{}2 product.
\begin{itemize}
\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{book/abstract::doc}]{\sphinxcrossref{Abstract}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{book/applicable_ref_docs::doc}]{\sphinxcrossref{Applicable and Reference Documents}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{book/acronyms::doc}]{\sphinxcrossref{Acronyms}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{book/definitions::doc}]{\sphinxcrossref{Definitions}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{book/introduction_purpose_scope::doc}]{\sphinxcrossref{Introduction, Purpose and Scope}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{book/background_justification_algorithm::doc}]{\sphinxcrossref{Background and Justification of Selected Algorithm}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{book/L2_product_definition::doc}]{\sphinxcrossref{Level\sphinxhyphen{}2 Product Definition}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{book/baseline_algorithm_definition::doc}]{\sphinxcrossref{Baseline Algorithm Definition}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{book/algorithm_input_output_data_definition::doc}]{\sphinxcrossref{Algorithm Input and Output Data Definition (IODD)}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{book/algorithm_performance_assessment::doc}]{\sphinxcrossref{Algorithm Performance Assessment}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{book/roadmap::doc}]{\sphinxcrossref{Roadmap for Future ATBD Development}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{book/references::doc}]{\sphinxcrossref{References}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{book/annex::doc}]{\sphinxcrossref{Annex}}}

\end{itemize}

\sphinxstepscope


\chapter{Abstract}
\label{\detokenize{book/abstract:abstract}}\label{\detokenize{book/abstract::doc}}
\sphinxAtStartPar
Snow cover is a central component of the Earth’s cryosphere, encountered at mid to high latitudes.
It plays an important role in climate and hydrologic systems, directly influencing the global surface energy budget and regional freshwater resources particularly in the Northern Hemisphere.
Rising temperatures have resulted in a profound global reduction of snow cover area and seasonal duration, which drastically affect the global climate and restrict communities in accessing subsistence and freshwater resources.
Understanding those climate impacts and risks to water supply is paramount for successful climate mitigation and adaptation, as well as informed water resource management.
This requires global monitoring tools, including spaceborne snow mapping using passive microwave data.

\sphinxAtStartPar
Snow mapping by means of spaceborne passive microwave dry snow detection is commonly based on the spectral difference between 18 GHz (Ku\sphinxhyphen{}band) and 36 GHz (Ka\sphinxhyphen{}band) brightness temperatures of horizontal polarisation.
This principle is also fundamental for the dry snow detection algorithm of the {\hyperref[\detokenize{book/definitions:term-Terrestrial-snow-area}]{\sphinxtermref{\DUrole{xref,std,std-term}{Terrestrial Snow Area}}}} ({\hyperref[\detokenize{book/acronyms:term-TSA}]{\sphinxtermref{\DUrole{xref,std,std-term}{TSA}}}}) Level\sphinxhyphen{}2 product for the {\hyperref[\detokenize{book/definitions:term-Copernicus-Imaging-Microwave-Radiometer}]{\sphinxtermref{\DUrole{xref,std,std-term}{Copernicus Imaging Microwave Radiometer}}}} ({\hyperref[\detokenize{book/acronyms:term-CIMR}]{\sphinxtermref{\DUrole{xref,std,std-term}{CIMR}}}}) mission.
The TSA algorithm implements the approaches of Hall \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id2}{2002}{]} and Pulliainen \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id3}{2010}{]}, as described in this Algorithm Theoretical Basis Document ({\hyperref[\detokenize{book/acronyms:term-ATBD}]{\sphinxtermref{\DUrole{xref,std,std-term}{ATBD}}}}).

\sphinxstepscope


\chapter{Applicable and Reference Documents}
\label{\detokenize{book/applicable_ref_docs:applicable-and-reference-documents}}\label{\detokenize{book/applicable_ref_docs::doc}}
\sphinxAtStartPar
List of applicable documents ({\hyperref[\detokenize{book/acronyms:term-AD}]{\sphinxtermref{\DUrole{xref,std,std-term}{AD}}}}) and reference documents ({\hyperref[\detokenize{book/acronyms:term-RD}]{\sphinxtermref{\DUrole{xref,std,std-term}{RD}}}}).


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
ID
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Document
\\
\hline
\sphinxAtStartPar
AD\sphinxhyphen{}1  
&
\sphinxAtStartPar
C. J. Donlon, 2019. The Copernicus Imaging Microwave Radiometer (CIMR) Mission Requirements Document v4.0, available \sphinxhref{https://esamultimedia.esa.int/docs/EarthObservation/CIMR-MRD-v4.0-20201006\_Issued.pdf}{here}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxstepscope


\chapter{Acronyms}
\label{\detokenize{book/acronyms:acronyms}}\label{\detokenize{book/acronyms::doc}}\begin{description}
\sphinxlineitem{ACDAT\index{ACDAT@\spxentry{ACDAT}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-ACDAT}}}
\sphinxAtStartPar
Algorithm Calibration Data Set

\sphinxlineitem{AD\index{AD@\spxentry{AD}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-AD}}}
\sphinxAtStartPar
Applicable Document

\sphinxlineitem{AVDAT\index{AVDAT@\spxentry{AVDAT}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-AVDAT}}}
\sphinxAtStartPar
Algorithm Validation Data Set

\sphinxlineitem{ATBD\index{ATBD@\spxentry{ATBD}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-ATBD}}}
\sphinxAtStartPar
Algorithm Theoretical Basis Document

\sphinxlineitem{BCK\index{BCK@\spxentry{BCK}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-BCK}}}
\sphinxAtStartPar
Backward scan

\sphinxlineitem{CF\index{CF@\spxentry{CF}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-CF}}}
\sphinxAtStartPar
NetCDF Climate and Forecast Metadata Conventions

\sphinxlineitem{CIMR\index{CIMR@\spxentry{CIMR}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-CIMR}}}
\sphinxAtStartPar
{\hyperref[\detokenize{book/definitions:term-Copernicus-Imaging-Microwave-Radiometer}]{\sphinxtermref{\DUrole{xref,std,std-term}{Copernicus Imaging Microwave Radiometer}}}}

\sphinxlineitem{CRS\index{CRS@\spxentry{CRS}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-CRS}}}
\sphinxAtStartPar
Coordinate Reference System

\sphinxlineitem{EASE\sphinxhyphen{}Grid\index{EASE\sphinxhyphen{}Grid@\spxentry{EASE\sphinxhyphen{}Grid}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-EASE-Grid}}}
\sphinxAtStartPar
{\hyperref[\detokenize{book/definitions:term-Equal-Area-Scalable-Earth-Grid}]{\sphinxtermref{\DUrole{xref,std,std-term}{Equal\sphinxhyphen{}Area Scalable Earth Grid}}}}

\sphinxlineitem{ECMWF\index{ECMWF@\spxentry{ECMWF}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-ECMWF}}}
\sphinxAtStartPar
European Centre for Medium\sphinxhyphen{}Range Weather Forecasts

\sphinxlineitem{ESA\index{ESA@\spxentry{ESA}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-ESA}}}
\sphinxAtStartPar
European Space Agency

\sphinxlineitem{EUMETSAT\index{EUMETSAT@\spxentry{EUMETSAT}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-EUMETSAT}}}
\sphinxAtStartPar
European Organization for the Exploitation of Meteorological Satellites

\sphinxlineitem{FMI\index{FMI@\spxentry{FMI}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-FMI}}}
\sphinxAtStartPar
Finnish Meteorological Institute

\sphinxlineitem{FN\index{FN@\spxentry{FN}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-FN}}}
\sphinxAtStartPar
False Negative

\sphinxlineitem{FP\index{FP@\spxentry{FP}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-FP}}}
\sphinxAtStartPar
False Positive

\sphinxlineitem{FWD\index{FWD@\spxentry{FWD}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-FWD}}}
\sphinxAtStartPar
Forward scan

\sphinxlineitem{H SAF\index{H SAF@\spxentry{H SAF}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-H-SAF}}}
\sphinxAtStartPar
EUMETSAT Support to Operational Hydrology and Water Management

\sphinxlineitem{IMS\index{IMS@\spxentry{IMS}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-IMS}}}
\sphinxAtStartPar
Interactive Multisensor Snow and Ice Mapping System

\sphinxlineitem{IODD\index{IODD@\spxentry{IODD}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-IODD}}}
\sphinxAtStartPar
Input and Output Data Definition

\sphinxlineitem{MPEF\index{MPEF@\spxentry{MPEF}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-MPEF}}}
\sphinxAtStartPar
Algorithm Performance Metrics

\sphinxlineitem{NH\index{NH@\spxentry{NH}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-NH}}}
\sphinxAtStartPar
Northern Hemisphere

\sphinxlineitem{NRT\index{NRT@\spxentry{NRT}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-NRT}}}
\sphinxAtStartPar
Near Real\sphinxhyphen{}Time

\sphinxlineitem{NWP\index{NWP@\spxentry{NWP}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-NWP}}}
\sphinxAtStartPar
Numerical Weather Prediction

\sphinxlineitem{PMW\index{PMW@\spxentry{PMW}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-PMW}}}
\sphinxAtStartPar
Passive microwave

\sphinxlineitem{RD\index{RD@\spxentry{RD}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-RD}}}
\sphinxAtStartPar
Reference Document

\sphinxlineitem{SD\index{SD@\spxentry{SD}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-SD}}}
\sphinxAtStartPar
Snow depth

\sphinxlineitem{SSM/I\index{SSM/I@\spxentry{SSM/I}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-SSM-I}}}
\sphinxAtStartPar
Special Sensor Microwave/Imager

\sphinxlineitem{SSMIS\index{SSMIS@\spxentry{SSMIS}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-SSMIS}}}
\sphinxAtStartPar
Special Sensor Microwave Imager/Sounder

\sphinxlineitem{SWE\index{SWE@\spxentry{SWE}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-SWE}}}
\sphinxAtStartPar
{\hyperref[\detokenize{book/definitions:term-Snow-water-equivalent}]{\sphinxtermref{\DUrole{xref,std,std-term}{Snow water equivalent}}}}

\sphinxlineitem{TB\index{TB@\spxentry{TB}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-TB}}}
\sphinxAtStartPar
Brightness temperature

\sphinxlineitem{TN\index{TN@\spxentry{TN}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-TN}}}
\sphinxAtStartPar
True Negative

\sphinxlineitem{TP\index{TP@\spxentry{TP}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-TP}}}
\sphinxAtStartPar
True Positive

\sphinxlineitem{TSA\index{TSA@\spxentry{TSA}|spxpagem}\phantomsection\label{\detokenize{book/acronyms:term-TSA}}}
\sphinxAtStartPar
{\hyperref[\detokenize{book/definitions:term-Terrestrial-snow-area}]{\sphinxtermref{\DUrole{xref,std,std-term}{Terrestrial snow area}}}}

\end{description}

\sphinxstepscope


\chapter{Definitions}
\label{\detokenize{book/definitions:definitions}}\label{\detokenize{book/definitions::doc}}\begin{description}
\sphinxlineitem{Copernicus Imaging Microwave Radiometer\index{Copernicus Imaging Microwave Radiometer@\spxentry{Copernicus Imaging Microwave Radiometer}|spxpagem}\phantomsection\label{\detokenize{book/definitions:term-Copernicus-Imaging-Microwave-Radiometer}}}
\sphinxAtStartPar
The Copernicus Imaging Microwave Radiometer or CIMR mission by ESA includes a wide\sphinxhyphen{}swath conically\sphinxhyphen{}scanning multi\sphinxhyphen{}frequency microwave radiometer with launch planned for 2028.

\sphinxlineitem{Dry snow\index{Dry snow@\spxentry{Dry snow}|spxpagem}\phantomsection\label{\detokenize{book/definitions:term-Dry-snow}}}
\sphinxAtStartPar
Snowpack with liquid water content equal to zero.

\sphinxlineitem{Equal\sphinxhyphen{}Area Scalable Earth Grid\index{Equal\sphinxhyphen{}Area Scalable Earth Grid@\spxentry{Equal\sphinxhyphen{}Area Scalable Earth Grid}|spxpagem}\phantomsection\label{\detokenize{book/definitions:term-Equal-Area-Scalable-Earth-Grid}}}
\sphinxAtStartPar
Northern and Southern Hemisphere projections of EASE\sphinxhyphen{}Grid 2.0 are based on polar aspect Lambert azimuthal equal\sphinxhyphen{}area projections, as defined by Brodzik \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id17}{2012}{]}.

\sphinxlineitem{Scattering signature\index{Scattering signature@\spxentry{Scattering signature}|spxpagem}\phantomsection\label{\detokenize{book/definitions:term-Scattering-signature}}}
\sphinxAtStartPar
Difference in brightness temperature between two different frequency channels for snow\sphinxhyphen{}covered ground due to volume scattering.

\sphinxlineitem{Signal saturation\index{Signal saturation@\spxentry{Signal saturation}|spxpagem}\phantomsection\label{\detokenize{book/definitions:term-Signal-saturation}}}
\sphinxAtStartPar
Scattering signature cannot be used to estimate snow depths for snow depths above about 1.25m because maximum volume scattering has been reached.

\sphinxlineitem{Snow water equivalent\index{Snow water equivalent@\spxentry{Snow water equivalent}|spxpagem}\phantomsection\label{\detokenize{book/definitions:term-Snow-water-equivalent}}}
\sphinxAtStartPar
Snow water equivalent or SWE describes the equivalent amount of liquid water contained within a snowpack, and is defined as the product between snow depth and snow density. It is measured as a water column that would result if the whole snowpack was melted instantaneously.

\sphinxlineitem{Terrestrial snow area\index{Terrestrial snow area@\spxentry{Terrestrial snow area}|spxpagem}\phantomsection\label{\detokenize{book/definitions:term-Terrestrial-snow-area}}}
\sphinxAtStartPar
The terrestrial snow area or TSA describes the extent of snow\sphinxhyphen{}covered land.

\end{description}

\sphinxstepscope


\chapter{Introduction, Purpose and Scope}
\label{\detokenize{book/introduction_purpose_scope:introduction-purpose-and-scope}}\label{\detokenize{book/introduction_purpose_scope::doc}}
\sphinxAtStartPar
Snow monitoring on a global scale is an important task considering the essential role of snow in the global climate and hydrologic systems, and given the scarcity of ground\sphinxhyphen{}based snow observations globally.
Snow has distinctive, frequency\sphinxhyphen{}dependent characteristics in terms of microwave emission.
This enables the use of brightness temperatures as measured by spaceborne passive microwave sensors, for the estimation of {\hyperref[\detokenize{book/definitions:term-Terrestrial-snow-area}]{\sphinxtermref{\DUrole{xref,std,std-term}{terrestrial snow area}}}} ({\hyperref[\detokenize{book/acronyms:term-TSA}]{\sphinxtermref{\DUrole{xref,std,std-term}{TSA}}}}) through snow detection methods.
Such snow detection is moreover a preprocessing step for the global retrieval of {\hyperref[\detokenize{book/definitions:term-Snow-water-equivalent}]{\sphinxtermref{\DUrole{xref,std,std-term}{snow water equivalent}}}} ({\hyperref[\detokenize{book/acronyms:term-SWE}]{\sphinxtermref{\DUrole{xref,std,std-term}{SWE}}}}) in order to minimise uncertainties in the latter {[}\hyperlink{cite.book/references:id22}{Luojus \sphinxstyleemphasis{et al.}, 2021}{]}.
Reliable snow detection is thus crucial not only for the estimation of {\hyperref[\detokenize{book/acronyms:term-TSA}]{\sphinxtermref{\DUrole{xref,std,std-term}{TSA}}}}, but also for the quantification and trend analysis of {\hyperref[\detokenize{book/acronyms:term-SWE}]{\sphinxtermref{\DUrole{xref,std,std-term}{SWE}}}} {[}\hyperlink{cite.book/references:id6}{Pulliainen \sphinxstyleemphasis{et al.}, 2020}{]}.

\sphinxAtStartPar
Snow is a mixture of ice crystals, liquid water and air.
Over time, the density of a snow pack increases due to compaction by wind and gravity, and due to thermal metamorphism.
Its internal structure is characterised primarily by the grain or crystal size, and by the form and orientation of those crystals.
A further property is snow wetness which refers to the liquid water content.
For temperatures at or above the freezing point, a considerable amount of liquid water might be present within a ‘wet’ snowpack.
For temperatures below the freezing point, on the other hand, a snowpack is unlikely to contain any liquid water and is thus considered to be ‘dry’.
Below we discuss {\hyperref[\detokenize{book/acronyms:term-PMW}]{\sphinxtermref{\DUrole{xref,std,std-term}{PMW}}}} remote sensing of snow with a focus on the detection of (mostly) {\hyperref[\detokenize{book/definitions:term-Dry-snow}]{\sphinxtermref{\DUrole{xref,std,std-term}{dry snow}}}} and associated challenges.

\sphinxAtStartPar
In contrast to visible and near\sphinxhyphen{}infrared bands, dry snow is mostly transparent to microwave radiation.
The microwave energy that is emitted from a snowpack hence originates not only from its surface, but also from deeper snow layers and from the ground beneath.
For dry snow detection, the contribution in emission from the snow layer itself is most of the times negligible because of its low emissivity in comparison to the ground underneath.
The emission of the ground is in turn attenuated by the snow cover, predominantly due to volume scattering.
Since the magnitude of this attenuation is dependent on the microwave wavelength amongst other factors, lower brightness temperatures are measured for higher frequencies in the presence of snow.
Dry snow is thus commonly detected by comparing the brightness temperatures of different frequency bands in order to identify such attenuation.

\sphinxAtStartPar
Volume scattering, the dominating type of attenuation as observed for dry snow, is highly dependent on frequency.
Air acts as a surrounding medium for the ice particles with diameters on the order of millimetres.
For propagating waves with wavelengths noticeably larger than this, snow appears as a homogeneous medium with only absorptive effects.
For wavelengths of similar magnitude, the ice particles act as scatterers due to the inhomogeneous dielectric properties between the ice itself and the air background {[}\hyperlink{cite.book/references:id15}{Ulaby and Long, 2014}{]}.
This scattering mechanism is illustrated in \hyperref[\detokenize{book/introduction_purpose_scope:emission-scattering}]{Fig.\@ \ref{\detokenize{book/introduction_purpose_scope:emission-scattering}}}.
The phenomenon that the emissivity of snow\sphinxhyphen{}covered ground decreases with increasing frequency, is unique among land cover types and is directly influenced by the snow’s properties {[}\hyperlink{cite.book/references:id13}{Mätzler, 1994}{]}.
The impact of wavelength on scattering behaviour can be applied to snow grain size: the higher the frequency and/or the larger the grains, the more scattering is observed as the particle size approaches the wavelength.
Snow density has a similar effect to grain size and since both generally increase for aging snow, older snowpacks result in more attenuation.
A further aspect to consider is snow depth, given deeper snowpacks naturally allow for more scattering to take place.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=350\sphinxpxdimen]{{emission-scattering}.png}
\caption{Schematic of the microwave emission from snow characterised by volume scattering.}\label{\detokenize{book/introduction_purpose_scope:emission-scattering}}\end{figure}

\sphinxAtStartPar
This attenuation found for snow\sphinxhyphen{}covered surfaces is detected through the difference in brightness temperature between two (or more) PMW bands.
A channel of lower frequency provides a scatter\sphinxhyphen{}free reference brightness temperature, whereas higher frequency channels may show an attenuation in brightness temperatures due to their sensitivity to scattering.
For this, the Ku and Ka\sphinxhyphen{}band are common respective choices {[}\hyperlink{cite.book/references:id7}{Chang \sphinxstyleemphasis{et al.}, 1987}, \hyperlink{cite.book/references:id8}{Foster \sphinxstyleemphasis{et al.}, 1997}, \hyperlink{cite.book/references:id9}{Grody and Basist, 1996}, \hyperlink{cite.book/references:id2}{Hall \sphinxstyleemphasis{et al.}, 2002}{]}.
Such a spectral difference, often referred to as scattering signature, is obviously sensitive to snow presence in first place as well as to snow properties and even to subnivean soil conditions {[}\hyperlink{cite.book/references:id13}{Mätzler, 1994}{]}.

\sphinxAtStartPar
This sensitivity to snow properties can be exploited to derive snow depth estimates from scattering signatures.
However, snow depths of less than about 3 cm are seldomly detected because the scattering effect is only marginal {[}\hyperlink{cite.book/references:id7}{Chang \sphinxstyleemphasis{et al.}, 1987}, \hyperlink{cite.book/references:id2}{Hall \sphinxstyleemphasis{et al.}, 2002}{]}.
To improve the sensitivity to thin snowpacks, brightness temperatures from high frequencies of 85 GHz and above can be included as those are subject to increased volume scattering {[}\hyperlink{cite.book/references:id9}{Grody and Basist, 1996}{]}.
In addition, the influence of the underlying ground on the observed emission is more apparent for shallow snowpacks; an increase in soil temperature and/or wetness may significantly increase the measured brightness temperature.
On the other hand, snow depths corresponding to bulk {\hyperref[\detokenize{book/acronyms:term-SWE}]{\sphinxtermref{\DUrole{xref,std,std-term}{SWE}}}} of about 150 mm become problematic as the maximum observable scattering is reached.
This results in signal saturation i.e. snow depths cannot be reliably estimated anymore using the brightness temperature difference since no variations in scattering are present beyond this snow depth {[}\hyperlink{cite.book/references:id19}{Takala \sphinxstyleemphasis{et al.}, 2011}{]}.
Snow is now the primary emitter, and its emissivity starts to increase rather than decrease for increasing snow depth {[}\hyperlink{cite.book/references:id8}{Foster \sphinxstyleemphasis{et al.}, 1997}, \hyperlink{cite.book/references:id13}{Mätzler, 1994}{]}.

\sphinxAtStartPar
In contrast to dry snow and regardless of polarisation, consistently wet or melting snow can be hardly discriminated from bare wet or frozen soil.
The liquid water content significantly reduces if not eliminates the snowpack’s transparency to microwave radiation, as shown in \hyperref[\detokenize{book/introduction_purpose_scope:emission-ambient}]{Fig.\@ \ref{\detokenize{book/introduction_purpose_scope:emission-ambient}}}.
The scattering signature as such is thus not present, and the emissivity spectrum of wet snow is hence drastically different to the one of dry snow {[}\hyperlink{cite.book/references:id13}{Mätzler, 1994}{]}.
The internal wetness of snow also affects the capability of scattering signatures for snow accumulation monitoring.
Even though PMW remote sensing can be used to retrieve accumulation rates in the dry\sphinxhyphen{}snow zone of ice sheets, it is greatly limited by spatial and temporal variability in liquid water and refrozen subsurface ice structures, and relies highly on in situ measurements.
An additional classification for glacial ice might need to be introduced since common scattering signatures for snow detection can result in a lack of scattering for large regions of Greenland and Antarctica {[}\hyperlink{cite.book/references:id9}{Grody and Basist, 1996}{]}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=350\sphinxpxdimen]{{emission-ambient}.png}
\caption{Schematic of the effect of ambient conditions (vegetation and liquid water content) on the microwave emission from snow.}\label{\detokenize{book/introduction_purpose_scope:emission-ambient}}\end{figure}

\sphinxAtStartPar
Liquid water similarly poses a key challenge in form of water bodies.
For that reason, large waters such as oceans and large lakes are commonly masked out, as are pixels that cover large percentages of water e.g. in coastal areas or lakeland.
Another problem is that most of the Earth’s seasonal snow cover occurs in complex landscapes.
Firstly, mountainous terrain hinders snow detection since large spatial differences in snow depth are to be expected: whilst deep snow eventually reaches saturation depth, the signal of areas with shallow snow prevails which may be mistaken for bare ground.
And secondly, the changes in slope gradient within the sensor footprint cause variations in (local) observation angle and thus in view\sphinxhyphen{}dependent emissivity which again may be falsely identified as snow\sphinxhyphen{}free conditions.
Besides, overlying vegetation reflects upwelling microwave radiation and emits some on its own {[}\hyperlink{cite.book/references:id9}{Grody and Basist, 1996}{]}, as illustrated in \hyperref[\detokenize{book/introduction_purpose_scope:emission-ambient}]{Fig.\@ \ref{\detokenize{book/introduction_purpose_scope:emission-ambient}}}.
Snow cover in forested areas consequently presents higher emissivities and brightness temperatures than in unforested regions.

\sphinxAtStartPar
Limitations of dry snow detection based on the scattering signature also arise due to anomalous scattering signals, caused for instance by precipitation or cold deserts {[}\hyperlink{cite.book/references:id9}{Grody and Basist, 1996}{]}, or due to internal variations in snow properties.
The latter includes variations in density and grain size resulting from the snowpack stratigraphy.
Those distinctive snow layers affect more the horizontal than the vertical polarisations of the Ku and Ka\sphinxhyphen{}band channels {[}\hyperlink{cite.book/references:id16}{Kelly \sphinxstyleemphasis{et al.}, 2003}{]}.
It could be derived that vertical polarisations are more appropriate for snow depth estimations given they are less responsive to internal characteristics, whilst horizontal polarisations are more sensitive to those same properties and therefore suitable for detecting dry snow in first place {[}\hyperlink{cite.book/references:id16}{Kelly \sphinxstyleemphasis{et al.}, 2003}{]}.
Nonetheless, either polarisation have been applied for dry snow detection.

\sphinxAtStartPar
The purpose of this {\hyperref[\detokenize{book/acronyms:term-ATBD}]{\sphinxtermref{\DUrole{xref,std,std-term}{ATBD}}}} is to detail the implementation of the CIMR Level\sphinxhyphen{}2 Terrestrial Snow Area (TSA) product, in form of a binary classification.
The scope is the implementation of a stable version using horizontally polarised Ka and Ku\sphinxhyphen{}band brightness temperatures as core frequency bands according to Hall \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id2}{2002}{]} and Pulliainen \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id3}{2010}{]}.

\sphinxstepscope


\chapter{Background and Justification of Selected Algorithm}
\label{\detokenize{book/background_justification_algorithm:background-and-justification-of-selected-algorithm}}\label{\detokenize{book/background_justification_algorithm::doc}}
\sphinxAtStartPar
Dry snow is often detected by the use of multi\sphinxhyphen{}spectral and/or multi\sphinxhyphen{}polarization methods.
Such passive microwave dry snow detection algorithms are commonly based on the Ka and Ku\sphinxhyphen{}band {[}\hyperlink{cite.book/references:id7}{Chang \sphinxstyleemphasis{et al.}, 1987}, \hyperlink{cite.book/references:id2}{Hall \sphinxstyleemphasis{et al.}, 2002}{]}.
For the {\hyperref[\detokenize{book/acronyms:term-TSA}]{\sphinxtermref{\DUrole{xref,std,std-term}{TSA}}}} product, the dry snow detection algorithm by Pulliainen \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id3}{2010}{]} is selected, which implements the approach by Hall \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id2}{2002}{]} with updated empirical thresholds.
The origins of the algorithm reach back to a physical model inversion by Chang \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id7}{1987}{]}.

\sphinxAtStartPar
The algorithm in this form is found to perform best for the channels available from {\hyperref[\detokenize{book/acronyms:term-CIMR}]{\sphinxtermref{\DUrole{xref,std,std-term}{CIMR}}}}, according to Zschenderlein \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id18}{2023}{]}.
This study includes an extensive long\sphinxhyphen{}term comparison of {\hyperref[\detokenize{book/acronyms:term-PMW}]{\sphinxtermref{\DUrole{xref,std,std-term}{PMW}}}} dry snow detection approaches centering on the Ka and Ku\sphinxhyphen{}bands, namely Armstrong and Brodzik {[}\hyperlink{cite.book/references:id11}{2001}{]}, Chang \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id7}{1987}{]}, Foster \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id8}{1997}{]}, Grody and Basist {[}\hyperlink{cite.book/references:id9}{1996}{]}, Hall \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id2}{2002}{]} and Pulliainen \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id3}{2010}{]}.
The latter two algorithms are implemented in the GlobSnow v3.0 {\hyperref[\detokenize{book/acronyms:term-SWE}]{\sphinxtermref{\DUrole{xref,std,std-term}{SWE}}}} product of the Global Snow Monitoring for Climate Research initiative of the European Space Agency ({\hyperref[\detokenize{book/acronyms:term-ESA}]{\sphinxtermref{\DUrole{xref,std,std-term}{ESA}}}}) {[}\hyperlink{cite.book/references:id22}{Luojus \sphinxstyleemphasis{et al.}, 2021}{]}, and in the snow status (dry/wet) H11 product by the Support to Operational Hydrology and Water Management ({\hyperref[\detokenize{book/acronyms:term-H-SAF}]{\sphinxtermref{\DUrole{xref,std,std-term}{H SAF}}}}) of the European Organization for the Exploitation of Meteorological Satellites ({\hyperref[\detokenize{book/acronyms:term-EUMETSAT}]{\sphinxtermref{\DUrole{xref,std,std-term}{EUMETSAT}}}}).
The approaches by Hall \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id2}{2002}{]} and Pulliainen \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id3}{2010}{]} are thus referred to as \sphinxstyleemphasis{GlobSnow} and \sphinxstyleemphasis{H SAF}, respectively.

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
Due to significant differences in microwave emission between wet and dry snow {[}\hyperlink{cite.book/references:id13}{Mätzler, 1994}{]}, the PMW methods mentioned here apply only to dry snow conditions with minimal liquid water content, and are furthermore static i.e. disregarding temporal variations for instance in snow grain size or snow density.
\end{sphinxadmonition}

\sphinxAtStartPar
PMW dry snow detection algorithms are known to generally underestimate the presence of snow due to their sensitivity to vegetation and liquid water content of the snowpack, among other reasons.
This can be seen in \hyperref[\detokenize{book/background_justification_algorithm:difference}]{Fig.\@ \ref{\detokenize{book/background_justification_algorithm:difference}}} which illustrates the difference between snow extent as estimated by GlobSnow and H SAF for brightness temperatures of SSM/I and SSMIS, with respect to snow maps of the Interactive Multisensor Snow and Ice Mapping System ({\hyperref[\detokenize{book/acronyms:term-IMS}]{\sphinxtermref{\DUrole{xref,std,std-term}{IMS}}}}).
Daily {\hyperref[\detokenize{book/acronyms:term-IMS}]{\sphinxtermref{\DUrole{xref,std,std-term}{IMS}}}} maps are based on multiple input sources and human analysis, and serve therefore as spatially complete reference for global snow extent complementing pointwise weather station measurements.
A negative number indicates the days per pixel for which the PMW algorithm flags ‘snow\sphinxhyphen{}free’ and IMS data flags ‘snow’, and vice versa for a positive number.
The difference shown in \hyperref[\detokenize{book/background_justification_algorithm:difference}]{Fig.\@ \ref{\detokenize{book/background_justification_algorithm:difference}}} then gives the final sum of both cases for every day of the investigated time period, and thus shows the tendency of an algorithm to under\sphinxhyphen{} or overestimate.
The better performance of H SAF over GlobSnow is apparent, and the dry snow detection part of the ESA Snow Climate Change Initiative (CCI) project has been updated accordingly to the approach by Pulliainen \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id3}{2010}{]}.
This approach is the most accurate to\sphinxhyphen{}date on a global scale for the channels available on CIMR, and is therefore chosen for the Level\sphinxhyphen{}2 TSA product.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{difference}.png}
\caption{Difference maps of PMW algorithms with respect to IMS data over all snow seasons (September\sphinxhyphen{}February) from 2007/2008 until 2016/2017 above 40° N, based on Zschenderlein \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id18}{2023}{]}.}\label{\detokenize{book/background_justification_algorithm:difference}}\end{figure}

\sphinxstepscope


\chapter{Level\sphinxhyphen{}2 Product Definition}
\label{\detokenize{book/L2_product_definition:level-2-product-definition}}\label{\detokenize{book/L2_product_definition::doc}}
\sphinxAtStartPar
The Level\sphinxhyphen{}2 TSA product files are provided in netCDF format, with contents as defined in Tables \hyperref[\detokenize{book/L2_product_definition:product-netcdf}]{\ref{\detokenize{book/L2_product_definition:product-netcdf}}}, \hyperref[\detokenize{book/L2_product_definition:variable-attributes}]{\ref{\detokenize{book/L2_product_definition:variable-attributes}}}, and \hyperref[\detokenize{book/L2_product_definition:global-attributes}]{\ref{\detokenize{book/L2_product_definition:global-attributes}}}.
Each data variable of the processed data in \hyperref[\detokenize{book/L2_product_definition:product-netcdf}]{Table \ref{\detokenize{book/L2_product_definition:product-netcdf}}} holds conventional attributes following NetCDF Climate and Forecast Metadata Conventions Version 1.7 (CF\sphinxhyphen{}1.7) or above as given in \hyperref[\detokenize{book/L2_product_definition:variable-attributes}]{Table \ref{\detokenize{book/L2_product_definition:variable-attributes}}}.
Some global attributes of the Level\sphinxhyphen{}2 product files are given in \hyperref[\detokenize{book/L2_product_definition:global-attributes}]{Table \ref{\detokenize{book/L2_product_definition:global-attributes}}}.


\sphinxstrong{See also:}
\nopagebreak


\sphinxAtStartPar
Refer \DUrole{xref,myst}{here} for a sample run demonstrating the processing sequence to create the L2 TSA product files.




\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{NetCDF Group: Processed Data (tbc).}\label{\detokenize{book/L2_product_definition:product-netcdf}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Variable name
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Units
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Dimension
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{tsa}}
&
\sphinxAtStartPar
Terrestrial snow area \sphinxcode{\sphinxupquote{(\{term\}}}TSA`)
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
(nx,ny)
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{tsa\_uncertainty}}
&
\sphinxAtStartPar
Confidence of detected  TSA
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
(nx,ny)
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{status\_flag}}
&
\sphinxAtStartPar
Flag indicating pixel status
&
\sphinxAtStartPar
n/a
&
\sphinxAtStartPar
(nx,ny)
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{crs}}
&
\sphinxAtStartPar
Coordinate reference system ({\hyperref[\detokenize{book/acronyms:term-CRS}]{\sphinxtermref{\DUrole{xref,std,std-term}{CRS}}}}) of the TSA product
&
\sphinxAtStartPar
n/a
&
\sphinxAtStartPar
n/a
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{lat}}
&
\sphinxAtStartPar
Latitudes of pixel centres according to CRS
&
\sphinxAtStartPar
degrees North
&
\sphinxAtStartPar
(nx,ny)
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{lon}}
&
\sphinxAtStartPar
Longitudes of pixel centres according to CRS
&
\sphinxAtStartPar
degrees East
&
\sphinxAtStartPar
(nx,ny)
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{x}}
&
\sphinxAtStartPar
x\sphinxhyphen{}Coordinate of the CRS
&
\sphinxAtStartPar
m
&
\sphinxAtStartPar
(nx)
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{y}}
&
\sphinxAtStartPar
y\sphinxhyphen{}Coordinate of the CRS
&
\sphinxAtStartPar
m
&
\sphinxAtStartPar
(ny)
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
The CIMR Level\sphinxhyphen{}2 TSA product are gridded files. The dimensions of each variable in the Level\sphinxhyphen{}2 file refer to the (nx,ny) dimensions of the product grid, i.e. EASE\sphinxhyphen{}Grid 2.0 NH polar projection.
\end{sphinxadmonition}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Standard variable attributes (tbc).}\label{\detokenize{book/L2_product_definition:variable-attributes}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Name
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{standard\_name}}
&
\sphinxAtStartPar
Sandard name referencing the description of a variable’s content
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{long\_name}}
&
\sphinxAtStartPar
Descriptive name indicating a variable’s content
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{fill\_value}}
&
\sphinxAtStartPar
Value indicating missing or undefined data
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{units}}
&
\sphinxAtStartPar
Unit of measure
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Global attributes (tbc).}\label{\detokenize{book/L2_product_definition:global-attributes}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Name
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{title}}
&
\sphinxAtStartPar
CIMR L2 Terrestrial Snow Area
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{processing\_level}}
&
\sphinxAtStartPar
Level\sphinxhyphen{}2
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{time\_coverage\_start}}
&
\sphinxAtStartPar
Valid start time of the product
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{time\_coverage\_end}}
&
\sphinxAtStartPar
Valid end time of the product
\\
\hline
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{area}}
&
\sphinxAtStartPar
Northern Hemisphere
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxstepscope


\chapter{Baseline Algorithm Definition}
\label{\detokenize{book/baseline_algorithm_definition:baseline-algorithm-definition}}\label{\detokenize{book/baseline_algorithm_definition::doc}}
\sphinxAtStartPar
The {\hyperref[\detokenize{book/acronyms:term-TSA}]{\sphinxtermref{\DUrole{xref,std,std-term}{TSA}}}} algorithm is based on dry snow detection as described by Hall \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id2}{2002}{]} and Pulliainen \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id3}{2010}{]}. This empirical algorithm is based on the underlying physical principle that microwave radiation of higher frequencies is attenuated by snow cover due to volume scattering, while lower frequencies remain mostly unaffected.
The TSA product is only concerned with snow cover in the Northern Hemisphere, where seasonal terrestrial snow predominantly occurs.


\sphinxstrong{See also:}
\nopagebreak


\sphinxAtStartPar
Refer \DUrole{xref,myst}{here} for a top\sphinxhyphen{}level script of the Level\sphinxhyphen{}2 TSA algorithm including output file generation, and \DUrole{xref,myst}{here} for added step\sphinxhyphen{}by\sphinxhyphen{}step visualization.




\section{Retrieval Method}
\label{\detokenize{book/baseline_algorithm_definition:retrieval-method}}
\sphinxAtStartPar
The retrieval of TSA encompasses the following main steps:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Step 1: \sphinxstylestrong{Dry snow detection} algorithm

\item {} 
\sphinxAtStartPar
Step 2: \sphinxstylestrong{Combined reprojection} of forward and backward TSA maps

\item {} 
\sphinxAtStartPar
Step 3: \sphinxstylestrong{Masking and Flagging} for final TSA maps including qualitative uncertainty estimates

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
The specifics of the retrieval methodology may be subject to change, but will follow the general structure as outlined.
\end{sphinxadmonition}


\section{Forward Model}
\label{\detokenize{book/baseline_algorithm_definition:forward-model}}
\sphinxAtStartPar
The origins of the implemented algorithm stem from Chang \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id7}{1987}{]}, who present a linear relationship between snow depth and spectral difference (see \eqref{equation:book/baseline_algorithm_definition:TB_diff}).
This relationship is derived from an empirical fit of simulated microwave brightness temperatures for varying {\hyperref[\detokenize{book/acronyms:term-SWE}]{\sphinxtermref{\DUrole{xref,std,std-term}{SWE}}}}, using a microscopic scattering model {[}\hyperlink{cite.book/references:id23}{Chang \sphinxstyleemphasis{et al.}, 1982}{]}.
The model takes into consideration the underlying (un\sphinxhyphen{})frozen surface conditions as well as the physical temperature, density, and grain size of the snowpack.
Snow grains are assumed to be spherical and randomly\sphinxhyphen{}spaced, resulting in incoherent scattering.
The radiative transfer equation is solved numerically.


\section{CIMR Level\sphinxhyphen{}1b Resampling Approach}
\label{\detokenize{book/baseline_algorithm_definition:cimr-level-1b-resampling-approach}}
\sphinxAtStartPar
Prior to the main TSA algorithm, the current {\hyperref[\detokenize{book/acronyms:term-CIMR}]{\sphinxtermref{\DUrole{xref,std,std-term}{CIMR}}}} Level\sphinxhyphen{}2 TSA framework includes the resampling of L1b TB data to collocate channels to a target channel.
The implemented resampling approach stems from the \sphinxhref{https://github.com/CIMR-Algos/Tools}{CIMR Devalgo Tools}, with the target resolution of Ku\sphinxhyphen{}band TB data being set to match Ka\sphinxhyphen{}band resolution.
For future research purposes, it is encouraged to also remap X\sphinxhyphen{}band TB data with Ka\sphinxhyphen{}band as target.


\section{Algorithm Assumptions and Simplifications}
\label{\detokenize{book/baseline_algorithm_definition:algorithm-assumptions-and-simplifications}}
\sphinxAtStartPar
The implemented algorithm follows a static approach, assuming that snow density and snow grain properties are spatially and temporally constant.
Different land cover properties are not considered.


\section{Level\sphinxhyphen{}2 End\sphinxhyphen{}to\sphinxhyphen{}End Algorithm Functional Flow Diagram}
\label{\detokenize{book/baseline_algorithm_definition:level-2-end-to-end-algorithm-functional-flow-diagram}}
\sphinxAtStartPar
\hyperref[\detokenize{book/baseline_algorithm_definition:flow-diagram}]{Fig.\@ \ref{\detokenize{book/baseline_algorithm_definition:flow-diagram}}} shows the functional structure for the computation of the TSA product.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=450\sphinxpxdimen]{{L2-algorithm}.png}
\caption{Functional flow diagram of the Level\sphinxhyphen{}2 end to end algorithm of the TSA product.}\label{\detokenize{book/baseline_algorithm_definition:flow-diagram}}\end{figure}


\section{Functional Description of Each Algorithm Step}
\label{\detokenize{book/baseline_algorithm_definition:functional-description-of-each-algorithm-step}}
\sphinxAtStartPar
The three main steps, as outlined in the flow diagram in \hyperref[\detokenize{book/baseline_algorithm_definition:flow-diagram}]{Fig.\@ \ref{\detokenize{book/baseline_algorithm_definition:flow-diagram}}}, are described hereafter.


\subsection{Dry Snow Detection}
\label{\detokenize{book/baseline_algorithm_definition:dry-snow-detection}}

\subsubsection{Mathematical description}
\label{\detokenize{book/baseline_algorithm_definition:mathematical-description}}
\sphinxAtStartPar
The dry snow detection algorithm of the TSA product is based on the approach of Hall \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id2}{2002}{]} but applies updated empirically derived thresholds as implemented for the EUMETSAT H SAF snow status product H11 {[}\hyperlink{cite.book/references:id3}{Pulliainen \sphinxstyleemphasis{et al.}, 2010}{]}. The brightness temperature difference between the Ku and Ka\sphinxhyphen{}band is used to estimate snow depth (SD) as
\begin{equation}\label{equation:book/baseline_algorithm_definition:TB_diff}
\begin{split}\text{SD} = R_c \cdot (T_B^{18H}-T_B^{37H}),\end{split}
\end{equation}
\sphinxAtStartPar
with regression coefficient \(R_c\) of 1.59 cm/K and brightness temperatures \(T_B\), where the superscripts indicate the frequency and polarisation.
For the algorithm in \eqref{equation:book/baseline_algorithm_definition:TB_diff} to detect dry snow, the following thresholds must be met:
\begin{equation}\label{equation:book/baseline_algorithm_definition:TB_thresholds}
\begin{split}\begin{aligned}
\text{SD} &≥ 3.0~\text{cm}\\
T_B^{37V} &< 255~\text{K}\\
T_B^{37H} &< 250~\text{K}.
\end{aligned}\end{split}
\end{equation}
\sphinxAtStartPar
The conditions in \eqref{equation:book/baseline_algorithm_definition:TB_diff} and \eqref{equation:book/baseline_algorithm_definition:TB_thresholds} are applied separately to TBs from forward and backward scans.


\subsubsection{Input data}
\label{\detokenize{book/baseline_algorithm_definition:input-data}}
\sphinxAtStartPar
After resampling to Ka\sphinxhyphen{}band as target, both the forward and backward\sphinxhyphen{}looking data of the following brightness temperatures are used as input:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Ku\sphinxhyphen{}band TBs (horizontal polarisation)

\item {} 
\sphinxAtStartPar
Ku\sphinxhyphen{}band TBs (horizontal and vertical polarisation)

\end{itemize}


\subsubsection{Output data}
\label{\detokenize{book/baseline_algorithm_definition:output-data}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Binary TSA maps, one for each scan direction (forward and backward).

\end{itemize}


\subsection{Combined Reprojection}
\label{\detokenize{book/baseline_algorithm_definition:combined-reprojection}}

\subsubsection{Description}
\label{\detokenize{book/baseline_algorithm_definition:description}}
\sphinxAtStartPar
The preceeding dry snow detection step is applied to resampled swath brightness temperatures of both scan directions.
The forward and backward TSA maps in swath format are each individually reprojected to the {\hyperref[\detokenize{book/acronyms:term-EASE-Grid}]{\sphinxtermref{\DUrole{xref,std,std-term}{EASE\sphinxhyphen{}Grid}}}} 2.0 {\hyperref[\detokenize{book/acronyms:term-NH}]{\sphinxtermref{\DUrole{xref,std,std-term}{NH}}}}, and subsequently combined into a single map.
When combining the binary TSA maps, all snow pixels are retained in order to counteract the tendency of passive microwave approaches to underestimate TSA.
In other words, snow is flagged when at least one scan direction detects snow.


\subsubsection{Input data}
\label{\detokenize{book/baseline_algorithm_definition:id7}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Binary TSA maps, one for each scan direction (forward and backward).

\end{itemize}


\subsubsection{Output data}
\label{\detokenize{book/baseline_algorithm_definition:id8}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Gridded binary TSA maps, one for each scan direction (forward and backward).

\item {} 
\sphinxAtStartPar
Gridded combined binary TSA map

\end{itemize}


\subsection{Masking and Flagging}
\label{\detokenize{book/baseline_algorithm_definition:masking-and-flagging}}

\subsubsection{Description}
\label{\detokenize{book/baseline_algorithm_definition:id9}}
\sphinxAtStartPar
Although masking and flagging are not strictly necessary to retrieve TSA, this step provides relevant complementary information.
Generally, flagging is preferred over masking with the reasoning that users can later individually tailor the daily TSA map to their needs.

\sphinxAtStartPar
The TSA Uncertainty Flag in its current form is based on the gridded forward ({\hyperref[\detokenize{book/acronyms:term-FWD}]{\sphinxtermref{\DUrole{xref,std,std-term}{FWD}}}}) and backward ({\hyperref[\detokenize{book/acronyms:term-BCK}]{\sphinxtermref{\DUrole{xref,std,std-term}{BCK}}}}) TSA maps.
Grid cells which see detected snow for both scans (FWD \& BCK) are flagged as ‘very likely snow covered’, whereas detected snow for one scan only (FWD | BCK) are set to ‘likely snow covered’.
If no snow is detected for both scans (FWD \& BCK), the flag reads ‘very likely snow free’.
The Status Flag contains information for each grid cell whether its spatial location corresponds to open water, land, or snow\sphinxhyphen{}covered land (valid dry snow), and indicates cells with missing data or out of grid.


\subsubsection{Input data}
\label{\detokenize{book/baseline_algorithm_definition:id10}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Gridded binary TSA maps, one for each scan direction (forward and backward).

\item {} 
\sphinxAtStartPar
Gridded combined binary TSA map

\item {} 
\sphinxAtStartPar
Land and water mask

\end{itemize}


\subsubsection{Output data}
\label{\detokenize{book/baseline_algorithm_definition:id11}}\begin{itemize}
\item {} 
\sphinxAtStartPar
TSA Uncertainty Flag

\item {} 
\sphinxAtStartPar
Status Flag

\end{itemize}


\subsubsection{Auxiliary data}
\label{\detokenize{book/baseline_algorithm_definition:auxiliary-data}}
\sphinxAtStartPar
For future releases, auxiliary data may be included for more comprehensive masking and flagging.
Information on freshwater lakes could be considered in order to mask or flag grid cells that likely experience water spill\sphinxhyphen{}over effects, for instance along coastal areas or in proximity to large water bodies.
Grid cells with surface water fractions larger than about 50\% could accordingly be flagged.
Besides, the qualitative TSA uncertainty estimates could further draw upon threshold error margins of \eqref{equation:book/baseline_algorithm_definition:TB_diff} and \eqref{equation:book/baseline_algorithm_definition:TB_thresholds}, brightness temperature uncertainties and Noise Equivalent Delta Temperatures (NE\(\Delta\)T) for Ku and Ka\sphinxhyphen{}band brightness temperatures, as well as regional and seasonal snow likelihoods.


\subsubsection{Ancillary data}
\label{\detokenize{book/baseline_algorithm_definition:ancillary-data}}
\sphinxAtStartPar
The masking of regions which historically do not experience snow cover according to a snow climatology may be part of future R\&D activities.
Such ancillary data could further compliment TSA uncertainty estimates.


\subsubsection{Validation process}
\label{\detokenize{book/baseline_algorithm_definition:validation-process}}
\sphinxAtStartPar
N/a

\sphinxstepscope


\chapter{Algorithm Input and Output Data Definition (IODD)}
\label{\detokenize{book/algorithm_input_output_data_definition:algorithm-input-and-output-data-definition-iodd}}\label{\detokenize{book/algorithm_input_output_data_definition::doc}}
\sphinxAtStartPar
Except for the input L1b {\hyperref[\detokenize{book/acronyms:term-TB}]{\sphinxtermref{\DUrole{xref,std,std-term}{TB}}}} data, all auxiliary and output data follow the {\hyperref[\detokenize{book/acronyms:term-EASE-Grid}]{\sphinxtermref{\DUrole{xref,std,std-term}{EASE\sphinxhyphen{}Grid}}}} 2.0 polar projection of the Northern Hemisphere.
The current target spatial resolution for regridding is 3.125km.


\section{Input data}
\label{\detokenize{book/algorithm_input_output_data_definition:input-data}}
\sphinxAtStartPar
Daily Level\sphinxhyphen{}2 brightness temperature data are the main input, namely Ku\sphinxhyphen{}band data of horizontal polarisation and Ka\sphinxhyphen{}band data of both polarisations.

\begin{sphinxadmonition}{important}{Important:}
\sphinxAtStartPar
If available, night or morning acquisition times are preferred over afternoon or evening brightness temperature data, in order to minimise effects of liquid water within the snowpack due to melt.
\end{sphinxadmonition}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Field
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Shape/Amount
\\
\hline
\sphinxAtStartPar
L1b TB Ku\sphinxhyphen{}band  
&
\sphinxAtStartPar
L1B Brightness Temperatures at 18.7 GHZ  (H polarisation)
&
\sphinxAtStartPar
Full swath or swath section  (Nscans,Npos)
\\
\hline
\sphinxAtStartPar
L1b TB Ka\sphinxhyphen{}band  
&
\sphinxAtStartPar
L1B Brightness Temperatures at 36.5 GHZ  (H and V polarisation)
&
\sphinxAtStartPar
Full swath or swath section  (Nscans,Npos)
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\section{Output data}
\label{\detokenize{book/algorithm_input_output_data_definition:output-data}}

\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Field
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Shape/Amount
\\
\hline
\sphinxAtStartPar
TSA
&
\sphinxAtStartPar
Terrestrial Snow Area (TSA)
&
\sphinxAtStartPar
EASE\sphinxhyphen{}Grid 2.0 NH  (nx,ny)
\\
\hline
\sphinxAtStartPar
TSA Uncertainty
&
\sphinxAtStartPar
Qualitative uncertainty of TSA variable:  ‘0: very likely snow\sphinxhyphen{}free (FWD \& BCK); 1: likely snow (FWD
&
\sphinxAtStartPar
BCK); 2: very likely snow (FWD \& BCK)’
\\
\hline
\sphinxAtStartPar
Status Flag  
&
\sphinxAtStartPar
Status flag for TSA
&
\sphinxAtStartPar
EASE\sphinxhyphen{}Grid 2.0 NH  (nx,ny)
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
The main TSA variable (\sphinxcode{\sphinxupquote{tsa}}) is a binary mask indicating snow\sphinxhyphen{}free pixels as \sphinxcode{\sphinxupquote{0}}, and snow\sphinxhyphen{}covered pixels as \sphinxcode{\sphinxupquote{1}}.
The TSA uncertainty (\sphinxcode{\sphinxupquote{tsa\_uncertainty}}) in turn is described through an 8\sphinxhyphen{}bit mask with the following allocated values:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Bit
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
Very likely snow free
\\
\hline
\sphinxAtStartPar
1
&
\sphinxAtStartPar
Likely snow covered
\\
\hline
\sphinxAtStartPar
2
&
\sphinxAtStartPar
Very likely snow covered
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
The status flag (\sphinxcode{\sphinxupquote{status\_flag}}) similarly is an 8\sphinxhyphen{}bit mask with the following allocated values:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Bit
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
0
&
\sphinxAtStartPar
Water
\\
\hline
\sphinxAtStartPar
1
&
\sphinxAtStartPar
Land
\\
\hline
\sphinxAtStartPar
2
&
\sphinxAtStartPar
Dry snow (valid)
\\
\hline
\sphinxAtStartPar
3\sphinxhyphen{}7
&
\sphinxAtStartPar
Placeholders
\\
\hline
\sphinxAtStartPar
8
&
\sphinxAtStartPar
No data, out of grid
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
Empty placeholders within the status flag may be used for future R\&D activities, such as the development of a wet snow flag.
\end{sphinxadmonition}


\section{Auxiliary data}
\label{\detokenize{book/algorithm_input_output_data_definition:auxiliary-data}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Land and water mask
Although the application of auxiliary data is not required to run the TSA algorithm per se, it is highly recommended to mask out known large water bodies thereby ensuring satisfactory product quality.

\end{itemize}


\section{Ancillary data}
\label{\detokenize{book/algorithm_input_output_data_definition:ancillary-data}}
\sphinxAtStartPar
N/a

\sphinxstepscope


\chapter{Algorithm Performance Assessment}
\label{\detokenize{book/algorithm_performance_assessment:algorithm-performance-assessment}}\label{\detokenize{book/algorithm_performance_assessment::doc}}
\sphinxAtStartPar
The following performance assessment of the CIMR L2 TSA algorithm focuses predominantly on the radiometric scene of the Demonstration Reference Scenario.


\sphinxstrong{See also:}
\nopagebreak


\sphinxAtStartPar
Refer \DUrole{xref,myst}{here} for a demonstration of the TSA algorithm for the SCEPS Polar Scene.




\section{L1 E2ES Demonstration Reference Scenario (Picasso) scene definition}
\label{\detokenize{book/algorithm_performance_assessment:l1-e2es-demonstration-reference-scenario-picasso-scene-definition}}
\sphinxAtStartPar
The Demonstration Reference Scenario consists of two scenes, highlighting radiometric and geometric properties, respectively.
Each scene encorporates up to 8 different surface types, including sea ice (first and multi\sphinxhyphen{}year ice), land (snow\sphinxhyphen{}free and snow\sphinxhyphen{}covered), and open ocean (four states of varying sea surface temperature and salinity).
Each surface condition has allocated a representative {\hyperref[\detokenize{book/acronyms:term-TB}]{\sphinxtermref{\DUrole{xref,std,std-term}{TB}}}} for each {\hyperref[\detokenize{book/acronyms:term-CIMR}]{\sphinxtermref{\DUrole{xref,std,std-term}{CIMR}}}} channel and polarisation, with the land TBs being provided in \hyperref[\detokenize{book/algorithm_performance_assessment:picasso-tb}]{Table \ref{\detokenize{book/algorithm_performance_assessment:picasso-tb}}}.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Brightness temperatures of horizontal and vertical polarization for snow\sphinxhyphen{}free and snow\sphinxhyphen{}covered land.}\label{\detokenize{book/algorithm_performance_assessment:picasso-tb}}
\sphinxaftertopcaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
 
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Snow\sphinxhyphen{}covered
&\sphinxstyletheadfamily 
\sphinxAtStartPar
TB h\sphinxhyphen{}pol (K)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
TB v\sphinxhyphen{}pol (K)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Snow\sphinxhyphen{}free
&\sphinxstyletheadfamily 
\sphinxAtStartPar
TB h\sphinxhyphen{}pol (K)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
TB v\sphinxhyphen{}pol (K)
\\
\hline
\sphinxAtStartPar
L  (1.4GHz)
&
\sphinxAtStartPar
 
&
\sphinxAtStartPar
229
&
\sphinxAtStartPar
247
&
\sphinxAtStartPar

&
\sphinxAtStartPar
240
&
\sphinxAtStartPar
262
\\
\hline
\sphinxAtStartPar
C  (6.9GHz)
&
\sphinxAtStartPar
 
&
\sphinxAtStartPar
239
&
\sphinxAtStartPar
257
&
\sphinxAtStartPar

&
\sphinxAtStartPar
248
&
\sphinxAtStartPar
252
\\
\hline
\sphinxAtStartPar
X  (10.9GHz)
&
\sphinxAtStartPar
 
&
\sphinxAtStartPar
248
&
\sphinxAtStartPar
261
&
\sphinxAtStartPar

&
\sphinxAtStartPar
247
&
\sphinxAtStartPar
251
\\
\hline
\sphinxAtStartPar
Ku (18.7GHz)
&
\sphinxAtStartPar
 
&
\sphinxAtStartPar
261
&
\sphinxAtStartPar
266
&
\sphinxAtStartPar

&
\sphinxAtStartPar
248
&
\sphinxAtStartPar
260
\\
\hline
\sphinxAtStartPar
Ka (36.5GHz)
&
\sphinxAtStartPar
 
&
\sphinxAtStartPar
259
&
\sphinxAtStartPar
262
&
\sphinxAtStartPar

&
\sphinxAtStartPar
245
&
\sphinxAtStartPar
240
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
In the radiometric scene, all surface types are placed adjacent to each other to artificially construct all possible boundary transitions, whilst also providing sea ice concentration sub\sphinxhyphen{}resolution gradients (see \hyperref[\detokenize{book/algorithm_performance_assessment:picasso-scene}]{Fig.\@ \ref{\detokenize{book/algorithm_performance_assessment:picasso-scene}}}, left).
The geometric scene, on the other hand, features high\sphinxhyphen{}contrast brightness temperature patterns for ocean parameters (see \hyperref[\detokenize{book/algorithm_performance_assessment:picasso-scene}]{Fig.\@ \ref{\detokenize{book/algorithm_performance_assessment:picasso-scene}}}, right).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{picasso-scene}.png}
\caption{Demonstration Reference Scenario (Picasso) including a radiometric scene (left) and a geometric scene (right).}\label{\detokenize{book/algorithm_performance_assessment:picasso-scene}}\end{figure}


\section{Algorithm Performance Metrics (MPEF)}
\label{\detokenize{book/algorithm_performance_assessment:algorithm-performance-metrics-mpef}}
\sphinxAtStartPar
The performance of the binary TSA algorithm is evaluated by means of a confusion matrix set\sphinxhyphen{}up.
For this, TSA estimates are divided into true positive ({\hyperref[\detokenize{book/acronyms:term-TP}]{\sphinxtermref{\DUrole{xref,std,std-term}{TP}}}}), false positive ({\hyperref[\detokenize{book/acronyms:term-FP}]{\sphinxtermref{\DUrole{xref,std,std-term}{FP}}}}), true negative ({\hyperref[\detokenize{book/acronyms:term-TN}]{\sphinxtermref{\DUrole{xref,std,std-term}{TN}}}}) and false negative ({\hyperref[\detokenize{book/acronyms:term-FN}]{\sphinxtermref{\DUrole{xref,std,std-term}{FN}}}}) observations.
Those observation classes are used to calculate the classification accuracy per scene:
\begin{equation}\label{equation:book/algorithm_performance_assessment:accuracy}
\begin{split}\text{accuracy} = \frac{\text{TP}+\text{TN}}{\text{TP}+\text{FP}+\text{TN}+\text{FN}}.\end{split}
\end{equation}
\sphinxAtStartPar
The evaluation addresses the main TSA product incorporating TB data from forward and backward scans.
Metrics are further computed separately for the forward and the backward scan to demonstrate the concept’s suitability.


\section{Algorithm Calibration Data Set (ACDAT)}
\label{\detokenize{book/algorithm_performance_assessment:algorithm-calibration-data-set-acdat}}
\sphinxAtStartPar
N/a


\section{Algorithm Validation Data Set (AVDAT)}
\label{\detokenize{book/algorithm_performance_assessment:algorithm-validation-data-set-avdat}}
\sphinxAtStartPar
N/a


\section{Test Results using Demonstration Reference Scenario}
\label{\detokenize{book/algorithm_performance_assessment:test-results-using-demonstration-reference-scenario}}
\sphinxAtStartPar
The algorithm performance assessment for the radiometric scene as well as the algorithm demonstration for the geometric scene follow the overall procedure:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Definition of the Coordinate Reference System ({\hyperref[\detokenize{book/acronyms:term-CRS}]{\sphinxtermref{\DUrole{xref,std,std-term}{CRS}}}})

\item {} 
\sphinxAtStartPar
Loading and visualisation of the scene’s ground truth

\item {} 
\sphinxAtStartPar
Read in TB data collocated to the Ka\sphinxhyphen{}band channel

\item {} 
\sphinxAtStartPar
Run the TSA algorithm incl. reprojection to the CRS

\end{itemize}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}
\begin{sphinxuseclass}{tag_remove-output}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
For the performance assessment, the {\hyperref[\detokenize{book/acronyms:term-CRS}]{\sphinxtermref{\DUrole{xref,std,std-term}{CRS}}}} corresponds to the native grid of the Demonstration Reference Scenario, namely EASE\sphinxhyphen{}Grid 2.0 polar projection of the Northern Hemisphere with a spatial resolution of 1km.
Outputs of the TSA algorithm are reprojected to this grid for a comparison with the test card ground truth.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{l2\PYGZus{}grid} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ease2\PYGZhy{}1.0km\PYGZhy{}testcard}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{area\PYGZus{}def} \PYG{o}{=} \PYG{n}{pr}\PYG{o}{.}\PYG{n}{load\PYGZus{}area}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../algorithm/ease2\PYGZus{}adef.yaml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{l2\PYGZus{}grid}\PYG{p}{)}

\PYG{n}{cart\PYGZus{}crs} \PYG{o}{=} \PYG{n}{area\PYGZus{}def}\PYG{o}{.}\PYG{n}{to\PYGZus{}cartopy\PYGZus{}crs}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{trg\PYGZus{}lon}\PYG{p}{,} \PYG{n}{trg\PYGZus{}lat} \PYG{o}{=} \PYG{n}{area\PYGZus{}def}\PYG{o}{.}\PYG{n}{get\PYGZus{}lonlats}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\subsection{Radiometric Demonstration Reference Scenario}
\label{\detokenize{book/algorithm_performance_assessment:radiometric-demonstration-reference-scenario}}
\sphinxAtStartPar
The snow cover conditions in the radiometric scene simulate an established snowpack of sufficient snow depth and snow density to cause noticeable volume scattering effects for Ka\sphinxhyphen{}band brightness temperatures.
Challenging conditions such as shallow or wet snow are not represented, nor are complex terrain or lake ice.
Therefore, the results should be interpreted as optimistic.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} load ground truth of test card}
\PYG{n}{test\PYGZus{}card\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{devalgo\PYGZus{}radiometric}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{dem\PYGZus{}ref\PYGZus{}scene} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{abspath}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../../..../}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Data/Test\PYGZus{}scenes\PYGZus{}downscaled\PYGZus{}projected/test\PYGZus{}scene\PYGZus{}1\PYGZus{}compressed\PYGZus{}lowres.nc}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{data\PYGZus{}rad} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{open\PYGZus{}dataset}\PYG{p}{(}\PYG{n}{dem\PYGZus{}ref\PYGZus{}scene}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} mirror ground truth on x\PYGZhy{}axis}
\PYG{n}{landmask\PYGZus{}rad} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{flip}\PYG{p}{(}\PYG{n}{data\PYGZus{}rad}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{landflag}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{surfaces\PYGZus{}rad} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{flip}\PYG{p}{(}\PYG{n}{data\PYGZus{}rad}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{surfaces}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{lon\PYGZus{}rad} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{flip}\PYG{p}{(}\PYG{n}{data\PYGZus{}rad}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Longitude}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{lat\PYGZus{}rad} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{flip}\PYG{p}{(}\PYG{n}{data\PYGZus{}rad}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Latitude}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{d1360049f704ce8fd8db604dcd8fb722eecd597154204acd83e725bb5b0c79bb}.png}

\noindent\sphinxincludegraphics{{83ab0be697ef99dc3b69e0d83d8c9823a770253e523177e2c835bcb30f4a7a79}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Testing:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{if} \PYG{n}{test\PYGZus{}card\PYGZus{}name} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{devalgo\PYGZus{}radiometric}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
    \PYG{n}{l1x} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{abspath}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../../..../}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Data/L1C Files/Radiometric/W\PYGZus{}PT\PYGZhy{}DME\PYGZhy{}Lisbon\PYGZhy{}SAT\PYGZhy{}CIMR\PYGZhy{}1X@KA\PYGZus{}C\PYGZus{}DME\PYGZus{}20230420T103323\PYGZus{}LD\PYGZus{}20280110T114800\PYGZus{}20280110T115700\PYGZus{}TN.nc}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{k}{elif} \PYG{n}{test\PYGZus{}card\PYGZus{}name} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{devalgo\PYGZus{}geometric}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
    \PYG{n}{l1x} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{abspath}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../../..../}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Data/L1C Files/Geometric/W\PYGZus{}PT\PYGZhy{}DME\PYGZhy{}Lisbon\PYGZhy{}SAT\PYGZhy{}CIMR\PYGZhy{}1X@KA\PYGZus{}C\PYGZus{}DME\PYGZus{}20230417T105425\PYGZus{}LD\PYGZus{}20280110T114800\PYGZus{}20280110T115700\PYGZus{}TN.nc}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{data\PYGZus{}fwd}\PYG{p}{,}\PYG{n}{geoloc\PYGZus{}fwd}\PYG{p}{,}\PYG{n}{data\PYGZus{}bck}\PYG{p}{,}\PYG{n}{geoloc\PYGZus{}bck} \PYG{o}{=} \PYG{n}{tools}\PYG{o}{.}\PYG{n}{read\PYGZus{}l1x}\PYG{p}{(}\PYG{n}{l1x}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} TSA algorithm}
\PYG{n}{algo} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Pulliainen2010}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{TSA\PYGZus{}fwd} \PYG{o}{=} \PYG{n}{algorithm}\PYG{o}{.}\PYG{n}{dry\PYGZus{}snow\PYGZus{}detection}\PYG{p}{(}\PYG{n}{data\PYGZus{}fwd}\PYG{p}{,}\PYG{n}{tsa\PYGZus{}algorithm}\PYG{o}{=}\PYG{n}{algo}\PYG{p}{)}
\PYG{n}{TSA\PYGZus{}bck} \PYG{o}{=} \PYG{n}{algorithm}\PYG{o}{.}\PYG{n}{dry\PYGZus{}snow\PYGZus{}detection}\PYG{p}{(}\PYG{n}{data\PYGZus{}bck}\PYG{p}{,}\PYG{n}{tsa\PYGZus{}algorithm}\PYG{o}{=}\PYG{n}{algo}\PYG{p}{)}

\PYG{n}{TSA\PYGZus{}fwd\PYGZus{}rad} \PYG{o}{=} \PYG{n}{tools}\PYG{o}{.}\PYG{n}{reproject\PYGZus{}to\PYGZus{}grid}\PYG{p}{(}\PYG{n}{TSA\PYGZus{}fwd}\PYG{p}{,}\PYG{n}{geoloc\PYGZus{}fwd}\PYG{p}{,}\PYG{n}{area\PYGZus{}def}\PYG{o}{=}\PYG{n}{area\PYGZus{}def}\PYG{p}{,}\PYG{n}{radius\PYGZus{}of\PYGZus{}influence}\PYG{o}{=}\PYG{l+m+mi}{5000}\PYG{p}{)}
\PYG{n}{TSA\PYGZus{}bck\PYGZus{}rad} \PYG{o}{=} \PYG{n}{tools}\PYG{o}{.}\PYG{n}{reproject\PYGZus{}to\PYGZus{}grid}\PYG{p}{(}\PYG{n}{TSA\PYGZus{}bck}\PYG{p}{,}\PYG{n}{geoloc\PYGZus{}bck}\PYG{p}{,}\PYG{n}{area\PYGZus{}def}\PYG{o}{=}\PYG{n}{area\PYGZus{}def}\PYG{p}{,}\PYG{n}{radius\PYGZus{}of\PYGZus{}influence}\PYG{o}{=}\PYG{l+m+mi}{5000}\PYG{p}{)}

\PYG{n}{TSA\PYGZus{}rad}\PYG{p}{,} \PYG{n}{TSA\PYGZus{}uncert\PYGZus{}rad} \PYG{o}{=} \PYG{n}{tools}\PYG{o}{.}\PYG{n}{combine\PYGZus{}proj}\PYG{p}{(}\PYG{n}{TSA\PYGZus{}fwd\PYGZus{}rad}\PYG{p}{,}\PYG{n}{TSA\PYGZus{}bck\PYGZus{}rad}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{cd1238cc318ad249873f60deabd5ecf07aae647e896924e885fefc83f99dc146}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Geometric Demonstration Reference Scenario}
\label{\detokenize{book/algorithm_performance_assessment:geometric-demonstration-reference-scenario}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} load ground truth of test card}
\PYG{n}{test\PYGZus{}card\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{devalgo\PYGZus{}geometric}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{dem\PYGZus{}ref\PYGZus{}scene} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{abspath}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../../..../}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Data/Test\PYGZus{}scenes\PYGZus{}downscaled\PYGZus{}projected/test\PYGZus{}scene\PYGZus{}2\PYGZus{}compressed\PYGZus{}lowres.nc}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{data\PYGZus{}geo} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{open\PYGZus{}dataset}\PYG{p}{(}\PYG{n}{dem\PYGZus{}ref\PYGZus{}scene}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} mirror ground truth on x\PYGZhy{}axis}
\PYG{c+c1}{\PYGZsh{} landmask\PYGZus{}geo = np.flip(data\PYGZus{}ref[\PYGZsq{}landflag\PYGZsq{}].values,0)}
\PYG{n}{surfaces\PYGZus{}geo} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{flip}\PYG{p}{(}\PYG{n}{data\PYGZus{}geo}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{surfaces}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{lon\PYGZus{}geo} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{flip}\PYG{p}{(}\PYG{n}{data\PYGZus{}geo}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Longitude}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{lat\PYGZus{}geo} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{flip}\PYG{p}{(}\PYG{n}{data\PYGZus{}geo}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Latitude}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{505bd09ccbc523f2612a26e364a5223abdd28ca3c1f7d06aaef0e152fc716e60}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Testing:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{if} \PYG{n}{test\PYGZus{}card\PYGZus{}name} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{devalgo\PYGZus{}radiometric}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
    \PYG{n}{l1x} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{abspath}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../../..../}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Data/L1C Files/Radiometric/W\PYGZus{}PT\PYGZhy{}DME\PYGZhy{}Lisbon\PYGZhy{}SAT\PYGZhy{}CIMR\PYGZhy{}1X@KA\PYGZus{}C\PYGZus{}DME\PYGZus{}20230420T103323\PYGZus{}LD\PYGZus{}20280110T114800\PYGZus{}20280110T115700\PYGZus{}TN.nc}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{k}{elif} \PYG{n}{test\PYGZus{}card\PYGZus{}name} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{devalgo\PYGZus{}geometric}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
    \PYG{n}{l1x} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{abspath}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../../..../}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Data/L1C Files/Geometric/W\PYGZus{}PT\PYGZhy{}DME\PYGZhy{}Lisbon\PYGZhy{}SAT\PYGZhy{}CIMR\PYGZhy{}1X@KA\PYGZus{}C\PYGZus{}DME\PYGZus{}20230417T105425\PYGZus{}LD\PYGZus{}20280110T114800\PYGZus{}20280110T115700\PYGZus{}TN.nc}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{data\PYGZus{}fwd}\PYG{p}{,}\PYG{n}{geoloc\PYGZus{}fwd}\PYG{p}{,}\PYG{n}{data\PYGZus{}bck}\PYG{p}{,}\PYG{n}{geoloc\PYGZus{}bck} \PYG{o}{=} \PYG{n}{tools}\PYG{o}{.}\PYG{n}{read\PYGZus{}l1x}\PYG{p}{(}\PYG{n}{l1x}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} TSA algorithm}
\PYG{n}{algo} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Pulliainen2010}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{TSA\PYGZus{}fwd} \PYG{o}{=} \PYG{n}{algorithm}\PYG{o}{.}\PYG{n}{dry\PYGZus{}snow\PYGZus{}detection}\PYG{p}{(}\PYG{n}{data\PYGZus{}fwd}\PYG{p}{,}\PYG{n}{tsa\PYGZus{}algorithm}\PYG{o}{=}\PYG{n}{algo}\PYG{p}{)}
\PYG{n}{TSA\PYGZus{}bck} \PYG{o}{=} \PYG{n}{algorithm}\PYG{o}{.}\PYG{n}{dry\PYGZus{}snow\PYGZus{}detection}\PYG{p}{(}\PYG{n}{data\PYGZus{}bck}\PYG{p}{,}\PYG{n}{tsa\PYGZus{}algorithm}\PYG{o}{=}\PYG{n}{algo}\PYG{p}{)}

\PYG{n}{TSA\PYGZus{}fwd\PYGZus{}geo} \PYG{o}{=} \PYG{n}{tools}\PYG{o}{.}\PYG{n}{reproject\PYGZus{}to\PYGZus{}grid}\PYG{p}{(}\PYG{n}{TSA\PYGZus{}fwd}\PYG{p}{,}\PYG{n}{geoloc\PYGZus{}fwd}\PYG{p}{,}\PYG{n}{area\PYGZus{}def}\PYG{o}{=}\PYG{n}{area\PYGZus{}def}\PYG{p}{,}\PYG{n}{radius\PYGZus{}of\PYGZus{}influence}\PYG{o}{=}\PYG{l+m+mi}{5000}\PYG{p}{)}
\PYG{n}{TSA\PYGZus{}bck\PYGZus{}geo} \PYG{o}{=} \PYG{n}{tools}\PYG{o}{.}\PYG{n}{reproject\PYGZus{}to\PYGZus{}grid}\PYG{p}{(}\PYG{n}{TSA\PYGZus{}bck}\PYG{p}{,}\PYG{n}{geoloc\PYGZus{}bck}\PYG{p}{,}\PYG{n}{area\PYGZus{}def}\PYG{o}{=}\PYG{n}{area\PYGZus{}def}\PYG{p}{,}\PYG{n}{radius\PYGZus{}of\PYGZus{}influence}\PYG{o}{=}\PYG{l+m+mi}{5000}\PYG{p}{)}

\PYG{n}{TSA\PYGZus{}geo}\PYG{p}{,} \PYG{n}{TSA\PYGZus{}uncert\PYGZus{}geo} \PYG{o}{=} \PYG{n}{tools}\PYG{o}{.}\PYG{n}{combine\PYGZus{}proj}\PYG{p}{(}\PYG{n}{TSA\PYGZus{}fwd\PYGZus{}geo}\PYG{p}{,}\PYG{n}{TSA\PYGZus{}bck\PYGZus{}geo}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{5a2fe3c1c8cbff6ae11f7b70bae3ca977f0cc76f2a4f0faa99ba0fa0a553314d}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}

\section{Algorithm Performance Assessment using Demonstration Reference Scenario}
\label{\detokenize{book/algorithm_performance_assessment:algorithm-performance-assessment-using-demonstration-reference-scenario}}
\sphinxAtStartPar
The core of the performance assessment is conducted using the radiometric test card, as it covers snow\sphinxhyphen{}free as well as snow\sphinxhyphen{}covered land surfaces.
The performance metrics are computed for the standard TSA algorithm combining forward and backward scan data, as well as for individual scans.
Note that the choice of reprojection parameters introduces an uncertainty in the evaluation metrics of about \(\pm\)3\%.

\sphinxAtStartPar
Forward and backward scan:

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{TSA\PYGZus{}rad\PYGZus{}diff} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{TSA\PYGZus{}rad}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{)}
\PYG{n}{TSA\PYGZus{}rad\PYGZus{}diff}\PYG{p}{[}\PYG{n}{TSA\PYGZus{}rad\PYGZus{}diff} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{nan}

\PYG{n}{TSA\PYGZus{}rad\PYGZus{}diff}\PYG{p}{[}\PYG{p}{(}\PYG{n}{surfaces\PYGZus{}rad} \PYG{o}{==} \PYG{l+m+mi}{3}\PYG{p}{)} \PYG{o}{\PYGZam{}} \PYG{p}{(}\PYG{n}{TSA\PYGZus{}rad} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{]} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}  \PYG{c+c1}{\PYGZsh{} FN}
\PYG{n}{TSA\PYGZus{}rad\PYGZus{}diff}\PYG{p}{[}\PYG{p}{(}\PYG{n}{surfaces\PYGZus{}rad} \PYG{o}{==} \PYG{l+m+mi}{3}\PYG{p}{)} \PYG{o}{\PYGZam{}} \PYG{p}{(}\PYG{n}{TSA\PYGZus{}rad} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{0}   \PYG{c+c1}{\PYGZsh{} TP}
\PYG{n}{TSA\PYGZus{}rad\PYGZus{}diff}\PYG{p}{[}\PYG{p}{(}\PYG{n}{surfaces\PYGZus{}rad} \PYG{o}{==} \PYG{l+m+mi}{4}\PYG{p}{)} \PYG{o}{\PYGZam{}} \PYG{p}{(}\PYG{n}{TSA\PYGZus{}rad} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{1}   \PYG{c+c1}{\PYGZsh{} TN}
\PYG{n}{TSA\PYGZus{}rad\PYGZus{}diff}\PYG{p}{[}\PYG{p}{(}\PYG{n}{surfaces\PYGZus{}rad} \PYG{o}{==} \PYG{l+m+mi}{4}\PYG{p}{)} \PYG{o}{\PYGZam{}} \PYG{p}{(}\PYG{n}{TSA\PYGZus{}rad} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{2}   \PYG{c+c1}{\PYGZsh{} FP}
\PYG{n}{TSA\PYGZus{}rad\PYGZus{}diff}\PYG{p}{[}\PYG{n}{landmask\PYGZus{}rad} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}                               \PYG{c+c1}{\PYGZsh{} water}
\PYG{n}{TSA\PYGZus{}rad\PYGZus{}diff}\PYG{p}{[}\PYG{p}{(}\PYG{n}{surfaces\PYGZus{}rad} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{|} \PYG{p}{(}\PYG{n}{surfaces\PYGZus{}rad} \PYG{o}{==} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{]} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}       \PYG{c+c1}{\PYGZsh{} sea ice}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} count evaluated pixels}
\PYG{n}{unique}\PYG{p}{,} \PYG{n}{counts} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{TSA\PYGZus{}rad\PYGZus{}diff}\PYG{p}{,} \PYG{n}{return\PYGZus{}counts}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} print(dict(zip(unique,counts)))}
\PYG{n}{fn} \PYG{o}{=} \PYG{n}{counts}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}              \PYG{c+c1}{\PYGZsh{} \PYGZhy{}1: FN}
\PYG{n}{tp} \PYG{o}{=} \PYG{n}{counts}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}              \PYG{c+c1}{\PYGZsh{}  0: TP}
\PYG{n}{tn} \PYG{o}{=} \PYG{n}{counts}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{]}              \PYG{c+c1}{\PYGZsh{}  1: TN}
\PYG{n}{fp} \PYG{o}{=} \PYG{n}{counts}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{]}              \PYG{c+c1}{\PYGZsh{}  2: FP}
\PYG{n}{total} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{counts}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{p}{]}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} ignore water and sea ice for total count}

\PYG{n}{acc} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{tp}\PYG{o}{+}\PYG{n}{tn}\PYG{p}{)}\PYG{o}{/}\PYG{n}{total}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Accuracy:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZpc{}.5f}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{\PYGZpc{}} \PYG{n}{acc}\PYG{p}{)}
\PYG{n}{tpr} \PYG{o}{=} \PYG{n}{tp}\PYG{o}{/}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{tp}\PYG{o}{+}\PYG{n}{fn}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TP rate: }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZpc{}.5f}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{\PYGZpc{}} \PYG{n}{tpr}\PYG{p}{)}
\PYG{n}{tnr} \PYG{o}{=} \PYG{n}{tn}\PYG{o}{/}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{tn}\PYG{o}{+}\PYG{n}{fp}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TN rate: }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZpc{}.5f}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{\PYGZpc{}} \PYG{n}{tnr}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Accuracy: 0.95989
TP rate:  0.95590
TN rate:  0.96387
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_remove-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Confusion Matrix
TP =  134897  |  FP =  5099
FN =  6223    |  TN =  136021
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
The tendency to underestimate snow presence is reflected by the true negative rate which is higher than the true positive rate.
For the given test card grid, the TSA algorithm detects a snow cover extent of 134,897km$^{\text{2}}$ out of the ground truth of 141,120km$^{\text{2}}$.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{456cc8d2712e4df4d6908adde1d5e2e9ff97422b8c8db0c4c35055a844882836}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
For the forward scan, the following metrics are obtained:

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Accuracy: 0.95212
TP rate:  0.92301
TN rate:  0.98124
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
For the backward scan, the following metrics are obtained:

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Accuracy: 0.94831
TP rate:  0.91927
TN rate:  0.97735
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Both the accuracy and the TP rate are higher for the TSA product when using combined rather than individual scans.
Passive microwave snow detection approaches commonly underestimate snow cover area, which can be counteracted when incorporating both scan directions.


\section{Summary}
\label{\detokenize{book/algorithm_performance_assessment:summary}}
\sphinxAtStartPar
An initial performance assessment of the CIMR L2 TSA algorithm is conducted using primarily the radiometric scene of the Demonstration Reference Scenario (Picasso).
The radiometric scene contains two land surface types: snow\sphinxhyphen{}free and snow\sphinxhyphen{}covered ground.
Note that distinct bare ground as well as established snowpacks are represented, while more challenging conditions such as shallow or wet snow, complex terrain, dense vegetation, and lake ice are not considered.
Due to this idealistic nature of the artificial scene, high algorithm performance is to be expected.
Indeed, the TSA algorithm achieves an accuracy of 95.99\% together with a true positive rate of 95.59\% and a true negative rate of 96.39\%.

\sphinxAtStartPar
The metrics, however, still reflect the common tendency of passive microwave snow detection methodologies to underestimate snow cover area, as the true negative rate is larger than the true positive rate.
False negative pixels, i.e. pixels affected by underestimation are predominantly found in proximity to land\sphinxhyphen{}water boundaries.
Although more dependent on different sea and sea ice conditions, false positive pixels representing overestimation similarly form elongated clusters along ‘coastlines’.
Even this simple test scene therefore emphasises the need for water spill\sphinxhyphen{}over corrections.

\sphinxAtStartPar
Despite their simplicity, both scenes of the Demonstration Reference Scenario provide insights into the utility of CIMR’s scanning geometry.
In case of the radiometric scene, combining snow area estimates from both forward and backward\sphinxhyphen{}looking brightness temperatures proves beneficial.
The overall algorithm performance is better when compared to snow area estimates from only one look direction.
This supports the current approach of combining snow area estimates after separate processing of forward and backward scans.
In case of the geometric scene, land surface types are not included.
Nevertheless, the high\sphinxhyphen{}contrast brightness temperature patterns happen to provide a visualisation of the implemented TSA uncertainty flag, highlighting its behaviour and utility along sharp borders and transitions.
Both aspects encourage the partition of CIMR brightness temperatures depending on look direction.

\sphinxAtStartPar
In contrast to the Demonstration Reference Scenario, more realistic conditions are found in the SCEPS Polar Scene.
Yet when applying the TSA algorithm to said polar scene, barely any snow cover is detected over land.
The primary condition for snow cover to be detected relies on a depression in Ka\sphinxhyphen{}band brightness temperature of horizontal polarisation, due to volume scattering effects of snowpacks.
This is simply not met for the vast majority of the land area.
It is understood that sample emissivities might have been used for the simulation of land parts contained within the scene.
Those emissivities likely reflect glacial conditions, which would not result in volume scattering effects due to the continuous transition between snow, firn, and glacial ice.
Similarly, Ku\sphinxhyphen{}band brightness temperatures serve as scatter\sphinxhyphen{}free reference which relies on a clear interface between the snowpack and the subnivean substrate.
Terrestrial snow detection approaches are hence not applicable over glaciers and ice caps.

\sphinxAtStartPar
Overall, the performance of the TSA algorithm is successfully demonstrated for the different test scenarios.
Even though synthetic data naturally cannot fully replace real data, the assessment provides a first proof of concept for the algorithm’s handling of forward and backward brightness temperatures in order to estimate snow area and its qualitative uncertainty.

\sphinxstepscope


\chapter{Roadmap for Future ATBD Development}
\label{\detokenize{book/roadmap:roadmap-for-future-atbd-development}}\label{\detokenize{book/roadmap::doc}}
\sphinxAtStartPar
Passive microwave snow detection algorithms are known to underestimate global snow cover area {[}\hyperlink{cite.book/references:id2}{Hall \sphinxstyleemphasis{et al.}, 2002}, \hyperlink{cite.book/references:id18}{Zschenderlein \sphinxstyleemphasis{et al.}, 2023}{]}.
They are sensitive to dry snowpacks with minimal water content, and hence struggle to capture wet snow areas due to fundamentally different radiometric properties {[}\hyperlink{cite.book/references:id13}{Mätzler, 1994}{]}.
To expand the capabilities of the Level\sphinxhyphen{}2 {\hyperref[\detokenize{book/acronyms:term-TSA}]{\sphinxtermref{\DUrole{xref,std,std-term}{TSA}}}} product to reliably map also wet snow, the operational implementation of a wet snow detection module should be investigated.
For this purpose, feasible approaches might incorporate diurnal amplitude variations (e.g. Semmens \sphinxstyleemphasis{et al.} {[}\hyperlink{cite.book/references:id10}{2014}{]}), L\sphinxhyphen{}band brightness temperatures of horizontal polarization {[}\hyperlink{cite.book/references:id26}{Pellarin \sphinxstyleemphasis{et al.}, 2016}, \hyperlink{cite.book/references:id25}{Rautiainen \sphinxstyleemphasis{et al.}, 2012}{]}, or numerical weather prediction ({\hyperref[\detokenize{book/acronyms:term-NWP}]{\sphinxtermref{\DUrole{xref,std,std-term}{NWP}}}}) temperature data {[}\hyperlink{cite.book/references:id24}{Tuttle and Jacobs, 2019}{]}.

\sphinxAtStartPar
Besides, the concept of the status flag as an indicator of uncertainty may be expanded and refined in the future.
For binary classifications as implemented within the TSA product, we lack a comprehensive quantitative and/or qualitative uncertainty characterization.
Further traceable uncertainty sources have to be identified in addition to the current components derived from {\hyperref[\detokenize{book/acronyms:term-TB}]{\sphinxtermref{\DUrole{xref,std,std-term}{TB}}}} data of different looking directions, including for instance the impact of brightness temperature measurement uncertainties on the snow detection results.
Moreover, land surface or air temperature data could enable same\sphinxhyphen{}day identification of meteorological conditions that make snow presence (un)likely, thereby supporting near real\sphinxhyphen{}time ({\hyperref[\detokenize{book/acronyms:term-NRT}]{\sphinxtermref{\DUrole{xref,std,std-term}{NRT}}}}) quality assurance.
Such temperature data would also allow for retrospective quality assessment of the TSA maps: Using temperature data of the whole snow season, an end\sphinxhyphen{}of\sphinxhyphen{}season quality flag could be generated which affirms or rules out snow cover based on the weather conditions across consecutive days.
Furthermore, the use of a snow climatology could be considered to restrict snow detection to geolocations that have historically experienced snow cover, e.g. Dewey and Heim {[}\hyperlink{cite.book/references:id20}{1982}{]} in Kelly {[}\hyperlink{cite.book/references:id12}{2009}{]}.
This would not only improve the TSA algorithm accuracy but would also provide likelihoods for snow presence in the spatial and temporal domain, which could again feed into the NRT quality flag.

\sphinxAtStartPar
As the performance assessment highlighted, brightness temperature correction for water contamination per footprint or per grid cell is desirable.
In the unfortunate case that such a correction is not provided for CIMR L1b/L1c data products, the TSA algorithm would benefit from open water filtering, masking or correction in order to improve snow mapping accuracy in proximity to coastlines and (unmasked) freshwater lakes.
Other product extensions could address the screening for precipitation and the detection of thin snow cover.
Both the additional scattering due to hydrometeors and the lesser scattering of thin snowpacks are known challenges to passive microwave dry snow detection {[}\hyperlink{cite.book/references:id13}{Mätzler, 1994}{]};
They have been previously addressed by means of brightness temperatures at 22 GHz and 85 GHz, which are sensitive to the respective scattering behaviours {[}\hyperlink{cite.book/references:id21}{Foster \sphinxstyleemphasis{et al.}, 2011}, \hyperlink{cite.book/references:id9}{Grody and Basist, 1996}{]}.
Since those channels are not available for CIMR, the TSA product could draw upon external satellite TBs although this would fall beyond the Level\sphinxhyphen{}2 status.

\sphinxAtStartPar
While the CIMR Level\sphinxhyphen{}2 TSA product is a stand\sphinxhyphen{}alone data product within the CIMR product suite, the development and implementation of the CIMR Level\sphinxhyphen{}2 Global Snow Water Equivalent ({\hyperref[\detokenize{book/acronyms:term-SWE}]{\sphinxtermref{\DUrole{xref,std,std-term}{SWE}}}}) product will be closely linked – directly incorporating the TSA output in its processing chain (compare e.g. {[}\hyperlink{cite.book/references:id22}{Luojus \sphinxstyleemphasis{et al.}, 2021}{]}).
Although the SWE retrieval itself will require noticeable development efforts, future improvement and development of the TSA algorithm and {\hyperref[\detokenize{book/acronyms:term-ATBD}]{\sphinxtermref{\DUrole{xref,std,std-term}{ATBD}}}} remain of high interest.

\sphinxstepscope


\chapter{References}
\label{\detokenize{book/references:references}}\label{\detokenize{book/references::doc}}
\sphinxstepscope


\chapter{Annex}
\label{\detokenize{book/annex:annex}}\label{\detokenize{book/annex::doc}}
\begin{sphinxthebibliography}{10}
\bibitem[1]{book/references:id11}
\sphinxAtStartPar
R. Armstrong and M. Brodzik. Recent Northern Hemisphere snow extent: a comparison of data derived from visible and microwave satellite sensors. \sphinxstyleemphasis{Geophysical Research Letters}, 28(19):3673–3676, 2001. \sphinxhref{https://doi.org/10.1029/2000GL012556}{doi:10.1029/2000GL012556}.
\bibitem[2]{book/references:id17}
\sphinxAtStartPar
M. Brodzik, B. Billingsley, T. Haran, B. Raup, and M. Savoie. EASE\sphinxhyphen{}Grid 2.0: Incremental but Significant Improvements for Earth\sphinxhyphen{}Gridded Data Sets. \sphinxstyleemphasis{ISPRS International Journal of Geo\sphinxhyphen{}Information}, 1(1):32–45, 2012. \sphinxhref{https://doi.org/10.3390/ijgi1010032}{doi:10.3390/ijgi1010032}.
\bibitem[3]{book/references:id7}
\sphinxAtStartPar
A. Chang, J. Foster, and D. Hall. Nimbus\sphinxhyphen{}7 SMMR derived global snow cover parameters. \sphinxstyleemphasis{Ann. Glaciol.}, 9:39–44, 1987. \sphinxhref{https://doi.org/10.3189/S0260305500200736}{doi:10.3189/S0260305500200736}.
\bibitem[4]{book/references:id23}
\sphinxAtStartPar
A. Chang, J. Foster, D. Hall, A. Rango, and B. Hartline. Snow water equivalent estimation by microwave radiometry. \sphinxstyleemphasis{Cold Regions Science and Technology}, 5(3):259–267, 1982. \sphinxhref{https://doi.org/10.1016/0165-232X(82)90019-2}{doi:10.1016/0165\sphinxhyphen{}232X(82)90019\sphinxhyphen{}2}.
\bibitem[5]{book/references:id20}
\sphinxAtStartPar
K. Dewey and R. Heim. A Digital Archive of Northern Hemisphere Snow Cover, November 1966 through December 1980. \sphinxstyleemphasis{Bulletin of the American Meteorological Society}, 63(10):1132–1141, 1982. \sphinxhref{https://doi.org/10.1175/1520-0477(1982)063<1132:ADAONH>2.0.CO;2}{doi:10.1175/1520\sphinxhyphen{}0477(1982)063<1132:ADAONH>2.0.CO;2}.
\bibitem[6]{book/references:id8}
\sphinxAtStartPar
J. Foster, A. Chang, and D. Hall. Comparison of snow mass estimates from a prototype passive microwave snow algorithm, a revised algorithm and a snow depth climatology. \sphinxstyleemphasis{Remote Sensing of Environment}, 62(2):132–142, 1997. \sphinxhref{https://doi.org/10.1016/S0034-4257(97)00085-0}{doi:10.1016/S0034\sphinxhyphen{}4257(97)00085\sphinxhyphen{}0}.
\bibitem[7]{book/references:id21}
\sphinxAtStartPar
J. Foster, D. Hall, J. Eylander, G. Riggs, S. Nghiem, M. Tedesco, E. Kim, P. Montesano, R. Kelly, K. Casey, and B. Choudhury. A blended global snow product using visible, passive microwave and scatterometer satellite data. \sphinxstyleemphasis{International Journal of Remote Sensing}, 32(5):1371–1395, 2011. \sphinxhref{https://doi.org/10.1080/01431160903548013}{doi:10.1080/01431160903548013}.
\bibitem[8]{book/references:id9}
\sphinxAtStartPar
N. Grody and A. Basist. Global identification of snowcover using SSM/I measurements. \sphinxstyleemphasis{IEEE Transactions on Geoscience and Remote Sensing}, 34(1):237–249, 1996. \sphinxhref{https://doi.org/10.1109/36.481908}{doi:10.1109/36.481908}.
\bibitem[9]{book/references:id2}
\sphinxAtStartPar
D. Hall, R. Kelly, G. Riggs, A. Chang, and J. Foster. Assessment of the relative accuracy of hemispheric\sphinxhyphen{}scale snow\sphinxhyphen{}cover maps. \sphinxstyleemphasis{Ann. Glaciol.}, 34:24–30, 2002. \sphinxhref{https://doi.org/10.3189/172756402781817770}{doi:10.3189/172756402781817770}.
\bibitem[10]{book/references:id12}
\sphinxAtStartPar
R. Kelly. The AMSR\sphinxhyphen{}E Snow Depth Algorithm: Description and Initial Results. \sphinxstyleemphasis{Journal of the Remote Sensing Society of Japan}, 29:307–17, 01 2009. \sphinxhref{https://doi.org/10.11440/rssj.29.307}{doi:10.11440/rssj.29.307}.
\bibitem[11]{book/references:id16}
\sphinxAtStartPar
R. Kelly, A. Chang, L. Tsang, and J. Foster. A prototype AMSR\sphinxhyphen{}E global snow area and snow depth algorithm. \sphinxstyleemphasis{IEEE Transactions on Geoscience and Remote Sensing}, 41(2):230–242, 2003. \sphinxhref{https://doi.org/10.1109/TGRS.2003.809118}{doi:10.1109/TGRS.2003.809118}.
\bibitem[12]{book/references:id22}
\sphinxAtStartPar
K. Luojus, J. Pulliainen, M. Takala, J. Lemmetyinen, C. Mortimer, C. Derksen, L. Mudryk, M. Moisander, M. Hiltunen, T. Smolander, J. Ikonen, J. Cohen, M. Salminen, J. Norberg, K. Veijola, and P. Venäläinen. GlobSnow v3.0 Northern Hemisphere snow water equivalent dataset. \sphinxstyleemphasis{Scientific Data}, 8(163):163, 2021. \sphinxhref{https://doi.org/10.1038/s41597-021-00939-2}{doi:10.1038/s41597\sphinxhyphen{}021\sphinxhyphen{}00939\sphinxhyphen{}2}.
\bibitem[13]{book/references:id13}
\sphinxAtStartPar
C. Mätzler. Passive microwave signatures of landscapes in winter. \sphinxstyleemphasis{Meteorology and Atmospheric Physics}, 54:241–260, 1994. \sphinxhref{https://doi.org/10.1007/BF01030063}{doi:10.1007/BF01030063}.
\bibitem[14]{book/references:id26}
\sphinxAtStartPar
T. Pellarin, A. Mialon, R. Biron, C. Coulaud, F. Gibon, Y. Kerr, M. Lafaysse, B. Mercier, S. Morin, I. Redor, M. Schwank, and I. Völksch. Three years of L\sphinxhyphen{}band brightness temperature measurements in a mountainous area: Topography, vegetation and snowmelt issues. \sphinxstyleemphasis{Remote Sensing of Environment}, 180:85–98, 2016. \sphinxhref{https://doi.org/10.1016/j.rse.2016.02.047}{doi:10.1016/j.rse.2016.02.047}.
\bibitem[15]{book/references:id3}
\sphinxAtStartPar
J. Pulliainen, P. Lahtinen, J. Kärnä, and S. Koponen. Algorithm Theoretical Definition Document (ATDD) for Product SN\sphinxhyphen{}OBS\sphinxhyphen{}2 \sphinxhyphen{} Snow Status (Dry/Wet) by Microwave Radiometry. Technical Report H11, EUMETSAT H\sphinxhyphen{}SAF, 2010.
\bibitem[16]{book/references:id6}
\sphinxAtStartPar
J. Pulliainen, K. Luojus, C. Derksen, L. Mudryk, J. Lemmetyinen, M. Salminen, J. Ikonen, M. Takala, J. Cohen, T. Smolander, and J. Norberg. Patterns and trends of Northern Hemisphere snow mass from 1980 to 2018. \sphinxstyleemphasis{Nature}, 581:294–298, 2020. \sphinxhref{https://doi.org/10.1038/s41586-020-2258-0}{doi:10.1038/s41586\sphinxhyphen{}020\sphinxhyphen{}2258\sphinxhyphen{}0}.
\bibitem[17]{book/references:id25}
\sphinxAtStartPar
K. Rautiainen, J. Lemmetyinen, J. Pulliainen, J. Vehviläinen, M. Drusch, A. Kontu, J. Kainulainen, and J. Seppänen. L\sphinxhyphen{}Band Radiometer Observations of Soil Processes in Boreal and Subarctic Environments. \sphinxstyleemphasis{IEEE Transactions on Geoscience and Remote Sensing}, 50(5):1483–1497, 2012. \sphinxhref{https://doi.org/10.1109/TGRS.2011.2167755}{doi:10.1109/TGRS.2011.2167755}.
\bibitem[18]{book/references:id14}
\sphinxAtStartPar
K. Rautiainen, J. Lemmetyinen, M. Schwank, A. Kontu, C. Ménard, C. Mätzler, M. Drusch, A. Wiesmann, J. Ikonen, and J. Pulliainen. Detection of soil freezing from L\sphinxhyphen{}band passive microwave observations. \sphinxstyleemphasis{Remote Sensing of Environment}, 147:206–218, 2014. \sphinxhref{https://doi.org/10.1016/j.rse.2014.03.007}{doi:10.1016/j.rse.2014.03.007}.
\bibitem[19]{book/references:id5}
\sphinxAtStartPar
W. Rees. \sphinxstyleemphasis{Remote Sensing of Snow and Ice}. CRC Press, 2005. \sphinxhref{https://doi.org/10.1201/9781420023749}{doi:10.1201/9781420023749}.
\bibitem[20]{book/references:id10}
\sphinxAtStartPar
Kathryn Semmens, Joan Ramage, Jeremy Apgar, Katrina Bennett, Glen Liston, and Elias Deeb. Passive Microwave Remote Sensing of Snowmelt and Melt‐Refreeze Using Diurnal Amplitude Variations. In \sphinxstyleemphasis{Geophysical Monograph Series}, pages 215–226. Wiley, 1 edition, 2014. \sphinxhref{https://doi.org/10.1002/9781118872086.ch13}{doi:10.1002/9781118872086.ch13}.
\bibitem[21]{book/references:id19}
\sphinxAtStartPar
M. Takala, K. Luojus, J. Pulliainen, C. Derksen, J. Lemmetyinen, J. Kärnä, J. Koskinen, and B. Bojkov. Estimating northern hemisphere snow water equivalent for climate research through assimilation of space\sphinxhyphen{}borne radiometer data and ground\sphinxhyphen{}based measurements. \sphinxstyleemphasis{Remote Sensing of Environment}, 115:3517–3529, 2011. \sphinxhref{https://doi.org/10.1016/j.rse.2011.08.014}{doi:10.1016/j.rse.2011.08.014}.
\bibitem[22]{book/references:id4}
\sphinxAtStartPar
M. Tedesco. \sphinxstyleemphasis{Remote Sensing of the Cryosphere}. John Wiley \& Sons, Ltd, 2014. \sphinxhref{https://doi.org/10.1002/9781118368909}{doi:10.1002/9781118368909}.
\bibitem[23]{book/references:id24}
\sphinxAtStartPar
S. Tuttle and J. Jacobs. Enhanced Identification of Snow Melt and Refreeze Events From Passive Microwave Brightness Temperature Using Air Temperature. \sphinxstyleemphasis{Water Resources Research}, 55(4):3248–3265, 2019. \sphinxhref{https://doi.org/10.1029/2018WR023995}{doi:10.1029/2018WR023995}.
\bibitem[24]{book/references:id15}
\sphinxAtStartPar
F. Ulaby and D. Long. \sphinxstyleemphasis{Microwave Radar and Radiometric Remote Sensing}. The University of Michigan Press, 2014. \sphinxhref{https://doi.org/10.3998/0472119356}{doi:10.3998/0472119356}.
\bibitem[25]{book/references:id18}
\sphinxAtStartPar
L. Zschenderlein, K. Luojus, M. Takala, P. Venäläinen, and J. Pulliainen. Evaluation of passive microwave dry snow detection algorithms and application to SWE retrieval during seasonal snow accumulation. \sphinxstyleemphasis{Remote Sensing of Environment}, 288:113476, 2023. \sphinxhref{https://doi.org/10.1016/j.rse.2023.113476}{doi:10.1016/j.rse.2023.113476}.
\end{sphinxthebibliography}







\renewcommand{\indexname}{Index}
\printindex
\end{document}